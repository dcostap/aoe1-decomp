// Class: TribeSelectScenarioScreen
// Size:  0x4D8
//
// VTable Layout:
// [00] `scalar_deleting_destructor'
// [01] setup
// [02] set_rect
// [03] set_rect
// [04] set_color
// [05] set_active
// [06] set_positioning
// [07] set_fixed_position
// [08] set_redraw
// [09] set_overlapped_redraw
// [10] draw_setup
// [11] draw_finish
// [12] draw
// [13] draw_rect
// [14] draw_offset
// [15] draw_rect2
// [16] draw_offset2
// [17] paint
// [18] wnd_proc
// [19] handle_idle
// [20] handle_size
// [21] handle_paint
// [22] handle_key_down
// [23] handle_char
// [24] handle_command
// [25] handle_user_command
// [26] handle_timer_command
// [27] handle_scroll
// [28] handle_mouse_down
// [29] handle_mouse_move
// [30] handle_mouse_up
// [31] handle_mouse_dbl_click
// [32] mouse_move_action
// [33] mouse_left_down_action
// [34] mouse_left_hold_action
// [35] mouse_left_move_action
// [36] mouse_left_up_action
// [37] mouse_left_dbl_click_action
// [38] mouse_right_down_action
// [39] mouse_right_hold_action
// [40] mouse_right_move_action
// [41] mouse_right_up_action
// [42] mouse_right_dbl_click_action
// [43] key_down_action
// [44] char_action
// [45] action
// [46] get_true_render_rect
// [47] is_inside
// [48] set_focus
// [49] set_tab_order
// [50] set_tab_order
// [51] get_help_info
// [52] stop_sound_system
// [53] restart_sound_system
// [54] take_snapshot
// [55] handle_reactivate
// [56] draw_background
// [57] set_ideal_size
// [58] create_button
// [59] create_button
// [60] create_check_box
// [61] create_radio_button
// [62] create_text
// [63] create_text
// [64] create_text
// [65] create_input
// [66] create_edit
// [67] create_drop_down
// [68] create_list
// [69] create_scrollbar
// [70] create_auto_scrollbar
// [71] create_vert_slider
// [72] create_horz_slider
// [73] position_panel
// [74] `vector_deleting_destructor'
// [75] setup
// [76] set_rect
// [77] set_rect
// [78] set_color
// [79] set_active
// [80] set_positioning
// [81] set_fixed_position
// [82] set_redraw
// [83] set_overlapped_redraw
// [84] draw_setup
// [85] draw_finish
// [86] draw
// [87] draw_rect
// [88] draw_offset
// [89] draw_rect2
// [90] draw_offset2
// [91] paint
// [92] wnd_proc
// [93] handle_idle
// [94] handle_size
// [95] handle_paint
// [96] handle_key_down
// [97] handle_char
// [98] handle_command
// [99] handle_user_command
// [100] handle_timer_command
// [101] handle_scroll
// [102] handle_mouse_down
// [103] handle_mouse_move
// [104] handle_mouse_up
// [105] handle_mouse_dbl_click
// [106] mouse_move_action
// [107] mouse_left_down_action
// [108] mouse_left_hold_action
// [109] mouse_left_move_action
// [110] mouse_left_up_action
// [111] mouse_left_dbl_click_action
// [112] mouse_right_down_action
// [113] mouse_right_hold_action
// [114] mouse_right_move_action
// [115] mouse_right_up_action
// [116] mouse_right_dbl_click_action
// [117] key_down_action
// [118] char_action
// [119] action
// [120] get_true_render_rect
// [121] is_inside
// [122] set_focus
// [123] set_tab_order
// [124] set_tab_order
// [125] get_help_info
// [126] stop_sound_system
// [127] restart_sound_system
// [128] take_snapshot
// [129] handle_reactivate
// [130] draw_background
// [131] set_ideal_size
// [132] create_button
// [133] create_button
// [134] create_check_box
// [135] create_radio_button
// [136] create_text
// [137] create_text
// [138] create_text
// [139] create_input
// [140] create_edit
// [141] create_drop_down
// [142] create_list
// [143] create_scrollbar
// [144] create_auto_scrollbar
// [145] create_vert_slider
// [146] create_horz_slider
// [147] position_panel
// [148] `vector_deleting_destructor'
// [149] setup
// [150] set_rect
// [151] set_rect
// [152] set_color
// [153] set_active
// [154] set_positioning
// [155] set_fixed_position
// [156] set_redraw
// [157] set_overlapped_redraw
// [158] draw_setup
// [159] draw_finish
// [160] draw
// [161] draw_rect
// [162] draw_offset
// [163] draw_rect2
// [164] draw_offset2
// [165] paint
// [166] wnd_proc
// [167] handle_idle
// [168] handle_size
// [169] handle_paint
// [170] handle_key_down
// [171] handle_char
// [172] handle_command
// [173] handle_user_command
// [174] handle_timer_command
// [175] handle_scroll
// [176] handle_mouse_down
// [177] handle_mouse_move
// [178] handle_mouse_up
// [179] handle_mouse_dbl_click
// [180] mouse_move_action
// [181] mouse_left_down_action
// [182] mouse_left_hold_action
// [183] mouse_left_move_action
// [184] mouse_left_up_action
// [185] mouse_left_dbl_click_action
// [186] mouse_right_down_action
// [187] mouse_right_hold_action
// [188] mouse_right_move_action
// [189] mouse_right_up_action
// [190] mouse_right_dbl_click_action
// [191] key_down_action
// [192] char_action
// [193] action
// [194] get_true_render_rect
// [195] is_inside
// [196] set_focus
// [197] set_tab_order
// [198] set_tab_order
// [199] get_help_info
// [200] stop_sound_system
// [201] restart_sound_system
// [202] take_snapshot
// [203] handle_reactivate
// [204] draw_background
// [205] set_ideal_size
// [206] create_button
// [207] create_button
// [208] create_check_box
// [209] create_radio_button
// [210] create_text
// [211] create_text
// [212] create_text
// [213] create_input
// [214] create_edit
// [215] create_drop_down
// [216] create_list
// [217] create_scrollbar
// [218] create_auto_scrollbar
// [219] create_vert_slider
// [220] create_horz_slider
// [221] position_panel
// [222] `vector_deleting_destructor'
// [223] setup
// [224] set_rect
// [225] set_rect
// [226] set_color
// [227] set_active
// [228] set_positioning
// [229] set_fixed_position
// [230] set_redraw
// [231] set_overlapped_redraw
// [232] draw_setup
// [233] draw_finish
// [234] draw
// [235] draw_rect
// [236] draw_offset
// [237] draw_rect2
// [238] draw_offset2
// [239] paint
// [240] wnd_proc
// [241] handle_idle
// [242] handle_size
// [243] handle_paint
// [244] handle_key_down
// [245] handle_char
// [246] handle_command
// [247] handle_user_command
// [248] handle_timer_command
// [249] handle_scroll
// [250] handle_mouse_down
// [251] handle_mouse_move
// [252] handle_mouse_up
// [253] handle_mouse_dbl_click
// [254] mouse_move_action
// [255] mouse_left_down_action
// [256] mouse_left_hold_action
// [257] mouse_left_move_action
// [258] mouse_left_up_action
// [259] mouse_left_dbl_click_action
// [260] mouse_right_down_action
// [261] mouse_right_hold_action
// [262] mouse_right_move_action
// [263] mouse_right_up_action
// [264] mouse_right_dbl_click_action
// [265] key_down_action
// [266] char_action
// [267] action
// [268] get_true_render_rect
// [269] is_inside
// [270] set_focus
// [271] set_tab_order
// [272] set_tab_order
// [273] get_help_info
// [274] stop_sound_system
// [275] restart_sound_system
// [276] take_snapshot
// [277] handle_reactivate
// [278] draw_background
// [279] set_ideal_size
// [280] create_button
// [281] create_button
// [282] create_check_box
// [283] create_radio_button
// [284] create_text
// [285] create_text
// [286] create_text
// [287] create_input
// [288] create_edit
// [289] create_drop_down
// [290] create_list
// [291] create_scrollbar
// [292] create_auto_scrollbar
// [293] create_vert_slider
// [294] create_horz_slider
// [295] position_panel
// [296] `scalar_deleting_destructor'
// [297] setup
// [298] set_rect
// [299] set_rect
// [300] set_color
// [301] set_active
// [302] set_positioning
// [303] set_fixed_position
// [304] set_redraw
// [305] set_overlapped_redraw
// [306] draw_setup
// [307] draw_finish
// [308] draw
// [309] draw_rect
// [310] draw_offset
// [311] draw_rect2
// [312] draw_offset2
// [313] paint
// [314] wnd_proc
// [315] handle_idle
// [316] handle_size
// [317] handle_paint
// [318] handle_key_down
// [319] handle_char
// [320] handle_command
// [321] handle_user_command
// [322] handle_timer_command
// [323] handle_scroll
// [324] handle_mouse_down
// [325] handle_mouse_move
// [326] handle_mouse_up
// [327] handle_mouse_dbl_click
// [328] mouse_move_action
// [329] mouse_left_down_action
// [330] mouse_left_hold_action
// [331] mouse_left_move_action
// [332] mouse_left_up_action
// [333] mouse_left_dbl_click_action
// [334] mouse_right_down_action
// [335] mouse_right_hold_action
// [336] mouse_right_move_action
// [337] mouse_right_up_action
// [338] mouse_right_dbl_click_action
// [339] key_down_action
// [340] char_action
// [341] action
// [342] get_true_render_rect
// [343] is_inside
// [344] set_focus
// [345] set_tab_order
// [346] set_tab_order
// [347] get_help_info
// [348] stop_sound_system
// [349] restart_sound_system
// [350] take_snapshot
// [351] handle_reactivate
// [352] draw_background
// [353] set_ideal_size
// [354] create_button
// [355] create_button
// [356] create_check_box
// [357] create_radio_button
// [358] create_text
// [359] create_text
// [360] create_text
// [361] create_input
// [362] create_edit
// [363] create_drop_down
// [364] create_list
// [365] create_scrollbar
// [366] create_auto_scrollbar
// [367] create_vert_slider
// [368] create_horz_slider
// [369] position_panel
// [370] `vector_deleting_destructor'
// [371] setup
// [372] set_rect
// [373] set_rect
// [374] set_color
// [375] set_active
// [376] set_positioning
// [377] set_fixed_position
// [378] set_redraw
// [379] set_overlapped_redraw
// [380] draw_setup
// [381] draw_finish
// [382] draw
// [383] draw_rect
// [384] draw_offset
// [385] draw_rect2
// [386] draw_offset2
// [387] paint
// [388] wnd_proc
// [389] handle_idle
// [390] handle_size
// [391] handle_paint
// [392] handle_key_down
// [393] handle_char
// [394] handle_command
// [395] handle_user_command
// [396] handle_timer_command
// [397] handle_scroll
// [398] handle_mouse_down
// [399] handle_mouse_move
// [400] handle_mouse_up
// [401] handle_mouse_dbl_click
// [402] mouse_move_action
// [403] mouse_left_down_action
// [404] mouse_left_hold_action
// [405] mouse_left_move_action
// [406] mouse_left_up_action
// [407] mouse_left_dbl_click_action
// [408] mouse_right_down_action
// [409] mouse_right_hold_action
// [410] mouse_right_move_action
// [411] mouse_right_up_action
// [412] mouse_right_dbl_click_action
// [413] key_down_action
// [414] char_action
// [415] action
// [416] get_true_render_rect
// [417] is_inside
// [418] set_focus
// [419] set_tab_order
// [420] set_tab_order
// [421] get_help_info
// [422] stop_sound_system
// [423] restart_sound_system
// [424] take_snapshot
// [425] handle_reactivate
// [426] draw_background
// [427] set_ideal_size
// [428] create_button
// [429] create_button
// [430] create_check_box
// [431] create_radio_button
// [432] create_text
// [433] create_text
// [434] create_text
// [435] create_input
// [436] create_edit
// [437] create_drop_down
// [438] create_list
// [439] create_scrollbar
// [440] create_auto_scrollbar
// [441] create_vert_slider
// [442] create_horz_slider
// [443] position_panel
// [444] `scalar_deleting_destructor'
// [445] setup
// [446] set_rect
// [447] set_rect
// [448] set_color
// [449] set_active
// [450] set_positioning
// [451] set_fixed_position
// [452] set_redraw
// [453] set_overlapped_redraw
// [454] draw_setup
// [455] draw_finish
// [456] draw
// [457] draw_rect
// [458] draw_offset
// [459] draw_rect2
// [460] draw_offset2
// [461] paint
// [462] wnd_proc
// [463] handle_idle
// [464] handle_size
// [465] handle_paint
// [466] handle_key_down
// [467] handle_char
// [468] handle_command
// [469] handle_user_command
// [470] handle_timer_command
// [471] handle_scroll
// [472] handle_mouse_down
// [473] handle_mouse_move
// [474] handle_mouse_up
// [475] handle_mouse_dbl_click
// [476] mouse_move_action
// [477] mouse_left_down_action
// [478] mouse_left_hold_action
// [479] mouse_left_move_action
// [480] mouse_left_up_action
// [481] mouse_left_dbl_click_action
// [482] mouse_right_down_action
// [483] mouse_right_hold_action
// [484] mouse_right_move_action
// [485] mouse_right_up_action
// [486] mouse_right_dbl_click_action
// [487] key_down_action
// [488] char_action
// [489] action
// [490] get_true_render_rect
// [491] is_inside
// [492] set_focus
// [493] set_tab_order
// [494] set_tab_order
// [495] get_help_info
// [496] stop_sound_system
// [497] restart_sound_system
// [498] take_snapshot
// [499] handle_reactivate
// [500] draw_item
//
// Member Layout:
// [0x478] TTextPanel * title
// [0x47C] TTextPanel * scenarioTitle
// [0x480] TTextPanel * scenarioPlayersTitle
// [0x484] long scenarioListX
// [0x488] long scenarioListY
// [0x48C] long scenarioListWidth
// [0x490] long scenarioListHeight
// [0x494] TListPanel * scenarioList
// [0x498] TScrollBarPanel * scenarioScrollbar
// [0x49C] int scenarioCount
// [0x4A0] char * * scenarioMission
// [0x4A4] int * scenarioFixed
// [0x4A8] int scenariosLoaded
// [0x4AC] TTextPanel * missionTitle
// [0x4B0] long missionTextX
// [0x4B4] long missionTextY
// [0x4B8] long missionTextWidth
// [0x4BC] long missionTextHeight
// [0x4C0] TTextPanel * missionText
// [0x4C4] TScrollBarPanel * missionScrollbar
// [0x4C8] TButtonPanel * okButton
// [0x4CC] TButtonPanel * cancelButton
// [0x4D0] TButtonPanel * close_button
// [0x4D4] int last_scenario_line
// ----------------------------------------------------------------

// Function: TribeSelectScenarioScreen
// Address: 004b3c90
// [HELPER] s_: ""
// [HELPER] s_Select_Scenario_Screen: "Select Scenario Screen"
// [HELPER] s_scr2: "scr2"
// [HELPER] s_scr3: "scr3"
/* public: __thiscall TribeSelectScenarioScreen::TribeSelectScenarioScreen(void) */

TribeSelectScenarioScreen * __thiscall
TribeSelectScenarioScreen::TribeSelectScenarioScreen(TribeSelectScenarioScreen *this)
{
  TListPanel **ppTVar1;
  TTextPanel **ppTVar2;
  TButtonPanel **ppTVar3;
  TDrawArea *pTVar4;
  TButtonPanel *pTVar5;
  int iVar6;
  char *pcVar7;
  undefined4 *unaff_FS_OFFSET;
  int iVar8;
  long lVar9;
  long lVar10;
  long lVar11;
  long lVar12;
  int iVar13;
  undefined4 local_c;
  code *pcStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  pcStack_8 = FUN_0055f638;
  local_c = *unaff_FS_OFFSET;
  *unaff_FS_OFFSET = &local_c;
  TScreenPanel::TScreenPanel((TScreenPanel *)this,s_Select_Scenario_Screen);
  local_4 = 0;
  this->_padding_ = (int)&_vftable_;
  init_vars(this);
  iVar6 = RGE_Base_Game::multiplayerGame(rge_base_game);
  pcVar7 = &s_scr3;
  if (iVar6 == 0) {
    pcVar7 = &s_scr2;
  }
  iVar13 = 1;
  lVar12 = 0;
  lVar11 = 0;
  pTVar4 = rge_base_game->draw_area;
  lVar10 = 0;
  lVar9 = 0;
  iVar8 = 1;
  iVar6 = RGE_Base_Game::multiplayerGame(rge_base_game);
  lVar9 = TEasy_Panel::setup((TEasy_Panel *)this,pTVar4,(TPanel *)0x0,pcVar7,(iVar6 != 0) + 0xc384,
                             iVar8,lVar9,lVar10,lVar11,lVar12,iVar13);
  if (lVar9 == 0) {
    this->_padding_ = 1;
    *unaff_FS_OFFSET = local_c;
    return this;
  }
  TEasy_Panel::setup_shadow_area((TEasy_Panel *)this,0);
  TEasy_Panel::set_ideal_size((TEasy_Panel *)this,0x280,0x1e0);
                    /* language.dll match for 0x25fa: "Scenarios" */
  iVar6 = TEasy_Panel::create_text
                    ((TEasy_Panel *)this,(TPanel *)this,&this->title,0x25fa,0x14,10,600,0x1e,1,1,0,0
                    );
  if (iVar6 != 0) {
    ppTVar1 = &this->scenarioList;
    this->scenarioListX = 0x14;
    this->scenarioListY = 0x46;
    this->scenarioListWidth = 600;
    this->scenarioListHeight = 0x107;
    iVar6 = TEasy_Panel::create_list
                      ((TEasy_Panel *)this,(TPanel *)this,ppTVar1,0x14,0x46,600,0x107,0xb);
    if (iVar6 != 0) {
      TTextPanel::set_second_column_pos
                ((TTextPanel *)*ppTVar1,
                 (this->_padding_ * (this->scenarioListWidth + -0x3c)) / this->_padding_);
                    /* language.dll match for 0x25fd: "Loading list of scenarios..." */
      (**(code **)((*ppTVar1)->_padding_ + 0xe4))(0x25fd);
      iVar6 = TEasy_Panel::create_auto_scrollbar
                        ((TEasy_Panel *)this,&this->scenarioScrollbar,(TTextPanel *)*ppTVar1,0x14);
      if (iVar6 != 0) {
        TPanel::set_help_info((TPanel *)this->scenarioScrollbar,-1,-1);
                    /* language.dll match for 0x25fe: "Select Scenario" */
        iVar6 = TEasy_Panel::create_text
                          ((TEasy_Panel *)this,(TPanel *)this,&this->scenarioTitle,0x25fe,
                           this->scenarioListX,this->scenarioListY + -0x14,300,0x14,4,0,0,0);
        if (iVar6 != 0) {
                    /* language.dll match for 0x25ff: "Players" */
          iVar6 = TEasy_Panel::create_text
                            ((TEasy_Panel *)this,(TPanel *)this,&this->scenarioPlayersTitle,0x25ff,
                             this->scenarioListWidth + -0xdc + this->scenarioListX,
                             this->scenarioListY + -0x14,200,0x14,4,0,0,0);
          if (iVar6 != 0) {
            TTextPanel::set_alignment(this->scenarioPlayersTitle,AlignTop,AlignRight);
            iVar6 = this->scenarioListHeight + 0x19 + this->scenarioListY;
            this->missionTextY = iVar6;
            this->missionTextX = this->scenarioListX;
                    /* language.dll match for 0x2600: "Scenario Instructions" */
            this->missionTextWidth = this->scenarioListWidth;
            this->missionTextHeight = 0x3c;
            iVar6 = TEasy_Panel::create_text
                              ((TEasy_Panel *)this,(TPanel *)this,&this->missionTitle,0x2600,
                               this->scenarioListX,iVar6 + -0x14,400,0x14,4,0,0,0);
            if (iVar6 != 0) {
              ppTVar2 = &this->missionText;
              iVar6 = TEasy_Panel::create_text
                                ((TEasy_Panel *)this,(TPanel *)this,ppTVar2,s_,this->missionTextX,
                                 this->missionTextY,this->missionTextWidth,this->missionTextHeight,
                                 0xb,0,0,1);
              if (iVar6 != 0) {
                (**(code **)((*ppTVar2)->_padding_ + 0xec))
                          (3,(char)this->_padding_,*(undefined1 *)((int)&this->_padding_ + 1),
                           *(undefined1 *)((int)&this->_padding_ + 2),
                           *(undefined1 *)((int)&this->_padding_ + 3),(char)this->_padding_,
                           *(undefined1 *)((int)&this->_padding_ + 1));
                iVar6 = TEasy_Panel::create_auto_scrollbar
                                  ((TEasy_Panel *)this,&this->missionScrollbar,*ppTVar2,0x14);
                if (iVar6 != 0) {
                  TPanel::set_help_info((TPanel *)this->missionScrollbar,0x7532,-1);
                    /* language.dll match for 0xfa1: "OK" */
                  iVar6 = TEasy_Panel::create_button
                                    ((TEasy_Panel *)this,(TPanel *)this,&this->okButton,0xfa1,0,0x46
                                     ,0x1b8,0xf0,0x1e,0,0,0);
                  if (iVar6 != 0) {
                    TPanel::set_help_info((TPanel *)this->okButton,0x7531,-1);
                    ppTVar3 = &this->cancelButton;
                    /* language.dll match for 0xfa2: "Cancel" */
                    iVar6 = TEasy_Panel::create_button
                                      ((TEasy_Panel *)this,(TPanel *)this,ppTVar3,0xfa2,0,0x14a,
                                       0x1b8,0xf0,0x1e,0,0,0);
                    if (iVar6 != 0) {
                      TPanel::set_help_info((TPanel *)*ppTVar3,0x7532,-1);
                      pTVar5 = *ppTVar3;
                      pTVar5->hotkey = 0x1b;
                      pTVar5->hotkey_shift = 0;
                      ppTVar3 = &this->close_button;
                    /* language.dll match for 0x3ea: "X" */
                      iVar6 = TEasy_Panel::create_button
                                        ((TEasy_Panel *)this,(TPanel *)this,ppTVar3,0x3ea,0,0,0,0,0,
                                         -1,-1,0);
                      if (iVar6 != 0) {
                        (**(code **)((*ppTVar3)->_padding_ + 0x14))(1);
                        (**(code **)((*ppTVar3)->_padding_ + 0x18))
                                  (9,4,4,4,4,0x11,0x11,0x11,0x11,0,0,0,0);
                        fillScenarios(this);
                        this->scenariosLoaded = 1;
                        getSettings(this);
                        fillMissionText(this);
                        activatePanels(this);
                        TPanel::set_curr_child((TPanel *)this,(TPanel *)*ppTVar1);
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  *unaff_FS_OFFSET = local_c;
  return this;
}

// --------------------------------------------------

// Function: `scalar_deleting_destructor'
// Address: 004b4100
/* public: virtual void * __thiscall TribeSelectScenarioScreen::`scalar deleting
   destructor'(unsigned int) */

void * __thiscall
TribeSelectScenarioScreen::_scalar_deleting_destructor_
          (TribeSelectScenarioScreen *this,uint param_1)
{
  ~TribeSelectScenarioScreen(this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return this;
}

// --------------------------------------------------

// Function: init_vars
// Address: 004b4120
/* protected: void __thiscall TribeSelectScenarioScreen::init_vars(void) */

void __thiscall TribeSelectScenarioScreen::init_vars(TribeSelectScenarioScreen *this)
{
  this->last_scenario_line = -1;
  this->title = (TTextPanel *)0x0;
  this->scenarioTitle = (TTextPanel *)0x0;
  this->scenarioPlayersTitle = (TTextPanel *)0x0;
  this->scenarioList = (TListPanel *)0x0;
  this->scenarioScrollbar = (TScrollBarPanel *)0x0;
  this->scenarioCount = 0;
  this->scenarioMission = (char **)0x0;
  this->scenarioFixed = (int *)0x0;
  this->scenariosLoaded = 0;
  this->missionTitle = (TTextPanel *)0x0;
  this->missionText = (TTextPanel *)0x0;
  this->missionScrollbar = (TScrollBarPanel *)0x0;
  this->okButton = (TButtonPanel *)0x0;
  this->cancelButton = (TButtonPanel *)0x0;
  this->close_button = (TButtonPanel *)0x0;
  return;
}

// --------------------------------------------------

// Function: ~TribeSelectScenarioScreen
// Address: 004b4190
/* public: virtual __thiscall TribeSelectScenarioScreen::~TribeSelectScenarioScreen(void) */

void __thiscall
TribeSelectScenarioScreen::~TribeSelectScenarioScreen(TribeSelectScenarioScreen *this)
{
  undefined4 *unaff_FS_OFFSET;
  undefined4 local_c;
  code *pcStack_8;
  undefined4 local_4;
  
  pcStack_8 = FUN_0055f658;
  local_c = *unaff_FS_OFFSET;
  *unaff_FS_OFFSET = &local_c;
  this->_padding_ = (int)&_vftable_;
  local_4 = 0;
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->title);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->scenarioTitle);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->scenarioPlayersTitle);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->scenarioList);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->scenarioScrollbar);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->missionTitle);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->missionText);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->missionScrollbar);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->okButton);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->cancelButton);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->close_button);
  local_4 = 0xffffffff;
  TScreenPanel::~TScreenPanel((TScreenPanel *)this);
  *unaff_FS_OFFSET = local_c;
  return;
}

// --------------------------------------------------

// Function: handle_idle
// Address: 004b4280
/* public: virtual long __thiscall TribeSelectScenarioScreen::handle_idle(void) */

long __thiscall TribeSelectScenarioScreen::handle_idle(TribeSelectScenarioScreen *this)
{
  long lVar1;
  
  if (this->scenariosLoaded == 0) {
    fillScenarios(this);
    fillMissionText(this);
    this->scenariosLoaded = 1;
    activatePanels(this);
    TPanel::set_curr_child((TPanel *)this,(TPanel *)this->scenarioList);
  }
  if (rge_base_game->input_enabled == 0) {
    RGE_Base_Game::enable_input(rge_base_game);
  }
  lVar1 = TPanel::handle_idle((TPanel *)this);
  return lVar1;
}

// --------------------------------------------------

// Function: action
// Address: 004b42e0
// [HELPER] s_MP_Setup_Screen: "MP Setup Screen"
// [HELPER] s_Select_Scenario_Screen: "Select Scenario Screen"
// [HELPER] s_Single_Player_Menu: "Single Player Menu"
/* protected: virtual long __thiscall TribeSelectScenarioScreen::action(class TPanel *,long,unsigned
   long,unsigned long) */

long __thiscall
TribeSelectScenarioScreen::action
          (TribeSelectScenarioScreen *this,TPanel *param_1,long param_2,ulong param_3,ulong param_4)
{
  TribeMPSetupScreen *this_00;
  TribeSPMenuScreen *this_01;
  long lVar1;
  undefined4 *unaff_FS_OFFSET;
  undefined4 uVar2;
  undefined4 local_c;
  code *pcStack_8;
  undefined4 local_4;
  
  local_c = *unaff_FS_OFFSET;
  local_4 = 0xffffffff;
  pcStack_8 = FUN_0055f686;
  *unaff_FS_OFFSET = &local_c;
  if ((param_1 != (TPanel *)0x0) && (this->scenariosLoaded != 0)) {
    if (((TButtonPanel *)param_1 == this->okButton) && (param_2 == 1)) {
      TPanel::set_curr_child((TPanel *)this,(TPanel *)this->scenarioList);
      sendSettings(this);
      RGE_Base_Game::disable_input(rge_base_game);
      this_00 = (TribeMPSetupScreen *)operator_new(0x890);
      local_4 = 0;
      if (this_00 != (TribeMPSetupScreen *)0x0) {
        TribeMPSetupScreen::TribeMPSetupScreen(this_00);
      }
      local_4 = 0xffffffff;
      TPanelSystem::setCurrentPanel(&panel_system,s_MP_Setup_Screen,0);
      TPanelSystem::destroyPanel(&panel_system,s_Select_Scenario_Screen);
      *unaff_FS_OFFSET = local_c;
      return 1;
    }
    if (((TButtonPanel *)param_1 == this->cancelButton) && (param_2 == 1)) {
      TPanel::set_curr_child((TPanel *)this,(TPanel *)this->scenarioList);
      RGE_Base_Game::disable_input(rge_base_game);
      this_01 = (TribeSPMenuScreen *)operator_new(0x49c);
      local_4 = 1;
      if (this_01 != (TribeSPMenuScreen *)0x0) {
        TribeSPMenuScreen::TribeSPMenuScreen(this_01);
      }
      local_4 = 0xffffffff;
      TPanelSystem::setCurrentPanel(&panel_system,s_Single_Player_Menu,0);
      TPanelSystem::destroyPanel(&panel_system,s_Select_Scenario_Screen);
      *unaff_FS_OFFSET = local_c;
      return 1;
    }
    if (((TButtonPanel *)param_1 == this->close_button) && (param_2 == 1)) {
      RGE_Base_Game::close(rge_base_game);
      *unaff_FS_OFFSET = local_c;
      return 1;
    }
    if ((TListPanel *)param_1 == this->scenarioList) {
      if (param_2 == 3) {
        uVar2 = 1;
        (**(code **)(this->_padding_ + 0xb4))(this->okButton,1,0,0);
        *unaff_FS_OFFSET = uVar2;
        return 1;
      }
      if (param_2 == 1) {
        fillMissionText(this);
        activatePanels(this);
        *unaff_FS_OFFSET = local_c;
        return 1;
      }
    }
  }
  lVar1 = TEasy_Panel::action((TEasy_Panel *)this,param_1,param_2,param_3,param_4);
  *unaff_FS_OFFSET = local_c;
  return lVar1;
}

// --------------------------------------------------

// Function: fillScenarios
// Address: 004b44f0
// [HELPER] s__d: "%d"
// [HELPER] s__d____d: "%d - %d"
/* WARNING: Variable defined which should be unmapped: i */
/* protected: void __thiscall TribeSelectScenarioScreen::fillScenarios(void) */

void __thiscall TribeSelectScenarioScreen::fillScenarios(TribeSelectScenarioScreen *this)
{
  char cVar1;
  int iVar2;
  char *pcVar3;
  char **ppcVar4;
  int *piVar5;
  long lVar6;
  RGE_Scenario_Header *pRVar7;
  char *pcVar8;
  uint uVar9;
  uint uVar10;
  RGE_Scenario_File_Info *this_00;
  char *pcVar11;
  int i;
  RGE_Scenario_File_Info *scenario_info_file;
  char player_str [20];
  char file_name [260];
  char scenario_file [260];
  
  this_00 = rge_base_game->scenario_info;
  player_str._0_4_ = this_00;
  RGE_Scenario_File_Info::reload_scenarios(this_00);
  TTextPanel::empty_list((TTextPanel *)this->scenarioList);
  this->scenarioList->_padding_ = 1;
  this->scenarioCount = 0;
  do {
    pcVar3 = RGE_Scenario_File_Info::get_scenario_name(this_00,this->scenarioCount);
    if (pcVar3 == (char *)0x0) {
      ppcVar4 = (char **)calloc(this->scenarioCount,4);
      this->scenarioMission = ppcVar4;
      piVar5 = (int *)calloc(this->scenarioCount,4);
      this->scenarioFixed = piVar5;
      if (((this->scenarioMission != (char **)0x0) && (piVar5 != (int *)0x0)) &&
         (scenario_info_file = (RGE_Scenario_File_Info *)0x0, 0 < this->scenarioCount)) {
        do {
          lVar6 = TTextPanel::get_id((TTextPanel *)this->scenarioList,(long)scenario_info_file);
          pRVar7 = RGE_Scenario_File_Info::get_scenario_info(this_00,lVar6);
          if (pRVar7 != (RGE_Scenario_Header *)0x0) {
            pcVar3 = (char *)calloc(0x1000,1);
            this->scenarioMission[(int)scenario_info_file] = pcVar3;
            if ((this->scenarioMission[(int)scenario_info_file] != (char *)0x0) &&
               (pRVar7->description != (char *)0x0)) {
              uVar9 = 0xffffffff;
              pcVar3 = pRVar7->description;
              do {
                pcVar8 = pcVar3;
                if (uVar9 == 0) break;
                uVar9 = uVar9 - 1;
                pcVar8 = pcVar3 + 1;
                cVar1 = *pcVar3;
                pcVar3 = pcVar8;
              } while (cVar1 != '\0');
              uVar9 = ~uVar9;
              pcVar3 = pcVar8 + -uVar9;
              pcVar8 = this->scenarioMission[(int)scenario_info_file];
              for (uVar10 = uVar9 >> 2; uVar10 != 0; uVar10 = uVar10 - 1) {
                *(undefined4 *)pcVar8 = *(undefined4 *)pcVar3;
                pcVar3 = pcVar3 + 4;
                pcVar8 = pcVar8 + 4;
              }
              for (uVar9 = uVar9 & 3; uVar9 != 0; uVar9 = uVar9 - 1) {
                *pcVar8 = *pcVar3;
                pcVar3 = pcVar3 + 1;
                pcVar8 = pcVar8 + 1;
              }
            }
            this->scenarioFixed[(int)scenario_info_file] = pRVar7[1]._padding_;
            iVar2 = pRVar7[1].error_code;
            if (0 < iVar2) {
              if ((this->scenarioFixed[(int)scenario_info_file] == 0) && (2 < iVar2)) {
                sprintf(player_str + 4,s__d____d,2,iVar2);
              }
              else {
                sprintf(player_str + 4,&s__d,iVar2);
              }
              pcVar8 = TTextPanel::get_text
                                 ((TTextPanel *)this->scenarioList,(long)scenario_info_file);
              uVar9 = 0xffffffff;
              pcVar3 = scenario_file;
              do {
                pcVar11 = pcVar8;
                if (uVar9 == 0) break;
                uVar9 = uVar9 - 1;
                pcVar11 = pcVar8 + 1;
                cVar1 = *pcVar8;
                pcVar8 = pcVar11;
              } while (cVar1 != '\0');
              uVar9 = ~uVar9;
              pcVar8 = pcVar11 + -uVar9;
              for (uVar10 = uVar9 >> 2; pcVar3 = pcVar3 + 4, uVar10 != 0; uVar10 = uVar10 - 1) {
                *(undefined4 *)pcVar3 = *(undefined4 *)pcVar8;
                pcVar8 = pcVar8 + 4;
              }
              for (uVar9 = uVar9 & 3; uVar9 != 0; uVar9 = uVar9 - 1) {
                *pcVar3 = *pcVar8;
                pcVar8 = pcVar8 + 1;
                pcVar3 = pcVar3 + 1;
              }
              TTextPanel::change_line
                        ((TTextPanel *)this->scenarioList,(long)scenario_info_file,scenario_file + 4
                         ,player_str + 4,0);
            }
          }
          scenario_info_file = (RGE_Scenario_File_Info *)(scenario_info_file->filename + 1);
          this_00 = (RGE_Scenario_File_Info *)player_str._0_4_;
        } while ((int)scenario_info_file < this->scenarioCount);
      }
      return;
    }
    uVar9 = 0xffffffff;
    pcVar8 = pcVar3;
    do {
      if (uVar9 == 0) break;
      uVar9 = uVar9 - 1;
      cVar1 = *pcVar8;
      pcVar8 = pcVar8 + 1;
    } while (cVar1 != '\0');
    strncpy(file_name + 4,pcVar3,~uVar9 - 5);
    lVar6 = this->scenarioCount;
    player_str[~uVar9 + 0x13] = '\0';
    TTextPanel::append_line((TTextPanel *)this->scenarioList,file_name + 4,lVar6);
    this->scenarioCount = this->scenarioCount + 1;
  } while( true );
}

// --------------------------------------------------

// Function: fillMissionText
// Address: 004b4720
// [HELPER] s_: ""
/* protected: void __thiscall TribeSelectScenarioScreen::fillMissionText(void) */

void __thiscall TribeSelectScenarioScreen::fillMissionText(TribeSelectScenarioScreen *this)
{
  long lVar1;
  
  (**(code **)(this->missionText->_padding_ + 0xe8))(s_);
  lVar1 = TTextPanel::get_line((TTextPanel *)this->scenarioList);
  if (-1 < lVar1) {
    (**(code **)(this->missionText->_padding_ + 0xe8))(this->scenarioMission[lVar1]);
  }
  this->last_scenario_line = lVar1;
  return;
}

// --------------------------------------------------

// Function: getSettings
// Address: 004b4770
/* protected: void __thiscall TribeSelectScenarioScreen::getSettings(void) */

void __thiscall TribeSelectScenarioScreen::getSettings(TribeSelectScenarioScreen *this)
{
  char *pcVar1;
  long lVar2;
  
  this->last_scenario_line = -1;
  pcVar1 = RGE_Base_Game::scenarioName(rge_base_game);
  lVar2 = TTextPanel::get_line((TTextPanel *)this->scenarioList,pcVar1);
  if (lVar2 != -1) {
    TListPanel::scroll_cur_line(this->scenarioList,'\x01',(short)lVar2,1);
    this->last_scenario_line = lVar2 + -1;
    return;
  }
  TListPanel::scroll_cur_line(this->scenarioList,'\x01',0,1);
  return;
}

// --------------------------------------------------

// Function: sendSettings
// Address: 004b47d0
/* protected: void __thiscall TribeSelectScenarioScreen::sendSettings(void) */

void __thiscall TribeSelectScenarioScreen::sendSettings(TribeSelectScenarioScreen *this)
{
  char *pcVar1;
  
  RGE_Base_Game::setScenarioGame(rge_base_game,1);
  pcVar1 = TTextPanel::get_text((TTextPanel *)this->scenarioList);
  RGE_Base_Game::setScenarioName(rge_base_game,pcVar1);
  TRIBE_Game::setDeathMatch((TRIBE_Game *)rge_base_game,'\0');
  return;
}

// --------------------------------------------------

// Function: activatePanels
// Address: 004b4810
/* WARNING: Variable defined which should be unmapped: tabList */
/* protected: void __thiscall TribeSelectScenarioScreen::activatePanels(void) */

void __thiscall TribeSelectScenarioScreen::activatePanels(TribeSelectScenarioScreen *this)
{
  TListPanel *pTStack_18;
  TPanel *tabList [4];
  
  pTStack_18 = (TListPanel *)0x1;
  (**(code **)(this->missionTitle->_padding_ + 0x14))();
  (**(code **)(this->missionText->_padding_ + 0x14))(1);
  tabList[0] = (TPanel *)this->okButton;
  pTStack_18 = this->scenarioList;
  tabList[1] = (TPanel *)this->cancelButton;
  (**(code **)(this->_padding_ + 200))(&pTStack_18,3);
  if ((this->_padding_ == 0) || (*(int *)(this->_padding_ + 0x6c) == 0)) {
    TPanel::set_curr_child((TPanel *)this,(TPanel *)this->okButton);
  }
  return;
}

// --------------------------------------------------

