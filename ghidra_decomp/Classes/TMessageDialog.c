// Class: TMessageDialog
// Size:  0x4A4
//
// VTable Layout:
// [00] `scalar_deleting_destructor'
// [01] setup
// [02] set_rect
// [03] set_rect
// [04] set_color
// [05] set_active
// [06] set_positioning
// [07] set_fixed_position
// [08] set_redraw
// [09] set_overlapped_redraw
// [10] draw_setup
// [11] draw_finish
// [12] draw
// [13] draw_rect
// [14] draw_offset
// [15] draw_rect2
// [16] draw_offset2
// [17] paint
// [18] wnd_proc
// [19] handle_idle
// [20] handle_size
// [21] handle_paint
// [22] handle_key_down
// [23] handle_char
// [24] handle_command
// [25] handle_user_command
// [26] handle_timer_command
// [27] handle_scroll
// [28] handle_mouse_down
// [29] handle_mouse_move
// [30] handle_mouse_up
// [31] handle_mouse_dbl_click
// [32] mouse_move_action
// [33] mouse_left_down_action
// [34] mouse_left_hold_action
// [35] mouse_left_move_action
// [36] mouse_left_up_action
// [37] mouse_left_dbl_click_action
// [38] mouse_right_down_action
// [39] mouse_right_hold_action
// [40] mouse_right_move_action
// [41] mouse_right_up_action
// [42] mouse_right_dbl_click_action
// [43] key_down_action
// [44] char_action
// [45] action
// [46] get_true_render_rect
// [47] is_inside
// [48] set_focus
// [49] set_tab_order
// [50] set_tab_order
// [51] get_help_info
// [52] stop_sound_system
// [53] restart_sound_system
// [54] take_snapshot
// [55] handle_reactivate
// [56] draw_background
// [57] set_ideal_size
// [58] create_button
// [59] create_button
// [60] create_check_box
// [61] create_radio_button
// [62] create_text
// [63] create_text
// [64] create_text
// [65] create_input
// [66] create_edit
// [67] create_drop_down
// [68] create_list
// [69] create_scrollbar
// [70] create_auto_scrollbar
// [71] create_vert_slider
// [72] create_horz_slider
// [73] position_panel
// [74] setup
// [75] setup
// [76] `scalar_deleting_destructor'
// [77] setup
// [78] set_rect
// [79] set_rect
// [80] set_color
// [81] set_active
// [82] set_positioning
// [83] set_fixed_position
// [84] set_redraw
// [85] set_overlapped_redraw
// [86] draw_setup
// [87] draw_finish
// [88] draw
// [89] draw_rect
// [90] draw_offset
// [91] draw_rect2
// [92] draw_offset2
// [93] paint
// [94] wnd_proc
// [95] handle_idle
// [96] handle_size
// [97] handle_paint
// [98] handle_key_down
// [99] handle_char
// [100] handle_command
// [101] handle_user_command
// [102] handle_timer_command
// [103] handle_scroll
// [104] handle_mouse_down
// [105] handle_mouse_move
// [106] handle_mouse_up
// [107] handle_mouse_dbl_click
// [108] mouse_move_action
// [109] mouse_left_down_action
// [110] mouse_left_hold_action
// [111] mouse_left_move_action
// [112] mouse_left_up_action
// [113] mouse_left_dbl_click_action
// [114] mouse_right_down_action
// [115] mouse_right_hold_action
// [116] mouse_right_move_action
// [117] mouse_right_up_action
// [118] mouse_right_dbl_click_action
// [119] key_down_action
// [120] char_action
// [121] action
// [122] get_true_render_rect
// [123] is_inside
// [124] set_focus
// [125] set_tab_order
// [126] set_tab_order
// [127] get_help_info
// [128] stop_sound_system
// [129] restart_sound_system
// [130] take_snapshot
// [131] handle_reactivate
// [132] draw_background
// [133] set_ideal_size
// [134] create_button
// [135] create_button
// [136] create_check_box
// [137] create_radio_button
// [138] create_text
// [139] create_text
// [140] create_text
// [141] create_input
// [142] create_edit
// [143] create_drop_down
// [144] create_list
// [145] create_scrollbar
// [146] create_auto_scrollbar
// [147] create_vert_slider
// [148] create_horz_slider
// [149] position_panel
// [150] setup
// [151] setup
// [152] `scalar_deleting_destructor'
// [153] setup
// [154] set_rect
// [155] set_rect
// [156] set_color
// [157] set_active
// [158] set_positioning
// [159] set_fixed_position
// [160] set_redraw
// [161] set_overlapped_redraw
// [162] draw_setup
// [163] draw_finish
// [164] draw
// [165] draw_rect
// [166] draw_offset
// [167] draw_rect2
// [168] draw_offset2
// [169] paint
// [170] wnd_proc
// [171] handle_idle
// [172] handle_size
// [173] handle_paint
// [174] handle_key_down
// [175] handle_char
// [176] handle_command
// [177] handle_user_command
// [178] handle_timer_command
// [179] handle_scroll
// [180] handle_mouse_down
// [181] handle_mouse_move
// [182] handle_mouse_up
// [183] handle_mouse_dbl_click
// [184] mouse_move_action
// [185] mouse_left_down_action
// [186] mouse_left_hold_action
// [187] mouse_left_move_action
// [188] mouse_left_up_action
// [189] mouse_left_dbl_click_action
// [190] mouse_right_down_action
// [191] mouse_right_hold_action
// [192] mouse_right_move_action
// [193] mouse_right_up_action
// [194] mouse_right_dbl_click_action
// [195] key_down_action
// [196] char_action
// [197] action
// [198] get_true_render_rect
// [199] is_inside
// [200] set_focus
// [201] set_tab_order
// [202] set_tab_order
// [203] get_help_info
// [204] stop_sound_system
// [205] restart_sound_system
// [206] take_snapshot
// [207] handle_reactivate
// [208] draw_background
// [209] set_ideal_size
// [210] create_button
// [211] create_button
// [212] create_check_box
// [213] create_radio_button
// [214] create_text
// [215] create_text
// [216] create_text
// [217] create_input
// [218] create_edit
// [219] create_drop_down
// [220] create_list
// [221] create_scrollbar
// [222] create_auto_scrollbar
// [223] create_vert_slider
// [224] create_horz_slider
// [225] position_panel
// [226] setup
// [227] setup
// [228] `vector_deleting_destructor'
// [229] setup
// [230] set_rect
// [231] set_rect
// [232] set_color
// [233] set_active
// [234] set_positioning
// [235] set_fixed_position
// [236] set_redraw
// [237] set_overlapped_redraw
// [238] draw_setup
// [239] draw_finish
// [240] draw
// [241] draw_rect
// [242] draw_offset
// [243] draw_rect2
// [244] draw_offset2
// [245] paint
// [246] wnd_proc
// [247] handle_idle
// [248] handle_size
// [249] handle_paint
// [250] handle_key_down
// [251] handle_char
// [252] handle_command
// [253] handle_user_command
// [254] handle_timer_command
// [255] handle_scroll
// [256] handle_mouse_down
// [257] handle_mouse_move
// [258] handle_mouse_up
// [259] handle_mouse_dbl_click
// [260] mouse_move_action
// [261] mouse_left_down_action
// [262] mouse_left_hold_action
// [263] mouse_left_move_action
// [264] mouse_left_up_action
// [265] mouse_left_dbl_click_action
// [266] mouse_right_down_action
// [267] mouse_right_hold_action
// [268] mouse_right_move_action
// [269] mouse_right_up_action
// [270] mouse_right_dbl_click_action
// [271] key_down_action
// [272] char_action
// [273] action
// [274] get_true_render_rect
// [275] is_inside
// [276] set_focus
// [277] set_tab_order
// [278] set_tab_order
// [279] get_help_info
// [280] stop_sound_system
// [281] restart_sound_system
// [282] take_snapshot
// [283] handle_reactivate
// [284] draw_background
// [285] set_ideal_size
// [286] create_button
// [287] create_button
// [288] create_check_box
// [289] create_radio_button
// [290] create_text
// [291] create_text
// [292] create_text
// [293] create_input
// [294] create_edit
// [295] create_drop_down
// [296] create_list
// [297] create_scrollbar
// [298] create_auto_scrollbar
// [299] create_vert_slider
// [300] create_horz_slider
// [301] position_panel
// [302] setup
// [303] setup
// [304] `scalar_deleting_destructor'
// [305] recycle_in_to_game
// [306] recycle_out_of_game
// [307] draw
// [308] shadow_draw
// [309] normal_draw
// [310] draw_front_frame
// [311] draw_back_frame
// [312] draw_frame
// [313] update
// [314] check_damage_sprites
// [315] rehook
// [316] save
// [317] teleport
// [318] new_sprite
// [319] add_overlay_sprite
// [320] remove_overlay_sprite
// [321] change_ownership
// [322] modify
// [323] modify_delta
// [324] modify_percent
// [325] transform
// [326] copy_obj
// [327] set_object_state
// [328] remove_visible_resource
// [329] create_doppleganger_when_dying
// [330] destroy_obj
// [331] die_die_die
// [332] damage
// [333] calculateDamage
// [334] rotate
// [335] can_attack
// [336] set_attribute
// [337] set_attribute_amount
// [338] heal
// [339] heal
// [340] canRepair
// [341] notify_of_relation
// [342] do_command
// [343] move_to
// [344] work
// [345] stop
// [346] set_attack
// [347] play_command_sound
// [348] play_move_sound
// [349] new_angle
// [350] spawn_death_obj
// [351] get_command_master
// [352] set_being_worked_on
// [353] release_being_worked_on
// [354] is_moving
// [355] get_target_obj
// [356] enter_obj
// [357] exit_obj
// [358] explore_terrain
// [359] unexplore_terrain
// [360] get_los_table
// [361] inAttackRange
// [362] underAttack
// [363] setUnderAttack
// [364] calc_attack_modifier
// [365] getSpeed
// [366] getAngle
// [367] maximumSpeed
// [368] rateOfFire
// [369] damageCapability
// [370] damageCapability
// [371] weaponRange
// [372] minimumWeaponRange
// [373] passableTile
// [374] facetToNextWaypoint
// [375] currentTargetID
// [376] currentTargetX
// [377] currentTargetY
// [378] currentTargetZ
// [379] setWaitingToMove
// [380] waitingToMove
// [381] actionState
// [382] keepGatheringWhenObjectIsOut
// [383] produceWhenKilledBy
// [384] useSameZoneDropsite
// [385] logDebug
// [386] notify
// [387] attack
// [388] attack
// [389] moveTo
// [390] moveTo
// [391] moveTo
// [392] moveAwayFrom
// [393] hunt
// [394] gather
// [395] convert
// [396] repair
// [397] build
// [398] trade
// [399] explore
// [400] enter
// [401] unload
// [402] transport
// [403] stopAction
// [404] pause
// [405] canPath
// [406] canPath
// [407] canBidirectionPath
// [408] canPathWithObstructions
// [409] canPathWithAdditionalPassability
// [410] findFirstTerrainAlongExceptionPath
// [411] canLinePath
// [412] canLinePath
// [413] firstTileAlongLine
// [414] userDefinedWaypoint
// [415] addUserDefinedWaypoint
// [416] removeAllUserDefinedWaypoints
// [417] removeUserDefinedWaypoint
// [418] numberUserDefinedWaypoints
// [419] findAvoidancePath
// [420] get_action_checksum
// [421] get_waypoint_checksum
// [422] setup
// [423] setup
// [424] create_object_list
// [425] create_sprite_list
// [426] setup
// [427] recycle_in_to_game
// [428] validate
// [429] setup
//
// Member Layout:
// [0x490] uchar dlg_type
// [0x494] TTextPanel * text
// [0x498] TButtonPanel *[3] button (sz: 0xC)
// ----------------------------------------------------------------

// Function: TMessageDialog
// Address: 0043fc70
/* public: __thiscall TMessageDialog::TMessageDialog(char *) */

TMessageDialog * __thiscall TMessageDialog::TMessageDialog(TMessageDialog *this,char *param_1)
{
  TDialogPanel::TDialogPanel((TDialogPanel *)this,param_1);
  this->dlg_type = '\0';
  this->text = (TTextPanel *)0x0;
  this->_padding_ = (int)&_vftable_;
  this->button[0] = (TButtonPanel *)0x0;
  this->button[1] = (TButtonPanel *)0x0;
  this->button[2] = (TButtonPanel *)0x0;
  return this;
}

// --------------------------------------------------

// Function: `scalar_deleting_destructor'
// Address: 0043fcb0
/* public: virtual void * __thiscall TMessageDialog::`scalar deleting destructor'(unsigned int) */

void * __thiscall TMessageDialog::_scalar_deleting_destructor_(TMessageDialog *this,uint param_1)
{
  ~TMessageDialog(this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return this;
}

// --------------------------------------------------

// Function: ~TMessageDialog
// Address: 0043fcd0
/* public: virtual __thiscall TMessageDialog::~TMessageDialog(void) */

void __thiscall TMessageDialog::~TMessageDialog(TMessageDialog *this)
{
  TButtonPanel **ppTVar1;
  int iVar2;
  undefined4 *unaff_FS_OFFSET;
  undefined4 uStack_c;
  code *pcStack_8;
  undefined4 local_4;
  
  pcStack_8 = FUN_0055d198;
  uStack_c = *unaff_FS_OFFSET;
  *unaff_FS_OFFSET = &uStack_c;
  this->_padding_ = (int)&_vftable_;
  local_4 = 0;
  if (this->text != (TTextPanel *)0x0) {
    (**(code **)this->text->_padding_)(1);
  }
  ppTVar1 = this->button;
  iVar2 = 3;
  do {
    if (*ppTVar1 != (TButtonPanel *)0x0) {
      (**(code **)(*ppTVar1)->_padding_)(1);
    }
    ppTVar1 = ppTVar1 + 1;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  local_4 = 0xffffffff;
  TDialogPanel::~TDialogPanel((TDialogPanel *)this);
  *unaff_FS_OFFSET = uStack_c;
  return;
}

// --------------------------------------------------

// Function: setup
// Address: 0043fd50
// [HELPER] s_: ""
/* public: long __thiscall TMessageDialog::setup(class TPanel *,char *,long,long,long,unsigned
   char,char *,long,long) */

long __thiscall
TMessageDialog::setup
          (TMessageDialog *this,TPanel *param_1,char *param_2,long param_3,long param_4,long param_5
          ,uchar param_6,char *param_7,long param_8,long param_9)
{
  TDrawArea *pTVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  TButtonPanel *pTVar6;
  TButtonPanel **ppTVar7;
  undefined4 unaff_EBP;
  int unaff_ESI;
  long lVar8;
  int iVar9;
  code *pcVar10;
  int iVar11;
  
  iVar11 = 1;
  this->button[0] = (TButtonPanel *)0x0;
  this->button[1] = (TButtonPanel *)0x0;
  this->button[2] = (TButtonPanel *)0x0;
  pTVar1 = TPanel::renderArea(param_1);
  iVar11 = TDialogPanel::setup((TDialogPanel *)this,pTVar1,param_1,param_4,param_5,param_2,param_3,
                               iVar11);
  if (iVar11 == 0) {
switchD_0043fdf0_default:
    return 0;
  }
  iVar11 = this->_padding_;
  this->dlg_type = param_6;
  iVar2 = (**(code **)(iVar11 + 0x100))
                    (this,&this->text,param_7,3,3,this->_padding_ + -3,
                     (this->_padding_ - param_9) + -6,0xb,1,1,1);
  if (iVar2 == 0) {
    return 0;
  }
  switch(this->dlg_type) {
  case '\0':
    iVar2 = 1;
    break;
  case '\x01':
  case '\x02':
  case '\x03':
    iVar2 = 2;
    break;
  case '\x04':
    iVar2 = 3;
    break;
  default:
    goto switchD_0043fdf0_default;
  }
  iVar3 = this->_padding_ - iVar2 * unaff_ESI;
  if (iVar3 < 1) {
    iVar3 = 0;
  }
  else {
    iVar3 = iVar3 / (iVar2 + 1);
  }
  iVar4 = (this->_padding_ - param_9) + -7;
  iVar9 = 0;
  if (iVar2 != 0) {
    pcVar10 = *(code **)(iVar11 + 0xec);
    ppTVar7 = this->button;
    iVar11 = iVar3;
    do {
      iVar5 = (*pcVar10)(this,ppTVar7,s_,s_,iVar3,iVar4,unaff_ESI,unaff_EBP,0xb,0,0);
      if (iVar5 == 0) {
        return 0;
      }
      ppTVar7 = ppTVar7 + 1;
      iVar3 = iVar3 + iVar11 + unaff_ESI;
      iVar9 = iVar9 + 1;
    } while (iVar9 < iVar2);
  }
  switch(this->dlg_type) {
  case '\0':
                    /* language.dll match for 0xfa1: "OK" */
    TButtonPanel::set_text(this->button[0],0,0xfa1);
    goto switchD_0043fec6_default;
  case '\x01':
                    /* language.dll match for 0xfa1: "OK" */
    TButtonPanel::set_text(this->button[0],0,0xfa1);
    lVar8 = 0xfa2;
    break;
  case '\x02':
                    /* language.dll match for 0xfa3: "Yes" */
    TButtonPanel::set_text(this->button[0],0,0xfa3);
    lVar8 = 0xfa4;
    break;
  case '\x03':
                    /* language.dll match for 0xfa5: "Retry" */
    TButtonPanel::set_text(this->button[0],0,0xfa5);
                    /* language.dll match for 0xfa7: "Abort" */
    lVar8 = 0xfa7;
    break;
  case '\x04':
                    /* language.dll match for 0xfa3: "Yes" */
    TButtonPanel::set_text(this->button[0],0,0xfa3);
                    /* language.dll match for 0xfa4: "No" */
    TButtonPanel::set_text(this->button[1],0,0xfa4);
                    /* language.dll match for 0xfa2: "Cancel" */
    TButtonPanel::set_text(this->button[2],0,0xfa2);
    pTVar6 = this->button[2];
    goto LAB_0043ff7e;
  default:
    goto switchD_0043fec6_default;
  }
  TButtonPanel::set_text(this->button[1],0,lVar8);
  pTVar6 = this->button[1];
LAB_0043ff7e:
  pTVar6->hotkey = 0x1b;
  pTVar6->hotkey_shift = 0;
switchD_0043fec6_default:
  (**(code **)(this->_padding_ + 200))(this->button,iVar2);
  TPanel::set_curr_child((TPanel *)this,(TPanel *)this->button[0]);
  return 1;
}

// --------------------------------------------------

// Function: setup
// Address: 0043fff0
/* WARNING: Variable defined which should be unmapped: str */
/* public: long __thiscall TMessageDialog::setup(class TPanel *,char *,long,long,long,unsigned
   char,int,long,long) */

long __thiscall
TMessageDialog::setup
          (TMessageDialog *this,TPanel *param_1,char *param_2,long param_3,long param_4,long param_5
          ,uchar param_6,int param_7,long param_8,long param_9)
{
  long lVar1;
  char str [256];
  
  TPanel::get_string((TPanel *)this,param_7,str + 4,0x100);
  lVar1 = setup(this,param_1,param_2,param_3,param_4,param_5,param_6,str + 4,param_8,param_9);
  return lVar1;
}

// --------------------------------------------------

// Function: action
// Address: 00440070
/* public: virtual long __thiscall TMessageDialog::action(class TPanel *,long,unsigned long,unsigned
   long) */

long __thiscall
TMessageDialog::action
          (TMessageDialog *this,TPanel *param_1,long param_2,ulong param_3,ulong param_4)
{
  int *piVar1;
  long lVar2;
  
  piVar1 = (int *)this->_padding_;
  if ((piVar1 != (int *)0x0) && (param_2 == 1)) {
    if ((TButtonPanel *)param_1 == this->button[0]) {
      (**(code **)(*piVar1 + 0xb4))(this,0,0,0);
      return 1;
    }
    if ((TButtonPanel *)param_1 == this->button[1]) {
      (**(code **)(*piVar1 + 0xb4))(this,1,0,0);
      return 1;
    }
    if ((TButtonPanel *)param_1 == this->button[2]) {
      (**(code **)(*piVar1 + 0xb4))(this,2,0,0);
      return 1;
    }
  }
  lVar2 = TEasy_Panel::action((TEasy_Panel *)this,param_1,param_2,param_3,param_4);
  return lVar2;
}

// --------------------------------------------------

// Function: key_down_action
// Address: 00440100
/* public: virtual long __thiscall TMessageDialog::key_down_action(long,short,int,int,int) */

long __thiscall
TMessageDialog::key_down_action
          (TMessageDialog *this,long param_1,short param_2,int param_3,int param_4,int param_5)
{
  return 0;
}

// --------------------------------------------------

// Function: handle_idle
// Address: 00440110
/* public: virtual long __thiscall TMessageDialog::handle_idle(void) */

long __thiscall TMessageDialog::handle_idle(TMessageDialog *this)
{
  long lVar1;
  
  if (rge_base_game->input_enabled == 0) {
    RGE_Base_Game::enable_input(rge_base_game);
  }
  lVar1 = TPanel::handle_idle((TPanel *)this);
  return lVar1;
}

// --------------------------------------------------

