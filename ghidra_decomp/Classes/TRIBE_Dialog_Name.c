// Class: TRIBE_Dialog_Name
// Size:  0x4A4
//
// VTable Layout:
// [00] `scalar_deleting_destructor'
// [01] setup
// [02] set_rect
// [03] set_rect
// [04] set_color
// [05] set_active
// [06] set_positioning
// [07] set_fixed_position
// [08] set_redraw
// [09] set_overlapped_redraw
// [10] draw_setup
// [11] draw_finish
// [12] draw
// [13] draw_rect
// [14] draw_offset
// [15] draw_rect2
// [16] draw_offset2
// [17] paint
// [18] wnd_proc
// [19] handle_idle
// [20] handle_size
// [21] handle_paint
// [22] handle_key_down
// [23] handle_char
// [24] handle_command
// [25] handle_user_command
// [26] handle_timer_command
// [27] handle_scroll
// [28] handle_mouse_down
// [29] handle_mouse_move
// [30] handle_mouse_up
// [31] handle_mouse_dbl_click
// [32] mouse_move_action
// [33] mouse_left_down_action
// [34] mouse_left_hold_action
// [35] mouse_left_move_action
// [36] mouse_left_up_action
// [37] mouse_left_dbl_click_action
// [38] mouse_right_down_action
// [39] mouse_right_hold_action
// [40] mouse_right_move_action
// [41] mouse_right_up_action
// [42] mouse_right_dbl_click_action
// [43] key_down_action
// [44] char_action
// [45] action
// [46] get_true_render_rect
// [47] is_inside
// [48] set_focus
// [49] set_tab_order
// [50] set_tab_order
// [51] get_help_info
// [52] stop_sound_system
// [53] restart_sound_system
// [54] take_snapshot
// [55] handle_reactivate
// [56] draw_background
// [57] set_ideal_size
// [58] create_button
// [59] create_button
// [60] create_check_box
// [61] create_radio_button
// [62] create_text
// [63] create_text
// [64] create_text
// [65] create_input
// [66] create_edit
// [67] create_drop_down
// [68] create_list
// [69] create_scrollbar
// [70] create_auto_scrollbar
// [71] create_vert_slider
// [72] create_horz_slider
// [73] position_panel
// [74] setup
// [75] setup
// [76] `vector_deleting_destructor'
// [77] setup
// [78] set_rect
// [79] set_rect
// [80] set_color
// [81] set_active
// [82] set_positioning
// [83] set_fixed_position
// [84] set_redraw
// [85] set_overlapped_redraw
// [86] draw_setup
// [87] draw_finish
// [88] draw
// [89] draw_rect
// [90] draw_offset
// [91] draw_rect2
// [92] draw_offset2
// [93] paint
// [94] wnd_proc
// [95] handle_idle
// [96] handle_size
// [97] handle_paint
// [98] handle_key_down
// [99] handle_char
// [100] handle_command
// [101] handle_user_command
// [102] handle_timer_command
// [103] handle_scroll
// [104] handle_mouse_down
// [105] handle_mouse_move
// [106] handle_mouse_up
// [107] handle_mouse_dbl_click
// [108] mouse_move_action
// [109] mouse_left_down_action
// [110] mouse_left_hold_action
// [111] mouse_left_move_action
// [112] mouse_left_up_action
// [113] mouse_left_dbl_click_action
// [114] mouse_right_down_action
// [115] mouse_right_hold_action
// [116] mouse_right_move_action
// [117] mouse_right_up_action
// [118] mouse_right_dbl_click_action
// [119] key_down_action
// [120] char_action
// [121] action
// [122] get_true_render_rect
// [123] is_inside
// [124] set_focus
// [125] set_tab_order
// [126] set_tab_order
// [127] get_help_info
// [128] stop_sound_system
// [129] restart_sound_system
// [130] take_snapshot
// [131] handle_reactivate
// [132] draw_background
// [133] set_ideal_size
// [134] create_button
// [135] create_button
// [136] create_check_box
// [137] create_radio_button
// [138] create_text
// [139] create_text
// [140] create_text
// [141] create_input
// [142] create_edit
// [143] create_drop_down
// [144] create_list
// [145] create_scrollbar
// [146] create_auto_scrollbar
// [147] create_vert_slider
// [148] create_horz_slider
// [149] position_panel
// [150] `vector_deleting_destructor'
// [151] setup
// [152] set_rect
// [153] set_rect
// [154] set_color
// [155] set_active
// [156] set_positioning
// [157] set_fixed_position
// [158] set_redraw
// [159] set_overlapped_redraw
// [160] draw_setup
// [161] draw_finish
// [162] draw
// [163] draw_rect
// [164] draw_offset
// [165] draw_rect2
// [166] draw_offset2
// [167] paint
// [168] wnd_proc
// [169] handle_idle
// [170] handle_size
// [171] handle_paint
// [172] handle_key_down
// [173] handle_char
// [174] handle_command
// [175] handle_user_command
// [176] handle_timer_command
// [177] handle_scroll
// [178] handle_mouse_down
// [179] handle_mouse_move
// [180] handle_mouse_up
// [181] handle_mouse_dbl_click
// [182] mouse_move_action
// [183] mouse_left_down_action
// [184] mouse_left_hold_action
// [185] mouse_left_move_action
// [186] mouse_left_up_action
// [187] mouse_left_dbl_click_action
// [188] mouse_right_down_action
// [189] mouse_right_hold_action
// [190] mouse_right_move_action
// [191] mouse_right_up_action
// [192] mouse_right_dbl_click_action
// [193] key_down_action
// [194] char_action
// [195] action
// [196] get_true_render_rect
// [197] is_inside
// [198] set_focus
// [199] set_tab_order
// [200] set_tab_order
// [201] get_help_info
// [202] stop_sound_system
// [203] restart_sound_system
// [204] take_snapshot
// [205] handle_reactivate
// [206] draw_background
// [207] set_ideal_size
// [208] create_button
// [209] create_button
// [210] create_check_box
// [211] create_radio_button
// [212] create_text
// [213] create_text
// [214] create_text
// [215] create_input
// [216] create_edit
// [217] create_drop_down
// [218] create_list
// [219] create_scrollbar
// [220] create_auto_scrollbar
// [221] create_vert_slider
// [222] create_horz_slider
// [223] position_panel
//
// Member Layout:
// [0x490] TTextPanel * title
// [0x494] TTextPanel * name_text
// [0x498] TEditPanel * name_input
// [0x49C] TButtonPanel * ok_button
// [0x4A0] TButtonPanel * cancel_button
// ----------------------------------------------------------------

// Function: TRIBE_Dialog_Name
// Address: 004a6d50
// [HELPER] s_: ""
// [HELPER] s_New_Name_Dialog: "New Name Dialog"
/* public: __thiscall TRIBE_Dialog_Name::TRIBE_Dialog_Name(class TScreenPanel *) */

TRIBE_Dialog_Name * __thiscall
TRIBE_Dialog_Name::TRIBE_Dialog_Name(TRIBE_Dialog_Name *this,TScreenPanel *param_1)
{
  TEditPanel **ppTVar1;
  TButtonPanel *pTVar2;
  long lVar3;
  char *pcVar4;
  TDrawArea *pTVar5;
  undefined4 *unaff_FS_OFFSET;
  long lVar6;
  long lVar7;
  int iVar8;
  TPanel *tab_list [3];
  undefined4 local_c;
  code *pcStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  pcStack_8 = FUN_0055f358;
  local_c = *unaff_FS_OFFSET;
  *unaff_FS_OFFSET = &local_c;
  tab_list[0] = (TPanel *)this;
  TDialogPanel::TDialogPanel((TDialogPanel *)this,&s_New_Name_Dialog);
  ppTVar1 = &this->name_input;
  iVar8 = 1;
  local_4 = 0;
  this->_padding_ = (int)&_vftable_;
  this->title = (TTextPanel *)0x0;
  this->name_text = (TTextPanel *)0x0;
  *ppTVar1 = (TEditPanel *)0x0;
  this->ok_button = (TButtonPanel *)0x0;
  this->cancel_button = (TButtonPanel *)0x0;
  lVar3 = TEasy_Panel::get_popup_info_id((TEasy_Panel *)param_1);
  pcVar4 = TEasy_Panel::get_popup_info_file((TEasy_Panel *)param_1);
  lVar7 = 0xe6;
  lVar6 = 500;
  pTVar5 = TPanel::renderArea((TPanel *)param_1);
  iVar8 = TDialogPanel::setup((TDialogPanel *)this,pTVar5,(TPanel *)param_1,lVar6,lVar7,pcVar4,lVar3
                              ,iVar8);
  if (iVar8 != 0) {
                    /* language.dll match for 0x2a03: "Name" */
    iVar8 = TEasy_Panel::create_text
                      ((TEasy_Panel *)this,(TPanel *)this,&this->title,0x2a03,0x14,0x14,0x1cc,0x1e,1
                       ,1,1,0);
    if (iVar8 != 0) {
                    /* language.dll match for 0x2a04: "New Player" */
      iVar8 = TEasy_Panel::create_text
                        ((TEasy_Panel *)this,(TPanel *)this,&this->name_text,0x2a04,0x28,0x55,0x1a4,
                         0x14,4,0,1,0);
      if (iVar8 != 0) {
                    /* language.dll match for 0x6e: "Copperplate Gothic Light" */
        iVar8 = TEasy_Panel::create_edit
                          ((TEasy_Panel *)this,(TPanel *)this,ppTVar1,s_,0xf,FormatText,0x28,0x6e,
                           0x1a4,0x17,0xb,1,1);
        if (iVar8 != 0) {
                    /* language.dll match for 0xfa1: "OK" */
          iVar8 = TEasy_Panel::create_button
                            ((TEasy_Panel *)this,(TPanel *)this,&this->ok_button,0xfa1,0,0x3c,0xb4,
                             0xb4,0x1e,0,0,0);
          if (iVar8 != 0) {
                    /* language.dll match for 0xfa2: "Cancel" */
            iVar8 = TEasy_Panel::create_button
                              ((TEasy_Panel *)this,(TPanel *)this,&this->cancel_button,0xfa2,0,0x104
                               ,0xb4,0xb4,0x1e,0,0,0);
            if (iVar8 != 0) {
              pTVar2 = this->cancel_button;
              pTVar2->hotkey = 0x1b;
              pTVar2->hotkey_shift = 0;
              tab_list[1] = (TPanel *)*ppTVar1;
              tab_list[2] = (TPanel *)this->ok_button;
              TPanel::set_tab_order((TPanel *)this,tab_list + 1,3);
              TPanel::set_curr_child((TPanel *)this,(TPanel *)*ppTVar1);
            }
          }
        }
      }
    }
  }
  *unaff_FS_OFFSET = local_c;
  return this;
}

// --------------------------------------------------

// Function: `scalar_deleting_destructor'
// Address: 004a6f40
/* public: virtual void * __thiscall TRIBE_Dialog_Name::`scalar deleting destructor'(unsigned int)
    */

void * __thiscall
TRIBE_Dialog_Name::_scalar_deleting_destructor_(TRIBE_Dialog_Name *this,uint param_1)
{
  ~TRIBE_Dialog_Name(this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return this;
}

// --------------------------------------------------

// Function: ~TRIBE_Dialog_Name
// Address: 004a6f60
/* public: virtual __thiscall TRIBE_Dialog_Name::~TRIBE_Dialog_Name(void) */

void __thiscall TRIBE_Dialog_Name::~TRIBE_Dialog_Name(TRIBE_Dialog_Name *this)
{
  undefined4 *unaff_FS_OFFSET;
  undefined4 local_c;
  code *pcStack_8;
  undefined4 local_4;
  
  pcStack_8 = FUN_0055f378;
  local_c = *unaff_FS_OFFSET;
  *unaff_FS_OFFSET = &local_c;
  this->_padding_ = (int)&_vftable_;
  local_4 = 0;
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->title);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->name_text);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->name_input);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->ok_button);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->cancel_button);
  local_4 = 0xffffffff;
  TDialogPanel::~TDialogPanel((TDialogPanel *)this);
  *unaff_FS_OFFSET = local_c;
  return;
}

// --------------------------------------------------

// Function: action
// Address: 004a6ff0
// [HELPER] s_Campaign_Selection_Screen: "Campaign Selection Screen"
// [HELPER] s_Name_Selection_Screen: "Name Selection Screen"
// [HELPER] s_New_Name_Dialog: "New Name Dialog"
// [HELPER] s_Single_Player_Menu: "Single Player Menu"
/* public: virtual long __thiscall TRIBE_Dialog_Name::action(class TPanel *,long,unsigned
   long,unsigned long) */

long __thiscall
TRIBE_Dialog_Name::action
          (TRIBE_Dialog_Name *this,TPanel *param_1,long param_2,ulong param_3,ulong param_4)
{
  RGE_Game_Info *this_00;
  char *pcVar1;
  TRIBE_Screen_Campaign_Selection *this_01;
  TPanel *pTVar2;
  TribeSPMenuScreen *this_02;
  long lVar3;
  undefined4 *unaff_FS_OFFSET;
  undefined4 local_c;
  code *pcStack_8;
  undefined4 local_4;
  
  local_c = *unaff_FS_OFFSET;
  local_4 = 0xffffffff;
  pcStack_8 = FUN_0055f3a6;
  *unaff_FS_OFFSET = &local_c;
  if (param_1 != (TPanel *)0x0) {
    if ((((TButtonPanel *)param_1 == this->ok_button) && (param_2 == 1)) ||
       (((TEditPanel *)param_1 == this->name_input && (param_2 == 0)))) {
      pcVar1 = TEditPanel::get_text(this->name_input);
      if (*pcVar1 == '\0') {
        TPanel::set_curr_child((TPanel *)this,(TPanel *)this->name_input);
        *unaff_FS_OFFSET = local_c;
        return 1;
      }
      this_00 = rge_base_game->player_game_info;
      pcVar1 = TEditPanel::get_text(this->name_input);
      RGE_Game_Info::add_new_person(this_00,pcVar1);
      this_01 = (TRIBE_Screen_Campaign_Selection *)operator_new(0x4cc);
      local_4 = 0;
      if (this_01 != (TRIBE_Screen_Campaign_Selection *)0x0) {
        TRIBE_Screen_Campaign_Selection::TRIBE_Screen_Campaign_Selection(this_01);
      }
      local_4 = 0xffffffff;
      TPanelSystem::setCurrentPanel(&panel_system,s_Campaign_Selection_Screen,0);
      TPanelSystem::destroyPanel(&panel_system,&s_New_Name_Dialog);
      TPanelSystem::destroyPanel(&panel_system,s_Name_Selection_Screen);
      *unaff_FS_OFFSET = local_c;
      return 1;
    }
    if ((((TButtonPanel *)param_1 == this->cancel_button) && (param_2 == 1)) ||
       (((TEditPanel *)param_1 == this->name_input && (param_2 == 1)))) {
      pTVar2 = TPanelSystem::panel(&panel_system,s_Name_Selection_Screen);
      if (pTVar2 == (TPanel *)0x0) {
        this_02 = (TribeSPMenuScreen *)operator_new(0x49c);
        local_4 = 1;
        if (this_02 != (TribeSPMenuScreen *)0x0) {
          TribeSPMenuScreen::TribeSPMenuScreen(this_02);
        }
        local_4 = 0xffffffff;
        pcVar1 = s_Single_Player_Menu;
      }
      else {
        pcVar1 = s_Name_Selection_Screen;
      }
      TPanelSystem::setCurrentPanel(&panel_system,pcVar1,0);
      TPanelSystem::destroyPanel(&panel_system,&s_New_Name_Dialog);
      *unaff_FS_OFFSET = local_c;
      return 1;
    }
  }
  lVar3 = TEasy_Panel::action((TEasy_Panel *)this,param_1,param_2,param_3,param_4);
  *unaff_FS_OFFSET = local_c;
  return lVar3;
}

// --------------------------------------------------

// Function: wnd_proc
// Address: 004a71d0
/* public: virtual long __thiscall TRIBE_Dialog_Name::wnd_proc(void *,unsigned int,unsigned
   int,long) */

long __thiscall
TRIBE_Dialog_Name::wnd_proc
          (TRIBE_Dialog_Name *this,void *param_1,uint param_2,uint param_3,long param_4)
{
  long lVar1;
  
  lVar1 = TPanel::wnd_proc((TPanel *)this,param_1,param_2,param_3,param_4);
  return lVar1;
}

// --------------------------------------------------

