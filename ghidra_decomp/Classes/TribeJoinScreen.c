// Class: TribeJoinScreen
// Size:  0x4B0
//
// VTable Layout:
// [00] `scalar_deleting_destructor'
// [01] setup
// [02] set_rect
// [03] set_rect
// [04] set_color
// [05] set_active
// [06] set_positioning
// [07] set_fixed_position
// [08] set_redraw
// [09] set_overlapped_redraw
// [10] draw_setup
// [11] draw_finish
// [12] draw
// [13] draw_rect
// [14] draw_offset
// [15] draw_rect2
// [16] draw_offset2
// [17] paint
// [18] wnd_proc
// [19] handle_idle
// [20] handle_size
// [21] handle_paint
// [22] handle_key_down
// [23] handle_char
// [24] handle_command
// [25] handle_user_command
// [26] handle_timer_command
// [27] handle_scroll
// [28] handle_mouse_down
// [29] handle_mouse_move
// [30] handle_mouse_up
// [31] handle_mouse_dbl_click
// [32] mouse_move_action
// [33] mouse_left_down_action
// [34] mouse_left_hold_action
// [35] mouse_left_move_action
// [36] mouse_left_up_action
// [37] mouse_left_dbl_click_action
// [38] mouse_right_down_action
// [39] mouse_right_hold_action
// [40] mouse_right_move_action
// [41] mouse_right_up_action
// [42] mouse_right_dbl_click_action
// [43] key_down_action
// [44] char_action
// [45] action
// [46] get_true_render_rect
// [47] is_inside
// [48] set_focus
// [49] set_tab_order
// [50] set_tab_order
// [51] get_help_info
// [52] stop_sound_system
// [53] restart_sound_system
// [54] take_snapshot
// [55] handle_reactivate
// [56] draw_background
// [57] set_ideal_size
// [58] create_button
// [59] create_button
// [60] create_check_box
// [61] create_radio_button
// [62] create_text
// [63] create_text
// [64] create_text
// [65] create_input
// [66] create_edit
// [67] create_drop_down
// [68] create_list
// [69] create_scrollbar
// [70] create_auto_scrollbar
// [71] create_vert_slider
// [72] create_horz_slider
// [73] position_panel
// [74] `vector_deleting_destructor'
// [75] setup
// [76] set_rect
// [77] set_rect
// [78] set_color
// [79] set_active
// [80] set_positioning
// [81] set_fixed_position
// [82] set_redraw
// [83] set_overlapped_redraw
// [84] draw_setup
// [85] draw_finish
// [86] draw
// [87] draw_rect
// [88] draw_offset
// [89] draw_rect2
// [90] draw_offset2
// [91] paint
// [92] wnd_proc
// [93] handle_idle
// [94] handle_size
// [95] handle_paint
// [96] handle_key_down
// [97] handle_char
// [98] handle_command
// [99] handle_user_command
// [100] handle_timer_command
// [101] handle_scroll
// [102] handle_mouse_down
// [103] handle_mouse_move
// [104] handle_mouse_up
// [105] handle_mouse_dbl_click
// [106] mouse_move_action
// [107] mouse_left_down_action
// [108] mouse_left_hold_action
// [109] mouse_left_move_action
// [110] mouse_left_up_action
// [111] mouse_left_dbl_click_action
// [112] mouse_right_down_action
// [113] mouse_right_hold_action
// [114] mouse_right_move_action
// [115] mouse_right_up_action
// [116] mouse_right_dbl_click_action
// [117] key_down_action
// [118] char_action
// [119] action
// [120] get_true_render_rect
// [121] is_inside
// [122] set_focus
// [123] set_tab_order
// [124] set_tab_order
// [125] get_help_info
// [126] stop_sound_system
// [127] restart_sound_system
// [128] take_snapshot
// [129] handle_reactivate
// [130] draw_background
// [131] set_ideal_size
// [132] create_button
// [133] create_button
// [134] create_check_box
// [135] create_radio_button
// [136] create_text
// [137] create_text
// [138] create_text
// [139] create_input
// [140] create_edit
// [141] create_drop_down
// [142] create_list
// [143] create_scrollbar
// [144] create_auto_scrollbar
// [145] create_vert_slider
// [146] create_horz_slider
// [147] position_panel
// [148] setup
// [149] setup
// [150] `scalar_deleting_destructor'
// [151] setup
// [152] set_rect
// [153] set_rect
// [154] set_color
// [155] set_active
// [156] set_positioning
// [157] set_fixed_position
// [158] set_redraw
// [159] set_overlapped_redraw
// [160] draw_setup
// [161] draw_finish
// [162] draw
// [163] draw_rect
// [164] draw_offset
// [165] draw_rect2
// [166] draw_offset2
// [167] paint
// [168] wnd_proc
// [169] handle_idle
// [170] handle_size
// [171] handle_paint
// [172] handle_key_down
// [173] handle_char
// [174] handle_command
// [175] handle_user_command
// [176] handle_timer_command
// [177] handle_scroll
// [178] handle_mouse_down
// [179] handle_mouse_move
// [180] handle_mouse_up
// [181] handle_mouse_dbl_click
// [182] mouse_move_action
// [183] mouse_left_down_action
// [184] mouse_left_hold_action
// [185] mouse_left_move_action
// [186] mouse_left_up_action
// [187] mouse_left_dbl_click_action
// [188] mouse_right_down_action
// [189] mouse_right_hold_action
// [190] mouse_right_move_action
// [191] mouse_right_up_action
// [192] mouse_right_dbl_click_action
// [193] key_down_action
// [194] char_action
// [195] action
// [196] get_true_render_rect
// [197] is_inside
// [198] set_focus
// [199] set_tab_order
// [200] set_tab_order
// [201] get_help_info
// [202] stop_sound_system
// [203] restart_sound_system
// [204] take_snapshot
// [205] handle_reactivate
// [206] draw_background
// [207] set_ideal_size
// [208] create_button
// [209] create_button
// [210] create_check_box
// [211] create_radio_button
// [212] create_text
// [213] create_text
// [214] create_text
// [215] create_input
// [216] create_edit
// [217] create_drop_down
// [218] create_list
// [219] create_scrollbar
// [220] create_auto_scrollbar
// [221] create_vert_slider
// [222] create_horz_slider
// [223] position_panel
// [224] `vector_deleting_destructor'
// [225] setup
// [226] set_rect
// [227] set_rect
// [228] set_color
// [229] set_active
// [230] set_positioning
// [231] set_fixed_position
// [232] set_redraw
// [233] set_overlapped_redraw
// [234] draw_setup
// [235] draw_finish
// [236] draw
// [237] draw_rect
// [238] draw_offset
// [239] draw_rect2
// [240] draw_offset2
// [241] paint
// [242] wnd_proc
// [243] handle_idle
// [244] handle_size
// [245] handle_paint
// [246] handle_key_down
// [247] handle_char
// [248] handle_command
// [249] handle_user_command
// [250] handle_timer_command
// [251] handle_scroll
// [252] handle_mouse_down
// [253] handle_mouse_move
// [254] handle_mouse_up
// [255] handle_mouse_dbl_click
// [256] mouse_move_action
// [257] mouse_left_down_action
// [258] mouse_left_hold_action
// [259] mouse_left_move_action
// [260] mouse_left_up_action
// [261] mouse_left_dbl_click_action
// [262] mouse_right_down_action
// [263] mouse_right_hold_action
// [264] mouse_right_move_action
// [265] mouse_right_up_action
// [266] mouse_right_dbl_click_action
// [267] key_down_action
// [268] char_action
// [269] action
// [270] get_true_render_rect
// [271] is_inside
// [272] set_focus
// [273] set_tab_order
// [274] set_tab_order
// [275] get_help_info
// [276] stop_sound_system
// [277] restart_sound_system
// [278] take_snapshot
// [279] handle_reactivate
// [280] set_text
// [281] set_text
// [282] set_text
// [283] set_bevel_info
//
// Member Layout:
// [0x478] int startedSession
// [0x47C] int listFilled
// [0x480] TTextPanel * title
// [0x484] TTextPanel * listTitle
// [0x488] TListPanel * list
// [0x48C] TScrollBarPanel * scrollbar
// [0x490] TButtonPanel * joinButton
// [0x494] TButtonPanel * createButton
// [0x498] TButtonPanel * cancelButton
// [0x49C] TButtonPanel * refreshButton
// [0x4A0] TButtonPanel * close_button
// [0x4A4] int game_count
// [0x4A8] int waitingToStart
// [0x4AC] ulong joinTime
// ----------------------------------------------------------------

// Function: TribeJoinScreen
// Address: 00491650
// [HELPER] s_Join_Screen: "Join Screen"
// [HELPER] s_scr3: "scr3"
/* public: __thiscall TribeJoinScreen::TribeJoinScreen(void) */

TribeJoinScreen * __thiscall TribeJoinScreen::TribeJoinScreen(TribeJoinScreen *this)
{
  TListPanel **ppTVar1;
  TButtonPanel **ppTVar2;
  TButtonPanel *pTVar3;
  long lVar4;
  int iVar5;
  uint uVar6;
  undefined4 *unaff_FS_OFFSET;
  TPanel *tabList [5];
  undefined4 local_c;
  code *pcStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  pcStack_8 = FUN_0055e9a8;
  local_c = *unaff_FS_OFFSET;
  *unaff_FS_OFFSET = &local_c;
  tabList[0] = (TPanel *)this;
  TScreenPanel::TScreenPanel((TScreenPanel *)this,s_Join_Screen);
  this->_padding_ = (int)&_vftable_;
  this->startedSession = 0;
  this->listFilled = 0;
  Sess = (TCommunications_Sessions *)0x0;
  this->game_count = 0;
  this->waitingToStart = 0;
  this->joinTime = 0;
  this->close_button = (TButtonPanel *)0x0;
  local_4 = 0;
  TCommunications_Handler::SetPlayerHumanity(comm,1,ME_HUMAN);
  uVar6 = 2;
  do {
    TCommunications_Handler::SetPlayerHumanity(comm,uVar6,ME_ABSENT);
    uVar6 = uVar6 + 1;
  } while ((int)uVar6 < 10);
  lVar4 = TScreenPanel::setup((TScreenPanel *)this,rge_base_game->draw_area,&s_scr3,0xc385,1);
  if (lVar4 == 0) {
    this->_padding_ = 1;
    *unaff_FS_OFFSET = local_c;
    return this;
  }
  TEasy_Panel::setup_shadow_area((TEasy_Panel *)this,0);
  TEasy_Panel::set_ideal_size((TEasy_Panel *)this,0x280,0x1e0);
                    /* language.dll match for 0x259f: "Multiplayer Games" */
  iVar5 = TEasy_Panel::create_text
                    ((TEasy_Panel *)this,(TPanel *)this,&this->title,0x259f,0x14,0x14,600,0x1e,1,1,0
                     ,0);
  if (iVar5 != 0) {
                    /* language.dll match for 0x25a8: "Select Game to Join" */
    TEasy_Panel::create_text
              ((TEasy_Panel *)this,(TPanel *)this,&this->listTitle,0x25a8,0x14,0x41,600,0x14,4,0,0,0
              );
    ppTVar1 = &this->list;
    iVar5 = TEasy_Panel::create_list
                      ((TEasy_Panel *)this,(TPanel *)this,ppTVar1,0x14,0x5a,600,0x10e,0xb);
    if (iVar5 != 0) {
      iVar5 = TEasy_Panel::create_auto_scrollbar
                        ((TEasy_Panel *)this,&this->scrollbar,(TTextPanel *)*ppTVar1,0x14);
      if (iVar5 != 0) {
                    /* language.dll match for 0x25ab: "Click Show Games to see a list of games.
                       Click Create to start a new game." */
        this->listFilled = 1;
        (**(code **)((*ppTVar1)->_padding_ + 0xe4))(0x25ab);
        ppTVar2 = &this->refreshButton;
                    /* language.dll match for 0x25a1: "Show Games" */
        iVar5 = TEasy_Panel::create_button
                          ((TEasy_Panel *)this,(TPanel *)this,ppTVar2,0x25a1,0,0xd2,0x172,0xdc,0x1e,
                           0,0,0);
        if (iVar5 != 0) {
                    /* language.dll match for 0x25a0: "Join" */
          iVar5 = TEasy_Panel::create_button
                            ((TEasy_Panel *)this,(TPanel *)this,&this->joinButton,0x25a0,0,10,0x1b8,
                             200,0x1e,0,0,0);
          if (iVar5 != 0) {
                    /* language.dll match for 0x25a2: "Create" */
            iVar5 = TEasy_Panel::create_button
                              ((TEasy_Panel *)this,(TPanel *)this,&this->createButton,0x25a2,0,0xdc,
                               0x1b8,200,0x1e,0,0,0);
            if (iVar5 != 0) {
                    /* language.dll match for 0xfa2: "Cancel" */
              iVar5 = TEasy_Panel::create_button
                                ((TEasy_Panel *)this,(TPanel *)this,&this->cancelButton,0xfa2,0,
                                 0x1ae,0x1b8,200,0x1e,0,0,0);
              if (iVar5 != 0) {
                pTVar3 = this->cancelButton;
                pTVar3->hotkey = 0x1b;
                pTVar3->hotkey_shift = 0;
                    /* language.dll match for 0x3ea: "X" */
                iVar5 = TEasy_Panel::create_button
                                  ((TEasy_Panel *)this,(TPanel *)this,&this->close_button,0x3ea,0,0,
                                   0,0,0,-1,-1,0);
                if (iVar5 != 0) {
                  (**(code **)(this->close_button->_padding_ + 0x14))(1);
                  (**(code **)(this->close_button->_padding_ + 0x18))
                            (9,4,4,4,4,0x11,0x11,0x11,0x11,0,0,0,0);
                  TPanel::set_curr_child((TPanel *)this,(TPanel *)*ppTVar2);
                  tabList[3] = (TPanel *)this->joinButton;
                  tabList[1] = (TPanel *)*ppTVar1;
                  tabList[2] = (TPanel *)*ppTVar2;
                  tabList[4] = (TPanel *)this->createButton;
                  TPanel::set_tab_order((TPanel *)this,tabList + 1,5);
                }
              }
            }
          }
        }
      }
    }
  }
  *unaff_FS_OFFSET = local_c;
  return this;
}

// --------------------------------------------------

// Function: `scalar_deleting_destructor'
// Address: 00491970
/* public: virtual void * __thiscall TribeJoinScreen::`scalar deleting destructor'(unsigned int) */

void * __thiscall TribeJoinScreen::_scalar_deleting_destructor_(TribeJoinScreen *this,uint param_1)
{
  ~TribeJoinScreen(this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return this;
}

// --------------------------------------------------

// Function: ~TribeJoinScreen
// Address: 00491990
/* public: virtual __thiscall TribeJoinScreen::~TribeJoinScreen(void) */

void __thiscall TribeJoinScreen::~TribeJoinScreen(TribeJoinScreen *this)
{
  TCommunications_Sessions *pTVar1;
  undefined4 *unaff_FS_OFFSET;
  undefined4 local_c;
  code *pcStack_8;
  undefined4 local_4;
  
  pcStack_8 = FUN_0055e9c8;
  local_c = *unaff_FS_OFFSET;
  *unaff_FS_OFFSET = &local_c;
  this->_padding_ = (int)&_vftable_;
  pTVar1 = Sess;
  local_4 = 0;
  if (Sess != (TCommunications_Sessions *)0x0) {
    TCommunications_Sessions::~TCommunications_Sessions(Sess);
    operator_delete(pTVar1);
  }
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->title);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->listTitle);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->list);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->scrollbar);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->refreshButton);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->joinButton);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->createButton);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->cancelButton);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->close_button);
  local_4 = 0xffffffff;
  TScreenPanel::~TScreenPanel((TScreenPanel *)this);
  *unaff_FS_OFFSET = local_c;
  return;
}

// --------------------------------------------------

// Function: handle_idle
// Address: 00491a80
// [HELPER] s_C__msdev_work_age1_x1_scr_cj_cpp: "C:\msdev\work\age1_x1\scr_cj.cpp"
/* public: virtual long __thiscall TribeJoinScreen::handle_idle(void) */

long __thiscall TribeJoinScreen::handle_idle(TribeJoinScreen *this)
{
  ulong uVar1;
  long lVar2;
  
  if (this->waitingToStart == 0) {
    if ((this->listFilled != 0) && (rge_base_game->input_enabled == 0)) {
      RGE_Base_Game::enable_input(rge_base_game);
    }
    if (this->waitingToStart == 0) goto LAB_00491b15;
  }
  uVar1 = debug_timeGetTime(s_C__msdev_work_age1_x1_scr_cj_cpp,0xaa);
  if (10000 < uVar1 - this->joinTime) {
    TCommunications_Handler::UnlinkToLevel(comm,SERVICE_AVAILABLE);
    this->waitingToStart = 0;
    RGE_Base_Game::enable_input(rge_base_game);
                    /* language.dll match for 0x25a3: "Unable to join game." */
    TEasy_Panel::popupOKDialog((TEasy_Panel *)this,0x25a3,(char *)0x0,0x1c2,100);
    return 1;
  }
LAB_00491b15:
  lVar2 = TPanel::handle_idle((TPanel *)this);
  return lVar2;
}

// --------------------------------------------------

// Function: handle_user_command
// Address: 00491b20
// [HELPER] s_Join_Screen: "Join Screen"
// [HELPER] s_MP_Setup_Screen: "MP Setup Screen"
/* public: virtual long __thiscall TribeJoinScreen::handle_user_command(unsigned int,long) */

long __thiscall
TribeJoinScreen::handle_user_command(TribeJoinScreen *this,uint param_1,long param_2)
{
  TribeMPSetupScreen *this_00;
  long lVar1;
  undefined4 *unaff_FS_OFFSET;
  undefined4 local_c;
  code *pcStack_8;
  undefined4 local_4;
  
  local_c = *unaff_FS_OFFSET;
  local_4 = 0xffffffff;
  pcStack_8 = FUN_0055e9eb;
  *unaff_FS_OFFSET = &local_c;
  switch(param_1) {
  case 0x17a8:
  case 0x17a9:
  case 0x17aa:
  case 0x17b2:
    if (this->waitingToStart != 0) {
      TCommunications_Handler::UnlinkToLevel(comm,SERVICE_AVAILABLE);
      this->waitingToStart = 0;
      RGE_Base_Game::enable_input(rge_base_game);
                    /* language.dll match for 0x25a3: "Unable to join game." */
      TEasy_Panel::popupOKDialog((TEasy_Panel *)this,0x25a3,(char *)0x0,0x1c2,100);
      *unaff_FS_OFFSET = local_c;
      return 1;
    }
    break;
  case 0x17b8:
    if (this->waitingToStart != 0) {
      this_00 = (TribeMPSetupScreen *)operator_new(0x890);
      local_4 = 0;
      if (this_00 != (TribeMPSetupScreen *)0x0) {
        TribeMPSetupScreen::TribeMPSetupScreen(this_00);
      }
      local_4 = 0xffffffff;
      TPanelSystem::setCurrentPanel(&panel_system,s_MP_Setup_Screen,0);
      TPanelSystem::destroyPanel(&panel_system,s_Join_Screen);
      *unaff_FS_OFFSET = local_c;
      return 1;
    }
  }
  lVar1 = TPanel::handle_user_command((TPanel *)this,param_1,param_2);
  *unaff_FS_OFFSET = local_c;
  return lVar1;
}

// --------------------------------------------------

// Function: fillList
// Address: 00491c70
// [HELPER] s__s_____1d_____1d__: "%s ( %.1d / %.1d )"
/* protected: void __thiscall TribeJoinScreen::fillList(void) */

void __thiscall TribeJoinScreen::fillList(TribeJoinScreen *this)
{
  TCommunications_Sessions *this_00;
  int iVar1;
  ulong uVar2;
  ulong uVar3;
  char *pcVar4;
  undefined4 *unaff_FS_OFFSET;
  char szTemp [126];
  undefined4 uStack_10;
  undefined4 uStack_c;
  code *pcStack_8;
  undefined4 uStack_4;
  
  uStack_c = *unaff_FS_OFFSET;
  uStack_4 = 0xffffffff;
  pcStack_8 = FUN_0055ea0e;
  *unaff_FS_OFFSET = &uStack_c;
  RGE_Base_Game::disable_input(rge_base_game);
                    /* language.dll match for 0x25a9: "Looking for games..." */
  this->listFilled = 0;
  this->game_count = 0;
  (**(code **)(this->list->_padding_ + 0xe4))(0x25a9);
  RGE_Base_Game::draw_window(rge_base_game);
  if (this->startedSession == 0) {
    this_00 = (TCommunications_Sessions *)operator_new(0x457b0);
    pcStack_8 = (code *)0x0;
    if (this_00 == (TCommunications_Sessions *)0x0) {
      Sess = (TCommunications_Sessions *)0x0;
    }
    else {
      Sess = (TCommunications_Sessions *)
             TCommunications_Sessions::TCommunications_Sessions(this_00,comm);
    }
    pcStack_8 = (code *)0xffffffff;
    if (Sess == (TCommunications_Sessions *)0x0) {
                    /* language.dll match for 0x25ab: "Click Show Games to see a list of games.
                       Click Create to start a new game." */
      (**(code **)(this->list->_padding_ + 0xe4))(0x25ab);
      *unaff_FS_OFFSET = stack0xffffffec;
      return;
    }
    this->startedSession = 1;
  }
  else {
    TCommunications_Sessions::Refresh(Sess);
  }
  iVar1 = TCommunications_Sessions::GetSessionCount(Sess);
  this->game_count = iVar1;
  if (iVar1 < 1) {
                    /* language.dll match for 0x25ab: "Click Show Games to see a list of games.
                       Click Create to start a new game." */
    (**(code **)(this->list->_padding_ + 0xe4))(0x25ab);
  }
  else {
    TTextPanel::empty_list((TTextPanel *)this->list);
    iVar1 = 0;
    if (0 < this->game_count) {
      do {
        uVar2 = TCommunications_Sessions::GetSessionMaxPlayers(Sess,iVar1);
        uVar3 = TCommunications_Sessions::GetSessionCurrentPlayers(Sess,iVar1);
        pcVar4 = TCommunications_Sessions::GetSessionName(Sess,iVar1);
        sprintf(szTemp,s__s_____1d_____1d__,pcVar4,uVar3,uVar2);
        TTextPanel::append_line((TTextPanel *)this->list,szTemp,0);
        iVar1 = iVar1 + 1;
      } while (iVar1 < this->game_count);
    }
    TPanel::set_curr_child((TPanel *)this,(TPanel *)this->list);
  }
  this->listFilled = 1;
  *unaff_FS_OFFSET = uStack_10;
  return;
}

// --------------------------------------------------

// Function: action
// Address: 00491e20
// [HELPER] s_C__msdev_work_age1_x1_scr_cj_cpp: "C:\msdev\work\age1_x1\scr_cj.cpp"
// [HELPER] s_Join_Screen: "Join Screen"
// [HELPER] s_MP_Startup_Screen: "MP Startup Screen"
/* public: virtual long __thiscall TribeJoinScreen::action(class TPanel *,long,unsigned
   long,unsigned long) */

long __thiscall
TribeJoinScreen::action
          (TribeJoinScreen *this,TPanel *param_1,long param_2,ulong param_3,ulong param_4)
{
  long lVar1;
  int iVar2;
  _GUID *p_Var3;
  char *pcVar4;
  ulong uVar5;
  undefined4 *unaff_FS_OFFSET;
  char temp [256];
  char string [256];
  undefined4 local_c;
  code *pcStack_8;
  undefined4 local_4;
  
  local_c = *unaff_FS_OFFSET;
  local_4 = 0xffffffff;
  pcStack_8 = FUN_0055ea3c;
  *unaff_FS_OFFSET = &local_c;
  if (param_1 == (TPanel *)0x0) {
LAB_0049208e:
    lVar1 = TEasy_Panel::action((TEasy_Panel *)this,param_1,param_2,param_3,param_4);
  }
  else {
    if ((TListPanel *)param_1 == this->list) {
      if ((param_2 == 3) && (0 < this->game_count)) {
        (**(code **)(this->_padding_ + 0xb4))(this->joinButton,1,0,0);
        lVar1 = 1;
        goto LAB_004920a7;
      }
    }
    else if ((TButtonPanel *)param_1 == this->joinButton) {
      if (param_2 == 1) {
        if (this->game_count < 1) {
                    /* language.dll match for 0x25a4: "There are no games to join." */
          TEasy_Panel::popupOKDialog((TEasy_Panel *)this,0x25a4,(char *)0x0,0x1c2,100);
          lVar1 = 1;
        }
        else {
          iVar2 = TTextPanel::currentLineNumber((TTextPanel *)this->list);
          p_Var3 = TCommunications_Sessions::GetSessionGUID(Sess,iVar2);
          iVar2 = TCommunications_Handler::JoinMultiplayerGame(comm,p_Var3);
          if (iVar2 == 0) {
                    /* language.dll match for 0x25a3: "Unable to join game." */
            TPanel::get_string((TPanel *)this,0x25a3,temp + 4,0x100);
            pcVar4 = TTextPanel::currentLine((TTextPanel *)this->list);
            sprintf(string + 4,temp + 4,pcVar4);
            TEasy_Panel::popupOKDialog((TEasy_Panel *)this,string + 4,(char *)0x0,0x1c2,100);
            lVar1 = 1;
          }
          else {
            RGE_Base_Game::disable_input(rge_base_game);
            this->waitingToStart = 1;
            uVar5 = debug_timeGetTime(s_C__msdev_work_age1_x1_scr_cj_cpp,0x140);
            this->joinTime = uVar5;
            lVar1 = 1;
          }
        }
        goto LAB_004920a7;
      }
    }
    else if ((TButtonPanel *)param_1 == this->cancelButton) {
      if (param_2 == 1) {
        RGE_Base_Game::disable_input(rge_base_game);
        TCommunications_Handler::UnlinkToLevel(comm,SINGLE_PLAYER);
        temp._0_4_ = operator_new(0x6a0);
        local_4 = 0;
        if ((TribeMPStartupScreen *)temp._0_4_ != (TribeMPStartupScreen *)0x0) {
          TribeMPStartupScreen::TribeMPStartupScreen((TribeMPStartupScreen *)temp._0_4_);
        }
        local_4 = 0xffffffff;
        TPanelSystem::setCurrentPanel(&panel_system,s_MP_Startup_Screen,0);
        TPanelSystem::destroyPanel(&panel_system,s_Join_Screen);
        lVar1 = 1;
        goto LAB_004920a7;
      }
    }
    else if (((TButtonPanel *)param_1 == this->createButton) && (param_2 == 1)) {
      temp._0_4_ = operator_new(0x4a4);
      local_4 = 1;
      if ((TribeMPCreateDialog *)temp._0_4_ != (TribeMPCreateDialog *)0x0) {
        TribeMPCreateDialog::TribeMPCreateDialog((TribeMPCreateDialog *)temp._0_4_,(TPanel *)this);
        lVar1 = 1;
        goto LAB_004920a7;
      }
    }
    else if ((TButtonPanel *)param_1 == this->refreshButton) {
      if (param_2 == 1) {
        fillList(this);
        lVar1 = 1;
        goto LAB_004920a7;
      }
    }
    else {
      if (((TButtonPanel *)param_1 != this->close_button) || (param_2 != 1)) goto LAB_0049208e;
      RGE_Base_Game::close(rge_base_game);
    }
    lVar1 = 1;
  }
LAB_004920a7:
  *unaff_FS_OFFSET = local_c;
  return lVar1;
}

// --------------------------------------------------

