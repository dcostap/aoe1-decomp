// Class: TribeMPSetupScreen
// Size:  0x890
//
// VTable Layout:
// [00] `vector_deleting_destructor'
// [01] setup
// [02] set_rect
// [03] set_rect
// [04] set_color
// [05] set_active
// [06] set_positioning
// [07] set_fixed_position
// [08] set_redraw
// [09] set_overlapped_redraw
// [10] draw_setup
// [11] draw_finish
// [12] draw
// [13] draw_rect
// [14] draw_offset
// [15] draw_rect2
// [16] draw_offset2
// [17] paint
// [18] wnd_proc
// [19] handle_idle
// [20] handle_size
// [21] handle_paint
// [22] handle_key_down
// [23] handle_char
// [24] handle_command
// [25] handle_user_command
// [26] handle_timer_command
// [27] handle_scroll
// [28] handle_mouse_down
// [29] handle_mouse_move
// [30] handle_mouse_up
// [31] handle_mouse_dbl_click
// [32] mouse_move_action
// [33] mouse_left_down_action
// [34] mouse_left_hold_action
// [35] mouse_left_move_action
// [36] mouse_left_up_action
// [37] mouse_left_dbl_click_action
// [38] mouse_right_down_action
// [39] mouse_right_hold_action
// [40] mouse_right_move_action
// [41] mouse_right_up_action
// [42] mouse_right_dbl_click_action
// [43] key_down_action
// [44] char_action
// [45] action
// [46] get_true_render_rect
// [47] is_inside
// [48] set_focus
// [49] set_tab_order
// [50] set_tab_order
// [51] get_help_info
// [52] stop_sound_system
// [53] restart_sound_system
// [54] take_snapshot
// [55] handle_reactivate
// [56] draw_background
// [57] set_ideal_size
// [58] create_button
// [59] create_button
// [60] create_check_box
// [61] create_radio_button
// [62] create_text
// [63] create_text
// [64] create_text
// [65] create_input
// [66] create_edit
// [67] create_drop_down
// [68] create_list
// [69] create_scrollbar
// [70] create_auto_scrollbar
// [71] create_vert_slider
// [72] create_horz_slider
// [73] position_panel
// [74] `scalar_deleting_destructor'
// [75] setup
// [76] set_rect
// [77] set_rect
// [78] set_color
// [79] set_active
// [80] set_positioning
// [81] set_fixed_position
// [82] set_redraw
// [83] set_overlapped_redraw
// [84] draw_setup
// [85] draw_finish
// [86] draw
// [87] draw_rect
// [88] draw_offset
// [89] draw_rect2
// [90] draw_offset2
// [91] paint
// [92] wnd_proc
// [93] handle_idle
// [94] handle_size
// [95] handle_paint
// [96] handle_key_down
// [97] handle_char
// [98] handle_command
// [99] handle_user_command
// [100] handle_timer_command
// [101] handle_scroll
// [102] handle_mouse_down
// [103] handle_mouse_move
// [104] handle_mouse_up
// [105] handle_mouse_dbl_click
// [106] mouse_move_action
// [107] mouse_left_down_action
// [108] mouse_left_hold_action
// [109] mouse_left_move_action
// [110] mouse_left_up_action
// [111] mouse_left_dbl_click_action
// [112] mouse_right_down_action
// [113] mouse_right_hold_action
// [114] mouse_right_move_action
// [115] mouse_right_up_action
// [116] mouse_right_dbl_click_action
// [117] key_down_action
// [118] char_action
// [119] action
// [120] get_true_render_rect
// [121] is_inside
// [122] set_focus
// [123] set_tab_order
// [124] set_tab_order
// [125] get_help_info
// [126] stop_sound_system
// [127] restart_sound_system
// [128] take_snapshot
// [129] handle_reactivate
// [130] draw_background
// [131] set_ideal_size
// [132] create_button
// [133] create_button
// [134] create_check_box
// [135] create_radio_button
// [136] create_text
// [137] create_text
// [138] create_text
// [139] create_input
// [140] create_edit
// [141] create_drop_down
// [142] create_list
// [143] create_scrollbar
// [144] create_auto_scrollbar
// [145] create_vert_slider
// [146] create_horz_slider
// [147] position_panel
// [148] `vector_deleting_destructor'
// [149] setup
// [150] set_rect
// [151] set_rect
// [152] set_color
// [153] set_active
// [154] set_positioning
// [155] set_fixed_position
// [156] set_redraw
// [157] set_overlapped_redraw
// [158] draw_setup
// [159] draw_finish
// [160] draw
// [161] draw_rect
// [162] draw_offset
// [163] draw_rect2
// [164] draw_offset2
// [165] paint
// [166] wnd_proc
// [167] handle_idle
// [168] handle_size
// [169] handle_paint
// [170] handle_key_down
// [171] handle_char
// [172] handle_command
// [173] handle_user_command
// [174] handle_timer_command
// [175] handle_scroll
// [176] handle_mouse_down
// [177] handle_mouse_move
// [178] handle_mouse_up
// [179] handle_mouse_dbl_click
// [180] mouse_move_action
// [181] mouse_left_down_action
// [182] mouse_left_hold_action
// [183] mouse_left_move_action
// [184] mouse_left_up_action
// [185] mouse_left_dbl_click_action
// [186] mouse_right_down_action
// [187] mouse_right_hold_action
// [188] mouse_right_move_action
// [189] mouse_right_up_action
// [190] mouse_right_dbl_click_action
// [191] key_down_action
// [192] char_action
// [193] action
// [194] get_true_render_rect
// [195] is_inside
// [196] set_focus
// [197] set_tab_order
// [198] set_tab_order
// [199] get_help_info
// [200] stop_sound_system
// [201] restart_sound_system
// [202] take_snapshot
// [203] handle_reactivate
// [204] draw_background
// [205] set_ideal_size
// [206] create_button
// [207] create_button
// [208] create_check_box
// [209] create_radio_button
// [210] create_text
// [211] create_text
// [212] create_text
// [213] create_input
// [214] create_edit
// [215] create_drop_down
// [216] create_list
// [217] create_scrollbar
// [218] create_auto_scrollbar
// [219] create_vert_slider
// [220] create_horz_slider
// [221] position_panel
// [222] `vector_deleting_destructor'
// [223] setup
// [224] set_rect
// [225] set_rect
// [226] set_color
// [227] set_active
// [228] set_positioning
// [229] set_fixed_position
// [230] set_redraw
// [231] set_overlapped_redraw
// [232] draw_setup
// [233] draw_finish
// [234] draw
// [235] draw_rect
// [236] draw_offset
// [237] draw_rect2
// [238] draw_offset2
// [239] paint
// [240] wnd_proc
// [241] handle_idle
// [242] handle_size
// [243] handle_paint
// [244] handle_key_down
// [245] handle_char
// [246] handle_command
// [247] handle_user_command
// [248] handle_timer_command
// [249] handle_scroll
// [250] handle_mouse_down
// [251] handle_mouse_move
// [252] handle_mouse_up
// [253] handle_mouse_dbl_click
// [254] mouse_move_action
// [255] mouse_left_down_action
// [256] mouse_left_hold_action
// [257] mouse_left_move_action
// [258] mouse_left_up_action
// [259] mouse_left_dbl_click_action
// [260] mouse_right_down_action
// [261] mouse_right_hold_action
// [262] mouse_right_move_action
// [263] mouse_right_up_action
// [264] mouse_right_dbl_click_action
// [265] key_down_action
// [266] char_action
// [267] action
// [268] get_true_render_rect
// [269] is_inside
// [270] set_focus
// [271] set_tab_order
// [272] set_tab_order
// [273] get_help_info
// [274] stop_sound_system
// [275] restart_sound_system
// [276] take_snapshot
// [277] handle_reactivate
// [278] draw_background
// [279] set_ideal_size
// [280] create_button
// [281] create_button
// [282] create_check_box
// [283] create_radio_button
// [284] create_text
// [285] create_text
// [286] create_text
// [287] create_input
// [288] create_edit
// [289] create_drop_down
// [290] create_list
// [291] create_scrollbar
// [292] create_auto_scrollbar
// [293] create_vert_slider
// [294] create_horz_slider
// [295] position_panel
// [296] `scalar_deleting_destructor'
// [297] setup
// [298] set_rect
// [299] set_rect
// [300] set_color
// [301] set_active
// [302] set_positioning
// [303] set_fixed_position
// [304] set_redraw
// [305] set_overlapped_redraw
// [306] draw_setup
// [307] draw_finish
// [308] draw
// [309] draw_rect
// [310] draw_offset
// [311] draw_rect2
// [312] draw_offset2
// [313] paint
// [314] wnd_proc
// [315] handle_idle
// [316] handle_size
// [317] handle_paint
// [318] handle_key_down
// [319] handle_char
// [320] handle_command
// [321] handle_user_command
// [322] handle_timer_command
// [323] handle_scroll
// [324] handle_mouse_down
// [325] handle_mouse_move
// [326] handle_mouse_up
// [327] handle_mouse_dbl_click
// [328] mouse_move_action
// [329] mouse_left_down_action
// [330] mouse_left_hold_action
// [331] mouse_left_move_action
// [332] mouse_left_up_action
// [333] mouse_left_dbl_click_action
// [334] mouse_right_down_action
// [335] mouse_right_hold_action
// [336] mouse_right_move_action
// [337] mouse_right_up_action
// [338] mouse_right_dbl_click_action
// [339] key_down_action
// [340] char_action
// [341] action
// [342] get_true_render_rect
// [343] is_inside
// [344] set_focus
// [345] set_tab_order
// [346] set_tab_order
// [347] get_help_info
// [348] stop_sound_system
// [349] restart_sound_system
// [350] take_snapshot
// [351] handle_reactivate
// [352] draw_background
// [353] set_ideal_size
// [354] create_button
// [355] create_button
// [356] create_check_box
// [357] create_radio_button
// [358] create_text
// [359] create_text
// [360] create_text
// [361] create_input
// [362] create_edit
// [363] create_drop_down
// [364] create_list
// [365] create_scrollbar
// [366] create_auto_scrollbar
// [367] create_vert_slider
// [368] create_horz_slider
// [369] position_panel
// [370] setup
// [371] setup
// [372] `vector_deleting_destructor'
// [373] setup
// [374] set_rect
// [375] set_rect
// [376] set_color
// [377] set_active
// [378] set_positioning
// [379] set_fixed_position
// [380] set_redraw
// [381] set_overlapped_redraw
// [382] draw_setup
// [383] draw_finish
// [384] draw
// [385] draw_rect
// [386] draw_offset
// [387] draw_rect2
// [388] draw_offset2
// [389] paint
// [390] wnd_proc
// [391] handle_idle
// [392] handle_size
// [393] handle_paint
// [394] handle_key_down
// [395] handle_char
// [396] handle_command
// [397] handle_user_command
// [398] handle_timer_command
// [399] handle_scroll
// [400] handle_mouse_down
// [401] handle_mouse_move
// [402] handle_mouse_up
// [403] handle_mouse_dbl_click
// [404] mouse_move_action
// [405] mouse_left_down_action
// [406] mouse_left_hold_action
// [407] mouse_left_move_action
// [408] mouse_left_up_action
// [409] mouse_left_dbl_click_action
// [410] mouse_right_down_action
// [411] mouse_right_hold_action
// [412] mouse_right_move_action
// [413] mouse_right_up_action
// [414] mouse_right_dbl_click_action
// [415] key_down_action
// [416] char_action
// [417] action
// [418] get_true_render_rect
// [419] is_inside
// [420] set_focus
// [421] set_tab_order
// [422] set_tab_order
// [423] get_help_info
// [424] stop_sound_system
// [425] restart_sound_system
// [426] take_snapshot
// [427] handle_reactivate
// [428] draw_background
// [429] set_ideal_size
// [430] create_button
// [431] create_button
// [432] create_check_box
// [433] create_radio_button
// [434] create_text
// [435] create_text
// [436] create_text
// [437] create_input
// [438] create_edit
// [439] create_drop_down
// [440] create_list
// [441] create_scrollbar
// [442] create_auto_scrollbar
// [443] create_vert_slider
// [444] create_horz_slider
// [445] position_panel
// [446] `vector_deleting_destructor'
// [447] setup
// [448] set_rect
// [449] set_rect
// [450] set_color
// [451] set_active
// [452] set_positioning
// [453] set_fixed_position
// [454] set_redraw
// [455] set_overlapped_redraw
// [456] draw_setup
// [457] draw_finish
// [458] draw
// [459] draw_rect
// [460] draw_offset
// [461] draw_rect2
// [462] draw_offset2
// [463] paint
// [464] wnd_proc
// [465] handle_idle
// [466] handle_size
// [467] handle_paint
// [468] handle_key_down
// [469] handle_char
// [470] handle_command
// [471] handle_user_command
// [472] handle_timer_command
// [473] handle_scroll
// [474] handle_mouse_down
// [475] handle_mouse_move
// [476] handle_mouse_up
// [477] handle_mouse_dbl_click
// [478] mouse_move_action
// [479] mouse_left_down_action
// [480] mouse_left_hold_action
// [481] mouse_left_move_action
// [482] mouse_left_up_action
// [483] mouse_left_dbl_click_action
// [484] mouse_right_down_action
// [485] mouse_right_hold_action
// [486] mouse_right_move_action
// [487] mouse_right_up_action
// [488] mouse_right_dbl_click_action
// [489] key_down_action
// [490] char_action
// [491] action
// [492] get_true_render_rect
// [493] is_inside
// [494] set_focus
// [495] set_tab_order
// [496] set_tab_order
// [497] get_help_info
// [498] stop_sound_system
// [499] restart_sound_system
// [500] take_snapshot
// [501] handle_reactivate
// [502] draw_background
// [503] set_ideal_size
// [504] create_button
// [505] create_button
// [506] create_check_box
// [507] create_radio_button
// [508] create_text
// [509] create_text
// [510] create_text
// [511] create_input
// [512] create_edit
// [513] create_drop_down
// [514] create_list
// [515] create_scrollbar
// [516] create_auto_scrollbar
// [517] create_vert_slider
// [518] create_horz_slider
// [519] position_panel
//
// Member Layout:
// [0x478] TTextPanel * title
// [0x47C] TTextPanel * playerTitle
// [0x480] TTextPanel * civTitle
// [0x484] TTextPanel * settingsTitle
// [0x488] TTextPanel * colorTitle
// [0x48C] TTextPanel * teamTitle
// [0x490] TTextPanel *[8] playerNameText (sz: 0x20)
// [0x4B0] TTextPanel *[8] playerCivText (sz: 0x20)
// [0x4D0] TTextPanel *[8] scenarioPlayerText (sz: 0x20)
// [0x4F0] TTextPanel *[8] playerCDText (sz: 0x20)
// [0x510] TTextPanel *[8] playerVersionText (sz: 0x20)
// [0x530] TTextPanel *[8] playerColorText (sz: 0x20)
// [0x550] TTextPanel *[8] playerTeamText (sz: 0x20)
// [0x570] TButtonPanel *[8] playerColor (sz: 0x20)
// [0x590] TButtonPanel *[8] playerTeam (sz: 0x20)
// [0x5B0] TDropDownPanel *[8] playerNameDrop (sz: 0x20)
// [0x5D0] TDropDownPanel *[8] playerCivDrop (sz: 0x20)
// [0x5F0] TDropDownPanel *[8] scenarioPlayerDrop (sz: 0x20)
// [0x610] TEditPanel * chatInput
// [0x614] TTextPanel * chatTitle
// [0x618] TTextPanel * chatBox
// [0x61C] TScrollBarPanel * chatScrollbar
// [0x620] TButtonPanel * gameSettingsButton
// [0x624] TTextPanel * scenarioName
// [0x628] TTextPanel * victoryFixedText
// [0x62C] TTextPanel *[20] settingText (sz: 0x50)
// [0x67C] TTextPanel *[20] settingValue (sz: 0x50)
// [0x6CC] TTextPanel * mapSizeLabel
// [0x6D0] TDropDownPanel * mapSizeDrop
// [0x6D4] TTextPanel * mapTypeLabel
// [0x6D8] TDropDownPanel * mapTypeDrop
// [0x6DC] TTextPanel * numberPlayersTitle
// [0x6E0] TDropDownPanel * numberPlayersDrop
// [0x6E4] TTextPanel * numberPlayersText
// [0x6E8] TButtonPanel * hiddenMapButton
// [0x6EC] TTextPanel * hiddenMapText
// [0x6F0] TTextPanel * victoryTypeLabel
// [0x6F4] TDropDownPanel * victoryTypeDrop
// [0x6F8] TTextPanel * victoryAmountLabel
// [0x6FC] TEditPanel * victoryAmountInput
// [0x700] TButtonPanel * startButton
// [0x704] TButtonPanel *[2] readyButtons (sz: 0x8)
// [0x70C] TButtonPanel * cancelButton
// [0x710] TButtonPanel * help_button
// [0x714] TButtonPanel * ready_button
// [0x718] TButtonPanel * close_button
// [0x71C] TTextPanel * ready_button_label
// [0x720] int cancelMode
// [0x724] int playerToKick
// [0x728] int scenarioPlayerCount
// [0x72C] int myCivilization
// [0x730] int myScenarioPlayer
// [0x734] int myPlayerColor
// [0x738] int myPlayerTeam
// [0x73C] long myScenarioChecksum
// [0x740] char[256] saveScenarioName (sz: 0x100)
// [0x840] int saveRandomGame
// [0x844] long saveScenarioChecksum
// [0x848] T_Scenario * scenarioInfo
// [0x84C] int settingsFixed
// [0x850] int numberAnyPlayers
// [0x854] int sent_cd_status
// [0x858] TButtonPanel * netInfoButton
// [0x85C] int i_am_ready
// [0x860] uchar[8] defaultColor (sz: 0x8)
// [0x868] long[8] scenarioCheckSum (sz: 0x20)
// [0x888] ulong last_send_shared
// [0x88C] int resend_game_options
// ----------------------------------------------------------------

// Function: TribeMPSetupScreen
// Address: 004a00b0
// [HELPER] s_: ""
// [HELPER] s_MP_Setup_Screen: "MP Setup Screen"
// [HELPER] s_____CHAT_SCREEN__CONSTRUCTOR_BEG: "$$$ CHAT SCREEN: CONSTRUCTOR BEGIN"
// [HELPER] s_____CHAT_SCREEN__CONSTRUCTOR_DON: "$$$ CHAT SCREEN: CONSTRUCTOR DONE"
// [HELPER] s_____CHAT_SCREEN__UPDATE_SUMMARY: "$$$ CHAT SCREEN: UPDATE SUMMARY"
// [HELPER] s__d: "%d"
// [HELPER] s_scr2: "scr2"
// [HELPER] s_scr3: "scr3"
/* public: __thiscall TribeMPSetupScreen::TribeMPSetupScreen(void) */

TribeMPSetupScreen * __thiscall TribeMPSetupScreen::TribeMPSetupScreen(TribeMPSetupScreen *this)
{
  TDropDownPanel **ppTVar1;
  TButtonPanel **ppTVar2;
  TDrawArea *pTVar3;
  TButtonPanel *pTVar4;
  TDebuggingLog *this_00;
  TDebuggingLog *this_01;
  char *pcVar5;
  TTextPanel **ppTVar6;
  int iVar7;
  TDropDownPanel **ppTVar8;
  undefined4 *unaff_FS_OFFSET;
  int iVar9;
  long lVar10;
  long lVar11;
  long lVar12;
  long lVar13;
  short sVar14;
  long lVar15;
  int iVar16;
  int iVar17;
  int local_118;
  char str [256];
  undefined4 local_c;
  code *pcStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  pcStack_8 = FUN_0055f19b;
  local_c = *unaff_FS_OFFSET;
  *unaff_FS_OFFSET = &local_c;
  str._0_4_ = this;
  TScreenPanel::TScreenPanel((TScreenPanel *)this,s_MP_Setup_Screen);
  this->_padding_ = (int)&_vftable_;
  local_4 = 0;
  TDebuggingLog::Log(this_00,(char *)L,s_____CHAT_SCREEN__CONSTRUCTOR_BEG);
  init_vars(this);
  TChat::ClearChat(chat);
  iVar7 = 1;
  do {
    TChat::setInChatGroup(chat,iVar7,1);
    iVar7 = iVar7 + 1;
  } while (iVar7 < 9);
  iVar7 = RGE_Base_Game::multiplayerGame(rge_base_game);
  pcVar5 = &s_scr3;
  if (iVar7 == 0) {
    pcVar5 = &s_scr2;
  }
  iVar16 = 1;
  lVar15 = 0;
  lVar13 = 0;
  pTVar3 = rge_base_game->draw_area;
  lVar11 = 0;
  lVar10 = 0;
  iVar9 = 1;
  iVar7 = RGE_Base_Game::multiplayerGame(rge_base_game);
  lVar10 = TEasy_Panel::setup((TEasy_Panel *)this,pTVar3,(TPanel *)0x0,pcVar5,(iVar7 != 0) + 0xc384,
                              iVar9,lVar10,lVar11,lVar13,lVar15,iVar16);
  if (lVar10 == 0) {
    this->_padding_ = 1;
    goto LAB_004a0d3d;
  }
  TEasy_Panel::setup_shadow_area((TEasy_Panel *)this,0);
  TEasy_Panel::set_ideal_size((TEasy_Panel *)this,0x280,0x1e0);
  iVar17 = 0;
  iVar16 = 0;
  iVar9 = 1;
  lVar12 = 1;
  lVar15 = 0x1e;
  lVar13 = 600;
  lVar11 = 6;
  lVar10 = 0x14;
  iVar7 = RGE_Base_Game::multiplayerGame(rge_base_game);
  iVar7 = TEasy_Panel::create_text
                    ((TEasy_Panel *)this,(TPanel *)this,&this->title,0x25cf - (uint)(iVar7 != 0),
                     lVar10,lVar11,lVar13,lVar15,lVar12,iVar9,iVar16,iVar17);
                    /* language.dll match for 0x25d0: "Name" */
                    /* language.dll match for 0x25d1: "Civ" */
                    /* language.dll match for 0x25d2: "Settings" */
  if ((((iVar7 == 0) ||
       (iVar7 = TEasy_Panel::create_text
                          ((TEasy_Panel *)this,(TPanel *)this,&this->playerTitle,0x25d0,0x1a,0x32,
                           0xa0,0x1e,0,0,1,0), iVar7 == 0)) ||
      (iVar7 = TEasy_Panel::create_text
                         ((TEasy_Panel *)this,(TPanel *)this,&this->civTitle,0x25d1,0xbd,0x32,0xa0,
                          0x1e,0,0,1,0), iVar7 == 0)) ||
     (((iVar7 = RGE_Base_Game::singlePlayerGame(rge_base_game), iVar7 == 0 &&
       (iVar7 = TCommunications_Handler::IsHost(comm), iVar7 == 0)) &&
      (iVar7 = TEasy_Panel::create_text
                         ((TEasy_Panel *)this,(TPanel *)this,&this->settingsTitle,0x25d2,0x1a4,0x32,
                          0xd2,0x1e,0,0,1,0), iVar7 == 0)))) goto LAB_004a0d3d;
                    /* language.dll match for 0x25ae: "Player" */
  iVar7 = TEasy_Panel::create_text
                    ((TEasy_Panel *)this,(TPanel *)this,&this->colorTitle,0x25ae,0xf0,0x32,100,0x1e,
                     0,0,1,0);
  if (iVar7 == 0) goto LAB_004a0d3d;
  TTextPanel::set_alignment(this->colorTitle,AlignCenter,AlignRight);
                    /* language.dll match for 0x25af: "Team" */
  iVar7 = TEasy_Panel::create_text
                    ((TEasy_Panel *)this,(TPanel *)this,&this->teamTitle,0x25af,0x136,0x32,100,0x1e,
                     0,0,1,0);
  if (iVar7 == 0) goto LAB_004a0d3d;
  TTextPanel::set_alignment(this->teamTitle,AlignCenter,AlignRight);
  local_118 = 0x55;
  ppTVar8 = this->playerCivDrop;
  do {
    iVar7 = local_118 + -1;
    ppTVar1 = ppTVar8 + -8;
    iVar9 = TEasy_Panel::create_drop_down
                      ((TEasy_Panel *)this,(TPanel *)this,ppTVar1,0x9e,100,7,iVar7,0x9e,0x18,0xb);
    if (iVar9 == 0) goto LAB_004a0d3d;
    TDropDownPanel::set_draw_style(*ppTVar1,DrawStyleLeftButton);
    TDropDownPanel::set_draw_val_rect(*ppTVar1,0);
                    /* language.dll match for 0x75f9: "To limit a game to less than 8 players, close
                       some of the positions. Closing a position occupied by a player ejects the
                       player from the game." */
    TPanel::set_help_info((TPanel *)*ppTVar1,0x75f9,-1);
    TDropDownPanel::empty_list(*ppTVar1);
    iVar9 = RGE_Base_Game::multiplayerGame(rge_base_game);
                    /* language.dll match for 0x25d3: "Computer" */
    if (iVar9 == 0) {
      TDropDownPanel::append_line(*ppTVar1,0x25d3,4);
                    /* language.dll match for 0x25d6: "None" */
      lVar10 = 0x25d6;
    }
    else {
      TDropDownPanel::append_line(*ppTVar1,0x25d3,4);
                    /* language.dll match for 0x25d4: "Closed" */
      TDropDownPanel::append_line(*ppTVar1,0x25d4,1);
                    /* language.dll match for 0x25d5: "Open" */
      lVar10 = 0x25d5;
    }
    TDropDownPanel::append_line(*ppTVar1,lVar10,0);
                    /* language.dll match for 0x80: "Arial" */
    iVar9 = TEasy_Panel::create_drop_down
                      ((TEasy_Panel *)this,(TPanel *)this,ppTVar8,0x80,100,0xaa,iVar7,0x80,0x18,0xb)
    ;
    if (iVar9 == 0) goto LAB_004a0d3d;
    TDropDownPanel::set_draw_style(*ppTVar8,DrawStyleLeftButton);
    TDropDownPanel::set_draw_val_rect(*ppTVar8,0);
                    /* language.dll match for 0x75fa: "Click to select a civilization. If you choose
                       Random, you don't know which civilization you're playing until the game
                       starts. Each civilization has special skills and can research different
                       technology. For more information, see the Civilization Attributes table and
                       technology trees in the manual appendix. More than one player can select the
                       same civilization."
                       language.dll match for 0x75fa: "Click to select a civilization. Each
                       civilization has special skills and can research different technology. For
                       more information, click More Help. More than one player can select the same
                       civilization." */
    TPanel::set_help_info((TPanel *)*ppTVar8,0x75fa,0x25f09);
    TDropDownPanel::empty_list(*ppTVar8);
                    /* language.dll match for 0x27f7: "Egyptian" */
    TDropDownPanel::append_line(*ppTVar8,0x27f7,1);
                    /* language.dll match for 0x27f8: "Greek" */
    TDropDownPanel::append_line(*ppTVar8,0x27f8,2);
                    /* language.dll match for 0x27f9: "Babylonian" */
    TDropDownPanel::append_line(*ppTVar8,0x27f9,3);
                    /* language.dll match for 0x27fa: "Assyrian" */
    TDropDownPanel::append_line(*ppTVar8,0x27fa,4);
                    /* language.dll match for 0x27fb: "Minoan" */
    TDropDownPanel::append_line(*ppTVar8,0x27fb,5);
                    /* language.dll match for 0x27fc: "Hittite" */
    TDropDownPanel::append_line(*ppTVar8,0x27fc,6);
                    /* language.dll match for 0x27fd: "Phoenician" */
    TDropDownPanel::append_line(*ppTVar8,0x27fd,7);
                    /* language.dll match for 0x27fe: "Sumerian" */
    TDropDownPanel::append_line(*ppTVar8,0x27fe,8);
                    /* language.dll match for 0x27ff: "Persian" */
    TDropDownPanel::append_line(*ppTVar8,0x27ff,9);
                    /* language.dll match for 0x2800: "Shang" */
    TDropDownPanel::append_line(*ppTVar8,0x2800,10);
                    /* language.dll match for 0x2801: "Yamato" */
    TDropDownPanel::append_line(*ppTVar8,0x2801,0xb);
                    /* language.dll match for 0x2802: "Choson" */
    TDropDownPanel::append_line(*ppTVar8,0x2802,0xc);
                    /* language.dll match for 0x2806: "Roman" */
    TDropDownPanel::append_line(*ppTVar8,0x2806,0xd);
                    /* language.dll match for 0x2807: "Carthaginian" */
    TDropDownPanel::append_line(*ppTVar8,0x2807,0xe);
                    /* language.dll match for 0x2809: "Palmyran" */
    TDropDownPanel::append_line(*ppTVar8,0x2809,0xf);
                    /* language.dll match for 0x2808: "Macedonian" */
    TDropDownPanel::append_line(*ppTVar8,0x2808,0x10);
                    /* language.dll match for 0x280a: "Random" */
    TDropDownPanel::append_line(*ppTVar8,0x280a,0x11);
    ppTVar1 = ppTVar8 + 8;
    iVar7 = TEasy_Panel::create_drop_down
                      ((TEasy_Panel *)this,(TPanel *)this,ppTVar1,0x28,100,0x144,iVar7,0x28,0x18,0xb
                      );
    if (iVar7 == 0) goto LAB_004a0d3d;
    TDropDownPanel::set_draw_style(*ppTVar1,DrawStyleLeftButton);
    TDropDownPanel::set_draw_val_rect(*ppTVar1,0);
    TPanel::set_help_info((TPanel *)*ppTVar1,0x75fb,-1);
    iVar7 = TEasy_Panel::create_button
                      ((TEasy_Panel *)this,(TPanel *)this,(TButtonPanel **)(ppTVar8 + -0x18),s_,
                       (char *)0x0,0x136,local_118,0x1e,0x14,0xb,0,1);
    if (iVar7 == 0) goto LAB_004a0d3d;
                    /* language.dll match for 0x7604: "Click to select your starting position on the
                       map and civilization color. In a multiplayer game, two or more players can
                       select the same player number and play a cooperative game, in which they
                       share control of the same civilization." */
    TPanel::set_help_info((TPanel *)ppTVar8[-0x18],0x7604,-1);
    iVar7 = TEasy_Panel::create_text
                      ((TEasy_Panel *)this,(TPanel *)this,(TTextPanel **)(ppTVar8 + -0x28),s_,0x131,
                       local_118,0x28,0x16,0xb,1,1,0);
    if (iVar7 == 0) goto LAB_004a0d3d;
    ppTVar2 = (TButtonPanel **)(ppTVar8 + -0x10);
                    /* language.dll match for 0x25b0: "-" */
    iVar7 = TEasy_Panel::create_button
                      ((TEasy_Panel *)this,(TPanel *)this,ppTVar2,0x25b0,0,0x17c,local_118,0x1e,0x14
                       ,0xb,0,1);
    if (iVar7 == 0) goto LAB_004a0d3d;
                    /* language.dll match for 0x7603: "Click to select a team if you want to start
                       the game with other players as allies. A dash (-) indicates no team. Players
                       on the same team automatically have their diplomatic stance set to Ally and
                       Allied Victory set." */
    TPanel::set_help_info((TPanel *)*ppTVar2,0x7603,-1);
    TButtonPanel::set_state_info(*ppTVar2,5);
    iVar7 = 1;
    do {
      sprintf(str + 4,&s__d,iVar7);
      sVar14 = (short)iVar7;
      TButtonPanel::set_text(*ppTVar2,sVar14,str + 4);
      iVar7 = iVar7 + 1;
      TButtonPanel::set_id(*ppTVar2,sVar14,iVar7,0);
    } while (iVar7 < 5);
    iVar7 = TEasy_Panel::create_text
                      ((TEasy_Panel *)this,(TPanel *)this,(TTextPanel **)(ppTVar8 + -0x20),s_,0x177,
                       local_118,0x28,0x16,0xb,1,1,0);
    if (iVar7 == 0) goto LAB_004a0d3d;
    iVar7 = local_118 + 2;
    iVar9 = TEasy_Panel::create_text
                      ((TEasy_Panel *)this,(TPanel *)this,(TTextPanel **)(ppTVar8 + -0x50),s_,0x1c,
                       iVar7,0x8b,0x16,0xb,0,0,0);
    if (((iVar9 == 0) ||
        (iVar9 = TEasy_Panel::create_text
                           ((TEasy_Panel *)this,(TPanel *)this,(TTextPanel **)(ppTVar8 + -0x48),s_,
                            0xbf,iVar7,0x6d,0x16,0xb,0,0,0), iVar9 == 0)) ||
       (iVar7 = TEasy_Panel::create_text
                          ((TEasy_Panel *)this,(TPanel *)this,(TTextPanel **)(ppTVar8 + -0x40),s_,
                           0x159,iVar7,0x28,0x16,0xb,0,0,0), iVar7 == 0)) goto LAB_004a0d3d;
                    /* language.dll match for 0x25df: "CD" */
    iVar7 = TEasy_Panel::create_text
                      ((TEasy_Panel *)this,(TPanel *)this,(TTextPanel **)(ppTVar8 + -0x38),0x25df,
                       0x151,local_118 + 3,0x14,0x16,6,0,0,0);
    if ((iVar7 == 0) ||
       (iVar7 = TEasy_Panel::create_text
                          ((TEasy_Panel *)this,(TPanel *)this,(TTextPanel **)(ppTVar8 + -0x30),s_,
                           0x161,local_118 + 3,0x1d,0x16,6,0,0,0), iVar7 == 0)) goto LAB_004a0d3d;
    (**(code **)(((TTextPanel *)ppTVar8[-0x38])->_padding_ + 0x14))(0);
    ppTVar8 = ppTVar8 + 1;
    local_118 = local_118 + 0x18;
  } while (local_118 < 0x115);
  iVar7 = RGE_Base_Game::singlePlayerGame(rge_base_game);
  if ((iVar7 != 0) || (iVar7 = TCommunications_Handler::IsHost(comm), iVar7 != 0)) {
                    /* language.dll match for 0x25d2: "Settings" */
    iVar7 = TEasy_Panel::create_button
                      ((TEasy_Panel *)this,(TPanel *)this,&this->gameSettingsButton,0x25d2,0,0x1a4,
                       0x32,0xd2,0x1e,0,0,0);
    if (iVar7 == 0) goto LAB_004a0d3d;
                    /* language.dll match for 0x75fc: "Click to change the scenario settings." */
    TPanel::set_help_info((TPanel *)this->gameSettingsButton,0x75fc,-1);
  }
  iVar7 = TEasy_Panel::create_text
                    ((TEasy_Panel *)this,(TPanel *)this,&this->scenarioName,s_,0x1a4,0x54,0xdc,0x44,
                     0xb,0,0,1);
  if (iVar7 == 0) goto LAB_004a0d3d;
  iVar7 = 0x53;
  ppTVar6 = this->settingText;
  do {
    iVar9 = TEasy_Panel::create_text
                      ((TEasy_Panel *)this,(TPanel *)this,ppTVar6,s_,0x1a4,iVar7,0xdc,0x14,0xb,0,0,0
                      );
    if (iVar9 == 0) goto LAB_004a0d3d;
    iVar7 = iVar7 + 0x18;
    ppTVar6 = ppTVar6 + 1;
  } while (iVar7 < 0x233);
  iVar7 = RGE_Base_Game::multiplayerGame(rge_base_game);
  if (iVar7 != 0) {
                    /* language.dll match for 0x25d7: "Chat" */
    iVar7 = TEasy_Panel::create_text
                      ((TEasy_Panel *)this,(TPanel *)this,&this->chatTitle,0x25d7,10,0x118,100,0x14,
                       4,0,1,0);
    if (iVar7 == 0) goto LAB_004a0d3d;
    ppTVar6 = &this->chatBox;
    iVar7 = TEasy_Panel::create_text
                      ((TEasy_Panel *)this,(TPanel *)this,ppTVar6,s_,10,300,400,0x60,10,0,0,0);
    if ((iVar7 == 0) ||
       (iVar7 = TEasy_Panel::create_auto_scrollbar
                          ((TEasy_Panel *)this,&this->chatScrollbar,*ppTVar6,0x14), iVar7 == 0))
    goto LAB_004a0d3d;
    iVar7 = TEasy_Panel::create_edit
                      ((TEasy_Panel *)this,(TPanel *)this,&this->chatInput,s_,0xf7,FormatText,10,
                       0x192,400,0x17,10,1,0);
    if (iVar7 == 0) goto LAB_004a0d3d;
                    /* language.dll match for 0x75fe: "Type a message." */
    TPanel::set_help_info((TPanel *)this->chatInput,0x75fe,-1);
    (**(code **)((*ppTVar6)->_padding_ + 0xec))
              (3,(char)this->_padding_,*(undefined1 *)((int)&this->_padding_ + 1),
               *(undefined1 *)((int)&this->_padding_ + 2),*(undefined1 *)((int)&this->_padding_ + 3)
               ,(char)this->_padding_,*(undefined1 *)((int)&this->_padding_ + 1));
                    /* language.dll match for 0x75fd: "Displays chat messages." */
    TPanel::set_help_info((TPanel *)*ppTVar6,0x75fd,-1);
    TTextPanel::empty_list(*ppTVar6);
  }
  iVar7 = RGE_Base_Game::singlePlayerGame(rge_base_game);
  if (iVar7 != 0) {
                    /* language.dll match for 0x25d8: "Number of Players" */
    iVar7 = TEasy_Panel::create_text
                      ((TEasy_Panel *)this,(TPanel *)this,&this->numberPlayersTitle,0x25d8,0x1a,
                       0x127,0x14f,0x14,0,0,1,0);
    if (iVar7 == 0) goto LAB_004a0d3d;
    iVar7 = TEasy_Panel::create_drop_down
                      ((TEasy_Panel *)this,(TPanel *)this,&this->numberPlayersDrop,0x46,100,0x1f,
                       0x142,0x46,0x18,0xb);
    if (iVar7 == 0) goto LAB_004a0d3d;
                    /* language.dll match for 0x7600: "Select the number of players." */
    TPanel::set_help_info((TPanel *)this->numberPlayersDrop,0x7600,-1);
  }
  this->i_am_ready = 0;
  iVar7 = RGE_Base_Game::singlePlayerGame(rge_base_game);
  if (iVar7 == 0) {
    iVar7 = TCommunications_Handler::IsHost(comm);
    ppTVar2 = &this->ready_button;
    if (iVar7 == 0) {
      iVar7 = TEasy_Panel::create_check_box
                        ((TEasy_Panel *)this,(TPanel *)this,ppTVar2,100,0x1b8,0x1e,0x1e,0,0);
                    /* language.dll match for 0x25bf: "I'm Ready!" */
      if ((iVar7 == 0) ||
         (iVar7 = TEasy_Panel::create_text
                            ((TEasy_Panel *)this,(TPanel *)this,&this->ready_button_label,0x25bf,
                             0x87,0x1b8,0x96,0x1e,0,0,1,0), iVar7 == 0)) goto LAB_004a0d3d;
                    /* language.dll match for 0x7602: "Click to indicate that you are ready to start
                       the game. The game creator cannot start the game until all players are ready.
                       The names of players who are ready are shown in green." */
      TPanel::set_help_info((TPanel *)*ppTVar2,0x7602,-1);
                    /* language.dll match for 0xfa2: "Cancel" */
      iVar7 = TEasy_Panel::create_button
                        ((TEasy_Panel *)this,(TPanel *)this,&this->cancelButton,0xfa2,0,0x14a,0x1b8,
                         0xf0,0x1e,0,0,0);
      goto joined_r0x004a0c4b;
    }
    iVar7 = TEasy_Panel::create_check_box
                      ((TEasy_Panel *)this,(TPanel *)this,ppTVar2,10,0x1b8,0x1e,0x1e,0,0);
                    /* language.dll match for 0x25bf: "I'm Ready!" */
    if ((iVar7 == 0) ||
       (iVar7 = TEasy_Panel::create_text
                          ((TEasy_Panel *)this,(TPanel *)this,&this->ready_button_label,0x25bf,0x2d,
                           0x1b8,0x96,0x1e,0,0,1,0), iVar7 == 0)) goto LAB_004a0d3d;
                    /* language.dll match for 0x7602: "Click to indicate that you are ready to start
                       the game. The game creator cannot start the game until all players are ready.
                       The names of players who are ready are shown in green." */
    TPanel::set_help_info((TPanel *)*ppTVar2,0x7602,-1);
    ppTVar2 = &this->startButton;
    iVar7 = TEasy_Panel::create_button
                      ((TEasy_Panel *)this,(TPanel *)this,ppTVar2,s_,(char *)0x0,0xc3,0x1b8,200,0x1e
                       ,0,0,0);
    if (iVar7 == 0) goto LAB_004a0d3d;
                    /* language.dll match for 0x25ee: "Start Game" */
    TButtonPanel::set_text(*ppTVar2,0,0x25ee);
    TPanel::set_help_info((TPanel *)*ppTVar2,0x75ff,-1);
    TButtonPanel::set_disabled(*ppTVar2,1);
                    /* language.dll match for 0xfa2: "Cancel" */
    iVar7 = TEasy_Panel::create_button
                      ((TEasy_Panel *)this,(TPanel *)this,&this->cancelButton,0xfa2,0,0x195,0x1b8,
                       0xb4,0x1e,0,0,0);
    if (iVar7 == 0) goto LAB_004a0d3d;
    TPanel::set_help_info((TPanel *)this->cancelButton,0x7532,-1);
                    /* language.dll match for 0x25ef: "IP" */
    iVar7 = TEasy_Panel::create_button
                      ((TEasy_Panel *)this,(TPanel *)this,&this->netInfoButton,0x25ef,0,600,400,0x1e
                       ,0x1e,0,0,0);
    if (iVar7 == 0) goto LAB_004a0d3d;
                    /* language.dll match for 0x7601: "Click to display your network address. You
                       can give your IP address to other players so they can join your game." */
    TPanel::set_help_info((TPanel *)this->netInfoButton,0x7601,-1);
    TCommunications_Handler::SetMyReadiness(comm,0,0,0,0,0,0,0,0);
  }
  else {
    ppTVar2 = &this->startButton;
    iVar7 = TEasy_Panel::create_button
                      ((TEasy_Panel *)this,(TPanel *)this,ppTVar2,s_,(char *)0x0,0x46,0x1b8,0xf0,
                       0x1e,0,0,0);
    if (iVar7 == 0) goto LAB_004a0d3d;
                    /* language.dll match for 0x25ee: "Start Game" */
    TButtonPanel::set_text(*ppTVar2,0,0x25ee);
    TPanel::set_help_info((TPanel *)*ppTVar2,0x75ff,-1);
    TPanel::set_curr_child((TPanel *)this,(TPanel *)*ppTVar2);
                    /* language.dll match for 0xfa2: "Cancel" */
    iVar7 = TEasy_Panel::create_button
                      ((TEasy_Panel *)this,(TPanel *)this,&this->cancelButton,0xfa2,0,0x14a,0x1b8,
                       0xf0,0x1e,0,0,0);
joined_r0x004a0c4b:
    if (iVar7 == 0) goto LAB_004a0d3d;
    TPanel::set_help_info((TPanel *)this->cancelButton,0x7532,-1);
  }
                    /* language.dll match for 0xfa9: "?" */
  iVar7 = TEasy_Panel::create_button
                    ((TEasy_Panel *)this,(TPanel *)this,&this->help_button,0xfa9,0,600,0x1b8,0x1e,
                     0x1e,0,0,0);
  if (iVar7 != 0) {
    ppTVar2 = &this->close_button;
                    /* language.dll match for 0x3ea: "X" */
    iVar7 = TEasy_Panel::create_button
                      ((TEasy_Panel *)this,(TPanel *)this,ppTVar2,0x3ea,0,0,0,0,0,-1,-1,0);
    if (iVar7 != 0) {
      (**(code **)((*ppTVar2)->_padding_ + 0x14))(1);
      (**(code **)((*ppTVar2)->_padding_ + 0x18))(9,4,4,4,4,0x11,0x11,0x11,0x11,0,0,0,0);
      pTVar4 = this->cancelButton;
      pTVar4->hotkey = 0x1b;
      pTVar4->hotkey_shift = 0;
      setupTabOrder(this);
      TDebuggingLog::Log(this_01,(char *)L,s_____CHAT_SCREEN__UPDATE_SUMMARY);
      updateSummary(this);
      iVar7 = RGE_Base_Game::singlePlayerGame(rge_base_game);
      if (iVar7 != 0) {
        setupSinglePlayerPlayers(this);
        fillPlayers(this);
      }
      TDebuggingLog::Log(L,(char *)L,s_____CHAT_SCREEN__CONSTRUCTOR_DON);
    }
  }
LAB_004a0d3d:
  *unaff_FS_OFFSET = local_c;
  return this;
}

// --------------------------------------------------

// Function: `vector_deleting_destructor'
// Address: 004a0d60
/* public: virtual void * __thiscall TribeMPSetupScreen::`vector deleting destructor'(unsigned int)
    */

void * __thiscall
TribeMPSetupScreen::_vector_deleting_destructor_(TribeMPSetupScreen *this,uint param_1)
{
  ~TribeMPSetupScreen(this);
  if ((param_1 & 1) != 0) {
    operator_delete(this);
  }
  return this;
}

// --------------------------------------------------

// Function: init_vars
// Address: 004a0d80
// [HELPER] s_: ""
// [HELPER] s_C__msdev_work_age1_x1_scr_mps_cp: "C:\msdev\work\age1_x1\scr_mps.cpp"
/* protected: void __thiscall TribeMPSetupScreen::init_vars(void) */

void __thiscall TribeMPSetupScreen::init_vars(TribeMPSetupScreen *this)
{
  TDropDownPanel **ppTVar1;
  TTextPanel **ppTVar2;
  ulong uVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  MapType MVar7;
  long *plVar8;
  
  this->title = (TTextPanel *)0x0;
  this->playerTitle = (TTextPanel *)0x0;
  this->civTitle = (TTextPanel *)0x0;
  this->settingsTitle = (TTextPanel *)0x0;
  this->colorTitle = (TTextPanel *)0x0;
  this->teamTitle = (TTextPanel *)0x0;
  ppTVar1 = this->playerCivDrop;
  iVar5 = 8;
  do {
    ppTVar1[-8] = (TDropDownPanel *)0x0;
    *ppTVar1 = (TDropDownPanel *)0x0;
    ppTVar1[8] = (TDropDownPanel *)0x0;
    ppTVar1[-0x18] = (TDropDownPanel *)0x0;
    ppTVar1[-0x10] = (TDropDownPanel *)0x0;
    ppTVar1[-0x50] = (TDropDownPanel *)0x0;
    ppTVar1[-0x48] = (TDropDownPanel *)0x0;
    ppTVar1[-0x40] = (TDropDownPanel *)0x0;
    ppTVar1[-0x38] = (TDropDownPanel *)0x0;
    ppTVar1[-0x30] = (TDropDownPanel *)0x0;
    ppTVar1[-0x28] = (TDropDownPanel *)0x0;
    ppTVar1[-0x20] = (TDropDownPanel *)0x0;
    ppTVar1 = ppTVar1 + 1;
    iVar5 = iVar5 + -1;
  } while (iVar5 != 0);
  this->chatInput = (TEditPanel *)0x0;
  this->chatTitle = (TTextPanel *)0x0;
  this->chatScrollbar = (TScrollBarPanel *)0x0;
  this->chatBox = (TTextPanel *)0x0;
  this->gameSettingsButton = (TButtonPanel *)0x0;
  this->scenarioName = (TTextPanel *)0x0;
  this->victoryFixedText = (TTextPanel *)0x0;
  ppTVar2 = this->settingValue;
  iVar5 = 0x14;
  do {
    ppTVar2[-0x14] = (TTextPanel *)0x0;
    *ppTVar2 = (TTextPanel *)0x0;
    ppTVar2 = ppTVar2 + 1;
    iVar5 = iVar5 + -1;
  } while (iVar5 != 0);
  this->mapSizeLabel = (TTextPanel *)0x0;
  this->mapSizeDrop = (TDropDownPanel *)0x0;
  this->mapTypeLabel = (TTextPanel *)0x0;
  this->mapTypeDrop = (TDropDownPanel *)0x0;
  this->numberPlayersTitle = (TTextPanel *)0x0;
  this->numberPlayersDrop = (TDropDownPanel *)0x0;
  this->numberPlayersText = (TTextPanel *)0x0;
  this->hiddenMapButton = (TButtonPanel *)0x0;
  this->hiddenMapText = (TTextPanel *)0x0;
  this->victoryTypeLabel = (TTextPanel *)0x0;
  this->victoryTypeDrop = (TDropDownPanel *)0x0;
  this->victoryAmountLabel = (TTextPanel *)0x0;
  this->victoryAmountInput = (TEditPanel *)0x0;
  this->ready_button_label = (TTextPanel *)0x0;
  this->startButton = (TButtonPanel *)0x0;
  this->readyButtons[0] = (TButtonPanel *)0x0;
  this->readyButtons[1] = (TButtonPanel *)0x0;
  this->cancelButton = (TButtonPanel *)0x0;
  this->help_button = (TButtonPanel *)0x0;
  this->ready_button = (TButtonPanel *)0x0;
  this->close_button = (TButtonPanel *)0x0;
  this->cancelMode = 0;
  this->playerToKick = 0;
  this->myCivilization = 0;
  this->myScenarioPlayer = -1;
  this->myPlayerColor = 0;
  this->myPlayerTeam = 0;
  this->myScenarioChecksum = 0;
  this->saveScenarioName[0] = '\0';
  iVar5 = RGE_Base_Game::randomGame(rge_base_game);
  this->saveRandomGame = iVar5;
  this->saveScenarioChecksum = 0;
  this->scenarioInfo = (T_Scenario *)0x0;
  this->numberAnyPlayers = 8;
  this->scenarioPlayerCount = 8;
  this->settingsFixed = 0;
  this->sent_cd_status = 0;
  this->netInfoButton = (TButtonPanel *)0x0;
  this->i_am_ready = 0;
  plVar8 = this->scenarioCheckSum;
  for (iVar5 = 8; iVar5 != 0; iVar5 = iVar5 + -1) {
    *plVar8 = 0;
    plVar8 = plVar8 + 1;
  }
  this->last_send_shared = 0;
  this->resend_game_options = 0;
  iVar5 = RGE_Base_Game::multiplayerGame(rge_base_game);
  if (iVar5 == 0) {
    iVar5 = RGE_Base_Game::scenarioGame(rge_base_game);
    if (iVar5 == 0) {
      TRIBE_Game::setMapSize((TRIBE_Game *)rge_base_game,Large);
      iVar5 = debug_rand(s_C__msdev_work_age1_x1_scr_mps_cp,0x26a);
      MVar7 = iVar5 % 10;
      if ((int)MVar7 < 2) {
        MVar7 = AllLand;
      }
      else if (MVar7 == WaterAndLand) {
        MVar7 = MostlyLand;
      }
      else if (MVar7 == MostlyLand) {
        MVar7 = WaterAndLand;
      }
      else if (MVar7 == AllLand) {
        MVar7 = MostlyWater;
      }
      else if (((MVar7 != Continental) && (MVar7 != Lake)) && (MVar7 != Hilly)) {
        MVar7 = (MVar7 != Isthmas) - MostlyWater & Isthmas;
      }
      TRIBE_Game::setMapType((TRIBE_Game *)rge_base_game,MVar7);
    }
    TRIBE_Game::setVictoryType((TRIBE_Game *)rge_base_game,VictoryDefault,0);
    RGE_Base_Game::setNumberPlayers(rge_base_game,4);
    RGE_Base_Game::setCampaignGame(rge_base_game,0);
    RGE_Base_Game::setSavedGame(rge_base_game,0);
    TRIBE_Game::setAnimals((TRIBE_Game *)rge_base_game,1);
    TRIBE_Game::setPredators((TRIBE_Game *)rge_base_game,1);
    RGE_Base_Game::setFullVisibility(rge_base_game,0);
    RGE_Base_Game::setFogOfWar(rge_base_game,1);
    RGE_Base_Game::setAllowCheatCodes(rge_base_game,1);
    TRIBE_Game::setRandomizePositions((TRIBE_Game *)rge_base_game,0);
    TRIBE_Game::setLongCombat((TRIBE_Game *)rge_base_game,0);
    TRIBE_Game::setAllowTrading((TRIBE_Game *)rge_base_game,1);
    TRIBE_Game::setFullTechTree((TRIBE_Game *)rge_base_game,0);
    TRIBE_Game::setResourceLevel((TRIBE_Game *)rge_base_game,DefaultResources);
    TRIBE_Game::setStartingAge((TRIBE_Game *)rge_base_game,DefaultAge);
    TRIBE_Game::setStartingUnits((TRIBE_Game *)rge_base_game,0);
    iVar5 = RGE_Base_Game::get_single_player_difficulty(rge_base_game);
    RGE_Base_Game::setDifficulty(rge_base_game,iVar5);
    TRIBE_Game::setQuickStartGame((TRIBE_Game *)rge_base_game,'\0');
  }
  else {
    RGE_Base_Game::setCampaignGame(rge_base_game,0);
    RGE_Base_Game::setSavedGame(rge_base_game,0);
    RGE_Base_Game::setScenarioGame(rge_base_game,0);
    RGE_Base_Game::setScenarioName(rge_base_game,s_);
    TRIBE_Game::setMapSize((TRIBE_Game *)rge_base_game,Large);
    TRIBE_Game::setMapType((TRIBE_Game *)rge_base_game,MostlyLand);
    TRIBE_Game::setVictoryType((TRIBE_Game *)rge_base_game,VictoryDefault,0);
    TRIBE_Game::setAnimals((TRIBE_Game *)rge_base_game,1);
    TRIBE_Game::setPredators((TRIBE_Game *)rge_base_game,1);
    RGE_Base_Game::setNumberPlayers(rge_base_game,8);
    RGE_Base_Game::setFullVisibility(rge_base_game,0);
    RGE_Base_Game::setFogOfWar(rge_base_game,1);
    RGE_Base_Game::setAllowCheatCodes(rge_base_game,0);
    TRIBE_Game::setRandomizePositions((TRIBE_Game *)rge_base_game,0);
    TRIBE_Game::setLongCombat((TRIBE_Game *)rge_base_game,0);
    TRIBE_Game::setAllowTrading((TRIBE_Game *)rge_base_game,1);
    TRIBE_Game::setFullTechTree((TRIBE_Game *)rge_base_game,0);
    TRIBE_Game::setResourceLevel((TRIBE_Game *)rge_base_game,DefaultResources);
    TRIBE_Game::setStartingAge((TRIBE_Game *)rge_base_game,DefaultAge);
    TRIBE_Game::setStartingUnits((TRIBE_Game *)rge_base_game,0);
    iVar5 = RGE_Base_Game::get_single_player_difficulty(rge_base_game);
    RGE_Base_Game::setDifficulty(rge_base_game,iVar5);
    TRIBE_Game::setDeathMatch((TRIBE_Game *)rge_base_game,'\0');
    TRIBE_Game::setQuickStartGame((TRIBE_Game *)rge_base_game,'\0');
    uVar3 = debug_timeGetTime(s_C__msdev_work_age1_x1_scr_mps_cp,0x243);
    debug_srand(s_C__msdev_work_age1_x1_scr_mps_cp,0x243,uVar3);
    iVar5 = 0;
    do {
      this->defaultColor[iVar5] = (char)iVar5 + '\x01';
      uVar4 = debug_rand(s_C__msdev_work_age1_x1_scr_mps_cp,0x248);
      uVar6 = (int)uVar4 >> 0x1f;
      TRIBE_Game::setCivilization
                ((TRIBE_Game *)rge_base_game,iVar5,
                 (((uVar4 ^ uVar6) - uVar6 & 0xf ^ uVar6) - uVar6) + 1);
      TRIBE_Game::setScenarioPlayer((TRIBE_Game *)rge_base_game,iVar5,iVar5);
      RGE_Base_Game::setPlayerHasCD(rge_base_game,iVar5,0);
      RGE_Base_Game::setPlayerVersion(rge_base_game,iVar5,'\0');
      TRIBE_Game::setPlayerColor((TRIBE_Game *)rge_base_game,iVar5,(uint)this->defaultColor[iVar5]);
      RGE_Base_Game::setPlayerTeam(rge_base_game,iVar5,1);
      TRIBE_Game::setComputerName((TRIBE_Game *)rge_base_game,iVar5,0);
      iVar5 = iVar5 + 1;
    } while (iVar5 < 8);
    iVar5 = TCommunications_Handler::IsHost(comm);
    if (iVar5 != 0) {
      RGE_Base_Game::setPlayerVersion(rge_base_game,0,'\x01');
      (**(code **)(rge_base_game->_padding_ + 0x48))();
      this->resend_game_options = 0;
      return;
    }
  }
  return;
}

// --------------------------------------------------

// Function: ~TribeMPSetupScreen
// Address: 004a1300
// [HELPER] s_Game_Settings_Screen: "Game Settings Screen"
// [HELPER] s_Kick_Dialog: "Kick Dialog"
// [HELPER] s_OKDialog: "OKDialog"
// [HELPER] s_Select_Tribe_Screen: "Select Tribe Screen"
// [HELPER] s_YesNoDialog: "YesNoDialog"
/* public: virtual __thiscall TribeMPSetupScreen::~TribeMPSetupScreen(void) */

void __thiscall TribeMPSetupScreen::~TribeMPSetupScreen(TribeMPSetupScreen *this)
{
  int iVar1;
  TDropDownPanel **ppTVar2;
  TTextPanel **ppTVar3;
  undefined4 *unaff_FS_OFFSET;
  undefined4 uStack_c;
  code *pcStack_8;
  undefined4 local_4;
  
  pcStack_8 = FUN_0055f1b8;
  uStack_c = *unaff_FS_OFFSET;
  *unaff_FS_OFFSET = &uStack_c;
  this->_padding_ = (int)&_vftable_;
  local_4 = 0;
  if (this->scenarioInfo != (T_Scenario *)0x0) {
    (**(code **)(this->scenarioInfo->_padding_ + 4))(1);
    this->scenarioInfo = (T_Scenario *)0x0;
  }
  TPanelSystem::destroyPanel(&panel_system,&s_Game_Settings_Screen);
  TPanelSystem::destroyPanel(&panel_system,s_Select_Tribe_Screen);
  TPanelSystem::destroyPanel(&panel_system,&s_Kick_Dialog);
  TPanelSystem::destroyPanel(&panel_system,&s_OKDialog);
  TPanelSystem::destroyPanel(&panel_system,&s_YesNoDialog);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->title);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->playerTitle);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->civTitle);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->settingsTitle);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->colorTitle);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->teamTitle);
  ppTVar2 = this->playerCivDrop;
  iVar1 = 8;
  do {
    TPanel::delete_panel((TPanel *)this,(TPanel **)(ppTVar2 + -8));
    TPanel::delete_panel((TPanel *)this,(TPanel **)ppTVar2);
    TPanel::delete_panel((TPanel *)this,(TPanel **)(ppTVar2 + 8));
    TPanel::delete_panel((TPanel *)this,(TPanel **)(ppTVar2 + -0x18));
    TPanel::delete_panel((TPanel *)this,(TPanel **)(ppTVar2 + -0x10));
    TPanel::delete_panel((TPanel *)this,(TPanel **)(ppTVar2 + -0x50));
    TPanel::delete_panel((TPanel *)this,(TPanel **)(ppTVar2 + -0x48));
    TPanel::delete_panel((TPanel *)this,(TPanel **)(ppTVar2 + -0x40));
    TPanel::delete_panel((TPanel *)this,(TPanel **)(ppTVar2 + -0x38));
    TPanel::delete_panel((TPanel *)this,(TPanel **)(ppTVar2 + -0x30));
    TPanel::delete_panel((TPanel *)this,(TPanel **)(ppTVar2 + -0x28));
    TPanel::delete_panel((TPanel *)this,(TPanel **)(ppTVar2 + -0x20));
    ppTVar2 = ppTVar2 + 1;
    iVar1 = iVar1 + -1;
  } while (iVar1 != 0);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->chatInput);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->chatTitle);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->chatBox);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->gameSettingsButton);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->scenarioName);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->victoryFixedText);
  ppTVar3 = this->settingValue;
  iVar1 = 0x14;
  do {
    TPanel::delete_panel((TPanel *)this,(TPanel **)(ppTVar3 + -0x14));
    TPanel::delete_panel((TPanel *)this,(TPanel **)ppTVar3);
    ppTVar3 = ppTVar3 + 1;
    iVar1 = iVar1 + -1;
  } while (iVar1 != 0);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->mapSizeLabel);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->mapSizeDrop);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->mapTypeLabel);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->mapTypeDrop);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->numberPlayersTitle);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->numberPlayersDrop);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->numberPlayersText);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->hiddenMapButton);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->hiddenMapText);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->victoryTypeLabel);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->victoryTypeDrop);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->victoryAmountLabel);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->victoryAmountInput);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->startButton);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->cancelButton);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->close_button);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->ready_button);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->ready_button_label);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->netInfoButton);
  TPanel::delete_panel((TPanel *)this,(TPanel **)&this->help_button);
  local_4 = 0xffffffff;
  TScreenPanel::~TScreenPanel((TScreenPanel *)this);
  *unaff_FS_OFFSET = uStack_c;
  return;
}

// --------------------------------------------------

// Function: handle_idle
// Address: 004a1640
// [HELPER] s_C__msdev_work_age1_x1_scr_mps_cp: "C:\msdev\work\age1_x1\scr_mps.cpp"
/* public: virtual long __thiscall TribeMPSetupScreen::handle_idle(void) */

long __thiscall TribeMPSetupScreen::handle_idle(TribeMPSetupScreen *this)
{
  int iVar1;
  ulong uVar2;
  long lVar3;
  
  if (rge_base_game->input_enabled == 0) {
    RGE_Base_Game::enable_input(rge_base_game);
  }
  iVar1 = RGE_Base_Game::multiplayerGame(rge_base_game);
  if (iVar1 != 0) {
    if (this->last_send_shared == 0) {
      iVar1 = 0x2fe;
    }
    else {
      uVar2 = debug_timeGetTime(s_C__msdev_work_age1_x1_scr_mps_cp,0x301);
      if (uVar2 == this->last_send_shared) goto LAB_004a16b9;
      TCommunications_Handler::SendSharedData(comm,0);
      iVar1 = 0x304;
    }
    uVar2 = debug_timeGetTime(s_C__msdev_work_age1_x1_scr_mps_cp,iVar1);
    this->last_send_shared = uVar2;
  }
LAB_004a16b9:
  lVar3 = TPanel::handle_idle((TPanel *)this);
  return lVar3;
}

// --------------------------------------------------

// Function: key_down_action
// Address: 004a16d0
/* public: virtual long __thiscall TribeMPSetupScreen::key_down_action(long,short,int,int,int) */

long __thiscall
TribeMPSetupScreen::key_down_action
          (TribeMPSetupScreen *this,long param_1,short param_2,int param_3,int param_4,int param_5)
{
  return 0;
}

// --------------------------------------------------

// Function: action
// Address: 004a16e0
// [HELPER] s_: ""
// [HELPER] s_Game_Settings_Screen: "Game Settings Screen"
// [HELPER] s_Kick_Dialog: "Kick Dialog"
// [HELPER] s_MP_Setup_Screen: "MP Setup Screen"
// [HELPER] s_____SAVING_MYCIV___MYTEAM: "$$$ SAVING MYCIV & MYTEAM"
// [HELPER] s_____SELECTED_I_M_READY: "$$$ SELECTED I'M READY"
// [HELPER] s_____SELECTED_NOT_READY: "$$$ SELECTED NOT READY"
// [HELPER] s__s_s_scn: "%s%s.scn"
// [HELPER] s__s_scn: "%s.scn"
// [HELPER] s__s_scx: "%s.scx"
/* public: virtual long __thiscall TribeMPSetupScreen::action(class TPanel *,long,unsigned
   long,unsigned long) */

long __thiscall
TribeMPSetupScreen::action
          (TribeMPSetupScreen *this,TPanel *param_1,long param_2,ulong param_3,ulong param_4)
{
  byte bVar1;
  TEditPanel *pTVar2;
  RGE_Prog_Info *pRVar3;
  uchar uVar4;
  int iVar5;
  long lVar6;
  char *pcVar7;
  TPanel *pTVar8;
  TButtonPanel **ppTVar9;
  byte *pbVar10;
  PLAYERHUMANITY PVar11;
  int iVar12;
  int iVar13;
  TDebuggingLog *this_00;
  TDebuggingLog *this_01;
  TButtonPanel *this_02;
  byte *pbVar14;
  TDropDownPanel **ppTVar15;
  undefined4 *unaff_FS_OFFSET;
  bool bVar16;
  ulong uVar17;
  ulong uVar18;
  ulong uVar19;
  ulong uVar20;
  ulong uVar21;
  ulong uVar22;
  char *pcVar23;
  ulong uVar24;
  char file_name [260];
  _finddata_t file_info;
  undefined4 local_c;
  code *pcStack_8;
  undefined4 local_4;
  
  local_c = *unaff_FS_OFFSET;
  local_4 = 0xffffffff;
  pcStack_8 = FUN_0055f1de;
  *unaff_FS_OFFSET = &local_c;
  if (param_1 != (TPanel *)0x0) {
    if (((TButtonPanel *)param_1 == this->startButton) && (param_2 == 1)) {
      pTVar2 = this->chatInput;
      if ((pTVar2 != (TEditPanel *)0x0) && (pTVar2->_padding_ != 0)) {
        TPanel::set_curr_child((TPanel *)this,(TPanel *)pTVar2);
      }
      startGame(this);
      param_2 = 1;
      goto LAB_004a1f92;
    }
    if (((TButtonPanel *)param_1 == this->ready_button) && (param_2 == 1)) {
      iVar5 = TButtonPanel::get_state(this->ready_button);
      if (iVar5 == 0) {
        TDebuggingLog::Log(this_00,(char *)L,s_____SELECTED_NOT_READY);
        iVar5 = TCommunications_Handler::IsHost(comm);
        if (iVar5 == 0) {
          iVar5 = RGE_Base_Game::check_for_cd(rge_base_game,0);
          uVar24 = iVar5 + 1;
        }
        else {
          uVar24 = 0;
        }
        TCommunications_Handler::SetMyReadiness(comm,0,0,0,uVar24,0,0,0,0);
        pTVar2 = this->chatInput;
        if ((pTVar2 != (TEditPanel *)0x0) && (pTVar2->_padding_ != 0)) {
          TPanel::set_curr_child((TPanel *)this,(TPanel *)pTVar2);
        }
        this->i_am_ready = 0;
      }
      else {
        TDebuggingLog::Log(this_00,(char *)L,s_____SELECTED_I_M_READY);
        iVar5 = TCommunications_Handler::IsHost(comm);
        uVar24 = 0;
        if (iVar5 == 0) {
          uVar4 = RGE_Base_Game::playerVersion(rge_base_game,0);
          if (uVar4 != '\x01') {
            (**(code **)(this->ready_button->_padding_ + 0xe0))(0);
                    /* language.dll match for 0x25e3: "The host is not running version 1.0b of the
                       game... Everyone must run the same version of Age of Empires to play a
                       multiplayer game." */
            TEasy_Panel::popupOKDialog((TEasy_Panel *)this,0x25e3,(char *)0x0,0x1c2,100);
            param_2 = 1;
            goto LAB_004a1f92;
          }
          iVar5 = TCommunications_Handler::WhoAmI(comm);
          TDebuggingLog::Log(this_01,(char *)L,s_____SAVING_MYCIV___MYTEAM);
          lVar6 = TDropDownPanel::get_id(this->playerNameDrop[iVar5 + 7]);
          this->myCivilization = lVar6;
          lVar6 = TDropDownPanel::get_id(this->playerCivDrop[iVar5 + 7]);
          this->myScenarioPlayer = lVar6;
          lVar6 = TButtonPanel::get_id((TButtonPanel *)this->playerTeamText[iVar5 + 7]);
          this->myPlayerColor = lVar6;
          iVar5 = TButtonPanel::get_state(this->playerColor[iVar5 + 7]);
          this->myPlayerTeam = iVar5 + 1;
          iVar5 = RGE_Base_Game::scenarioGame(rge_base_game);
          if (iVar5 == 0) {
            this->myScenarioChecksum = 0;
          }
          else {
            pRVar3 = rge_base_game->prog_info;
            pcVar7 = RGE_Base_Game::scenarioName(rge_base_game);
            sprintf(file_name + 4,s__s_s_scn,pRVar3->scenario_dir,pcVar7);
            iVar5 = __findfirst(file_name + 4,&file_info.time_create);
            if (iVar5 == -1) {
              pcVar7 = RGE_Base_Game::scenarioName(rge_base_game);
              pcVar23 = s__s_scx;
            }
            else {
              pcVar7 = RGE_Base_Game::scenarioName(rge_base_game);
              pcVar23 = s__s_scn;
            }
            sprintf(file_name + 4,pcVar23,pcVar7);
            lVar6 = RGE_Base_Game::get_scenario_checksum(rge_base_game,file_name + 4);
            this->myScenarioChecksum = lVar6;
          }
          uVar22 = this->myScenarioChecksum;
          uVar21 = this->myPlayerTeam;
          uVar20 = this->myPlayerColor;
          uVar24 = 1;
          iVar5 = RGE_Base_Game::check_for_cd(rge_base_game,0);
          uVar17 = this->myCivilization;
          uVar19 = iVar5 + 1;
          uVar18 = this->myScenarioPlayer + 1;
        }
        else {
          uVar22 = 0;
          uVar21 = 0;
          uVar20 = 0;
          uVar19 = 0;
          uVar18 = 0;
          uVar17 = 0;
        }
        TCommunications_Handler::SetMyReadiness
                  (comm,1,uVar17,uVar18,uVar19,uVar20,uVar21,uVar22,uVar24);
        pTVar2 = this->chatInput;
        if ((pTVar2 != (TEditPanel *)0x0) && (pTVar2->_padding_ != 0)) {
          TPanel::set_curr_child((TPanel *)this,(TPanel *)pTVar2);
        }
        this->i_am_ready = 1;
      }
      fillPlayers(this);
      iVar5 = TCommunications_Handler::IsHost(comm);
      if (iVar5 != 0) {
        TButtonPanel::set_disabled(this->gameSettingsButton,this->i_am_ready);
        TButtonPanel::set_disabled(this->startButton,(uint)(this->i_am_ready == 0));
        (**(code **)(rge_base_game->_padding_ + 0x48))();
        this->resend_game_options = 0;
        TCommunications_Handler::SendSharedData(comm,1);
        param_2 = 1;
        goto LAB_004a1f92;
      }
      goto LAB_004a1f6b;
    }
    if (((TButtonPanel *)param_1 == this->gameSettingsButton) && (param_2 == 1)) {
      pTVar2 = this->chatInput;
      if ((pTVar2 != (TEditPanel *)0x0) && (pTVar2->_padding_ != 0)) {
        TPanel::set_curr_child((TPanel *)this,(TPanel *)pTVar2);
      }
      pTVar8 = TPanelSystem::panel(&panel_system,&s_Game_Settings_Screen);
      if (pTVar8 == (TPanel *)0x0) {
        RGE_Base_Game::disable_input(rge_base_game);
        file_name._0_4_ = operator_new(0x560);
        local_4 = 0;
        if ((TribeGameSettingsScreen *)file_name._0_4_ != (TribeGameSettingsScreen *)0x0) {
          TribeGameSettingsScreen::TribeGameSettingsScreen
                    ((TribeGameSettingsScreen *)file_name._0_4_);
        }
        local_4 = 0xffffffff;
      }
      TPanelSystem::setCurrentPanel(&panel_system,&s_Game_Settings_Screen,0);
      param_2 = 1;
      goto LAB_004a1f92;
    }
    if (((TButtonPanel *)param_1 == this->help_button) && (param_2 == 1)) {
      TEasy_Panel::setup_popup_help((TEasy_Panel *)this);
      goto LAB_004a1f92;
    }
    if (((TButtonPanel *)param_1 == this->close_button) && (param_2 == 1)) {
      RGE_Base_Game::close(rge_base_game);
      goto LAB_004a1f92;
    }
    if (((TButtonPanel *)param_1 == this->cancelButton) && (param_2 == 1)) {
      pTVar2 = this->chatInput;
      if ((pTVar2 != (TEditPanel *)0x0) && (pTVar2->_padding_ != 0)) {
        TPanel::set_curr_child((TPanel *)this,(TPanel *)pTVar2);
      }
      cancelScreen(this,0);
      param_2 = 1;
      goto LAB_004a1f92;
    }
    if ((TButtonPanel *)param_1 == this->netInfoButton) {
      if (param_2 == 1) {
        showNetInfo(this);
        goto LAB_004a1f92;
      }
    }
    else if (param_2 == 1) {
      iVar5 = 0;
      ppTVar9 = this->playerTeam;
      do {
        if ((TButtonPanel *)param_1 == ppTVar9[-8]) {
          lVar6 = TButtonPanel::get_id(this->playerColor[iVar5]);
          TRIBE_Game::setPlayerColor((TRIBE_Game *)rge_base_game,iVar5,lVar6);
          iVar12 = RGE_Base_Game::multiplayerGame(rge_base_game);
          if ((iVar12 == 0) || (iVar12 = TCommunications_Handler::IsHost(comm), iVar12 != 0))
          goto LAB_004a1f6b;
          lVar6 = TButtonPanel::get_id(this->playerColor[iVar5]);
          this->myPlayerColor = lVar6;
          param_2 = 1;
          goto LAB_004a1f92;
        }
        if ((TButtonPanel *)param_1 == *ppTVar9) {
          iVar12 = TButtonPanel::get_state(this->playerTeam[iVar5]);
          RGE_Base_Game::setPlayerTeam(rge_base_game,iVar5,iVar12 + 1);
          iVar12 = RGE_Base_Game::multiplayerGame(rge_base_game);
          if ((iVar12 == 0) || (iVar12 = TCommunications_Handler::IsHost(comm), iVar12 != 0))
          goto LAB_004a1f6b;
          iVar5 = TButtonPanel::get_state(this->playerTeam[iVar5]);
          this->myPlayerTeam = iVar5 + 1;
          param_2 = 1;
          goto LAB_004a1f92;
        }
        iVar5 = iVar5 + 1;
        ppTVar9 = ppTVar9 + 1;
      } while (iVar5 < 8);
    }
    if (((((TEditPanel *)param_1 == this->chatInput) && (param_2 == 0)) &&
        (pcVar7 = TEditPanel::currentLine(this->chatInput), pcVar7 != (char *)0x0)) &&
       (pcVar7 = TEditPanel::currentLine(this->chatInput), *pcVar7 != '\0')) {
      pcVar7 = TEditPanel::currentLine(this->chatInput);
      TCommunications_Handler::SendChatMsgAll(comm,pcVar7);
      TEditPanel::set_text(this->chatInput,s_);
      param_2 = 1;
      goto LAB_004a1f92;
    }
    if (((TDropDownPanel *)param_1 == this->numberPlayersDrop) && (param_2 == 0)) {
      lVar6 = TDropDownPanel::get_id(this->numberPlayersDrop);
      RGE_Base_Game::setNumberPlayers(rge_base_game,lVar6);
      updateSummary(this);
      param_2 = 1;
      goto LAB_004a1f92;
    }
    pcVar7 = TPanel::panelName(param_1);
    if (pcVar7 != (char *)0x0) {
      pbVar14 = &s_Game_Settings_Screen;
      pbVar10 = (byte *)TPanel::panelName(param_1);
      do {
        bVar1 = *pbVar10;
        bVar16 = bVar1 < *pbVar14;
        if (bVar1 != *pbVar14) {
LAB_004a1c56:
          iVar5 = (1 - (uint)bVar16) - (uint)(bVar16 != 0);
          goto LAB_004a1c5b;
        }
        if (bVar1 == 0) break;
        bVar1 = pbVar10[1];
        bVar16 = bVar1 < pbVar14[1];
        if (bVar1 != pbVar14[1]) goto LAB_004a1c56;
        pbVar10 = pbVar10 + 2;
        pbVar14 = pbVar14 + 2;
      } while (bVar1 != 0);
      iVar5 = 0;
LAB_004a1c5b:
      if (iVar5 == 0) {
        if (param_2 != 0) {
          updateSummary(this);
          iVar5 = RGE_Base_Game::singlePlayerGame(rge_base_game);
          if (iVar5 == 0) {
            (**(code **)(rge_base_game->_padding_ + 0x48))();
            this->resend_game_options = 0;
          }
        }
        TPanelSystem::setCurrentPanel(&panel_system,s_MP_Setup_Screen,0);
        param_2 = 1;
        goto LAB_004a1f92;
      }
    }
    pcVar7 = TPanel::panelName(param_1);
    if (pcVar7 != (char *)0x0) {
      pbVar14 = &s_Kick_Dialog;
      pbVar10 = (byte *)TPanel::panelName(param_1);
      do {
        bVar1 = *pbVar10;
        bVar16 = bVar1 < *pbVar14;
        if (bVar1 != *pbVar14) {
LAB_004a1cf6:
          iVar5 = (1 - (uint)bVar16) - (uint)(bVar16 != 0);
          goto LAB_004a1cfb;
        }
        if (bVar1 == 0) break;
        bVar1 = pbVar10[1];
        bVar16 = bVar1 < pbVar14[1];
        if (bVar1 != pbVar14[1]) goto LAB_004a1cf6;
        pbVar10 = pbVar10 + 2;
        pbVar14 = pbVar14 + 2;
      } while (bVar1 != 0);
      iVar5 = 0;
LAB_004a1cfb:
      if (iVar5 == 0) {
        if (param_2 == 0) {
          PVar11 = TDropDownPanel::get_id
                             ((TDropDownPanel *)this->playerTeam[this->playerToKick + 7]);
          TCommunications_Handler::Kick(comm,this->playerToKick);
          TCommunications_Handler::SetPlayerHumanity(comm,this->playerToKick,PVar11);
          lVar6 = TDropDownPanel::get_line
                            ((TDropDownPanel *)this->playerTeam[this->playerToKick + 7],PVar11);
          this_02 = this->playerTeam[this->playerToKick + 7];
        }
        else {
          lVar6 = 0;
          this_02 = this->playerTeam[this->playerToKick + 7];
        }
        TDropDownPanel::set_line((TDropDownPanel *)this_02,lVar6);
        (**(code **)param_1->_padding_)(1);
        param_2 = 1;
        goto LAB_004a1f92;
      }
    }
    if ((param_2 == 0) && (iVar5 = RGE_Base_Game::numberPlayers(rge_base_game), 0 < iVar5)) {
      ppTVar15 = this->playerCivDrop;
      iVar5 = 0;
      do {
        if ((TDropDownPanel *)param_1 == ppTVar15[-8]) {
          iVar12 = RGE_Base_Game::multiplayerGame(rge_base_game);
          if ((iVar12 != 0) &&
             (lVar6 = TDropDownPanel::get_line(this->playerNameDrop[iVar5]), 0 < lVar6)) {
            iVar12 = TCommunications_Handler::IsPlayerHuman(comm,iVar5 + 1U);
            if (iVar12 != 0) {
              kickPlayer(this,iVar5 + 1U);
              param_2 = 1;
              goto LAB_004a1f92;
            }
          }
          PVar11 = TDropDownPanel::get_id(this->playerNameDrop[iVar5]);
          TCommunications_Handler::SetPlayerHumanity(comm,iVar5 + 1,PVar11);
          param_2 = 1;
          goto LAB_004a1f92;
        }
        if ((TDropDownPanel *)param_1 == *ppTVar15) {
          lVar6 = TDropDownPanel::get_id(this->playerCivDrop[iVar5]);
          TRIBE_Game::setCivilization((TRIBE_Game *)rge_base_game,iVar5,lVar6);
          iVar12 = RGE_Base_Game::multiplayerGame(rge_base_game);
          if ((iVar12 == 0) || (iVar12 = TCommunications_Handler::IsHost(comm), iVar12 != 0))
          goto LAB_004a1f6b;
          lVar6 = TDropDownPanel::get_id(this->playerCivDrop[iVar5]);
          this->myCivilization = lVar6;
          param_2 = 1;
          goto LAB_004a1f92;
        }
        if ((TDropDownPanel *)param_1 == ppTVar15[8]) {
          iVar12 = RGE_Base_Game::multiplayerGame(rge_base_game);
          if (iVar12 == 0) {
            lVar6 = TDropDownPanel::get_id(this->scenarioPlayerDrop[0]);
            TRIBE_Game::setScenarioPlayer((TRIBE_Game *)rge_base_game,0,lVar6);
            iVar5 = 1;
            iVar12 = 0;
            goto LAB_004a1f20;
          }
          lVar6 = TDropDownPanel::get_id(this->scenarioPlayerDrop[iVar5]);
          TRIBE_Game::setScenarioPlayer((TRIBE_Game *)rge_base_game,iVar5,lVar6);
          iVar12 = TCommunications_Handler::IsHost(comm);
          if (iVar12 != 0) goto LAB_004a1f6b;
          lVar6 = TDropDownPanel::get_id(this->scenarioPlayerDrop[iVar5]);
          this->myScenarioPlayer = lVar6;
          param_2 = 1;
          goto LAB_004a1f92;
        }
        iVar5 = iVar5 + 1;
        ppTVar15 = ppTVar15 + 1;
        iVar12 = RGE_Base_Game::numberPlayers(rge_base_game);
      } while (iVar5 < iVar12);
    }
  }
  param_2 = TEasy_Panel::action((TEasy_Panel *)this,param_1,param_2,param_3,param_4);
  goto LAB_004a1f92;
LAB_004a1f20:
  do {
    iVar13 = TRIBE_Game::scenarioPlayer((TRIBE_Game *)rge_base_game,0);
    if ((iVar12 != iVar13) &&
       (iVar13 = RGE_Scenario::Get_player_Active((RGE_Scenario *)this->scenarioInfo,iVar12),
       iVar13 != 0)) {
      TRIBE_Game::setScenarioPlayer((TRIBE_Game *)rge_base_game,iVar5,iVar12);
      iVar5 = iVar5 + 1;
      iVar13 = RGE_Base_Game::numberPlayers(rge_base_game);
      if (iVar13 <= iVar5) break;
    }
    iVar12 = iVar12 + 1;
  } while (iVar12 < 8);
  fillPlayers(this);
LAB_004a1f6b:
  param_2 = 1;
LAB_004a1f92:
  *unaff_FS_OFFSET = local_c;
  return param_2;
}

// --------------------------------------------------

// Function: startGame
// Address: 004a2060
// [HELPER] s_Status_Screen: "Status Screen"
// [HELPER] s_____HOST_RESET2_CIV_50: "$$$ HOST RESET2 CIV+50"
// [HELPER] s_____HOST_RESET2_TEAM_50: "$$$ HOST RESET2 TEAM+50"
/* WARNING: Variable defined which should be unmapped: send_options */
/* protected: int __thiscall TribeMPSetupScreen::startGame(void) */

int __thiscall TribeMPSetupScreen::startGame(TribeMPSetupScreen *this)
{
  bool bVar1;
  uchar uVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  char *pcVar7;
  long lVar8;
  char *pcVar9;
  int iVar10;
  TDebuggingLog *this_00;
  int *piVar11;
  uint uVar12;
  long *plVar13;
  int send_options;
  int temp_team [8];
  int temp_color [8];
  int temp_civ [8];
  char msg_fffffafc [256];
  char msg [1024];
  
  bVar1 = false;
  temp_team[0] = (int)this;
  iVar3 = RGE_Base_Game::multiplayerGame(rge_base_game);
  if (iVar3 != 0) {
    iVar3 = TCommunications_Handler::IsHost(comm);
    if (iVar3 == 0) {
      return 0;
    }
    iVar3 = TCommunications_Handler::AllPlayersReady(comm);
    if (iVar3 == 0) {
                    /* language.dll match for 0x25c1: "All players must be ready for a game to
                       start." */
      TEasy_Panel::popupOKDialog((TEasy_Panel *)this,0x25c1,(char *)0x0,0x1c2,100);
      return 0;
    }
    iVar3 = RGE_Base_Game::scenarioGame(rge_base_game);
    if (iVar3 != 0) {
      iVar3 = 0;
      uVar12 = 1;
      plVar13 = this->scenarioCheckSum;
      do {
        uVar4 = TCommunications_Handler::WhoAmI(comm);
        if (((uVar12 != uVar4) &&
            (iVar5 = TCommunications_Handler::GetPlayerHumanity(comm,uVar12), iVar5 == 2)) &&
           (*plVar13 != this->myScenarioChecksum)) {
          pcVar9 = TCommunications_Handler::GetPlayerName(comm,iVar3 + 1);
                    /* language.dll match for 0x25e1: "%s does not have this scenario or has a
                       different version of it." */
          pcVar7 = TPanel::get_string((TPanel *)this,0x25e1);
          sprintf(msg + 4,pcVar7,pcVar9);
          TEasy_Panel::popupOKDialog((TEasy_Panel *)this,msg + 4,(char *)0x0,0x1c2,100);
          return 0;
        }
        iVar3 = iVar3 + 1;
        plVar13 = plVar13 + 1;
        uVar12 = uVar12 + 1;
      } while ((int)uVar12 < 9);
    }
    uVar12 = 0;
    do {
      uVar4 = uVar12 + 1;
      uVar6 = TCommunications_Handler::WhoAmI(comm);
      if (((uVar4 != uVar6) &&
          (iVar3 = TCommunications_Handler::GetPlayerHumanity(comm,uVar4), iVar3 == 2)) &&
         (uVar2 = RGE_Base_Game::playerVersion(rge_base_game,uVar12), uVar2 != '\x01')) {
        pcVar9 = TCommunications_Handler::GetPlayerName(comm,uVar12 + 1);
                    /* language.dll match for 0x25e2: "%s is not running version 1.0b of the game...
                       Everyone must run the same version of Age of Empires before you can start the
                       game." */
        pcVar7 = TPanel::get_string((TPanel *)this,0x25e2);
        sprintf(msg + 4,pcVar7,pcVar9);
        TEasy_Panel::popupOKDialog((TEasy_Panel *)this,msg + 4,(char *)0x0,0x1c2,100);
        return 0;
      }
      uVar12 = uVar4;
    } while ((int)uVar4 < 8);
  }
  iVar3 = RGE_Base_Game::scenarioGame(rge_base_game);
  if ((iVar3 != 0) && (this->scenarioInfo == (T_Scenario *)0x0)) {
                    /* language.dll match for 0x25c2: "The selected scenario is invalid." */
    TEasy_Panel::popupOKDialog((TEasy_Panel *)this,0x25c2,(char *)0x0,0x1c2,100);
    return 0;
  }
  iVar3 = RGE_Base_Game::multiplayerGame(rge_base_game);
  if ((iVar3 != 0) && (iVar3 = RGE_Base_Game::scenarioGame(rge_base_game), iVar3 != 0)) {
    iVar3 = 0;
    uVar12 = 0;
    do {
      uVar4 = uVar12 + 1;
      iVar5 = TCommunications_Handler::GetPlayerHumanity(comm,uVar4);
      if ((iVar5 == 2) || (iVar5 == 4)) {
        lVar8 = TDropDownPanel::get_id(this->scenarioPlayerDrop[0],iVar3);
        TRIBE_Game::setScenarioPlayer((TRIBE_Game *)rge_base_game,uVar12,lVar8);
        iVar3 = iVar3 + 1;
        iVar5 = TTextPanel::numberLines((TTextPanel *)this->scenarioPlayerDrop[0]->list_panel);
        if (iVar5 <= iVar3) {
          iVar3 = 0;
        }
      }
      uVar12 = uVar4;
    } while ((int)uVar4 < 8);
  }
  iVar3 = RGE_Base_Game::multiplayerGame(rge_base_game);
  if (iVar3 != 0) {
    piVar11 = temp_team;
    iVar5 = 0;
    for (iVar3 = 8; piVar11 = piVar11 + 1, iVar3 != 0; iVar3 = iVar3 + -1) {
      *piVar11 = 0;
    }
    iVar3 = RGE_Base_Game::numberPlayers(rge_base_game);
    uVar12 = 0;
    if (0 < iVar3) {
      do {
        uVar4 = uVar12 + 1;
        iVar3 = TCommunications_Handler::GetPlayerHumanity(comm,uVar4);
        if (iVar3 == 2) {
          iVar3 = TRIBE_Game::playerColor((TRIBE_Game *)rge_base_game,uVar12);
          if (temp_team[iVar3] == 0) {
            iVar5 = iVar5 + 1;
            iVar3 = TRIBE_Game::playerColor((TRIBE_Game *)rge_base_game,uVar12);
            temp_team[iVar3] = 1;
          }
        }
        else if (iVar3 == 4) {
          iVar5 = iVar5 + 1;
        }
        iVar3 = RGE_Base_Game::numberPlayers(rge_base_game);
        uVar12 = uVar4;
      } while ((int)uVar4 < iVar3);
    }
    if (iVar5 < 2) {
                    /* language.dll match for 0x25c6: "You cannot start a game with only one
                       player." */
      TEasy_Panel::popupOKDialog((TEasy_Panel *)this,0x25c6,(char *)0x0,0x1c2,100);
      return 0;
    }
    iVar3 = RGE_Base_Game::scenarioGame(rge_base_game);
    if ((iVar3 != 0) && (iVar3 = this->scenarioPlayerCount, iVar3 < iVar5)) {
                    /* language.dll match for 0x25c3: "This scenario only supports up to %d
                       players." */
      pcVar9 = TPanel::get_string((TPanel *)this,0x25c3);
      sprintf(msg_fffffafc + 4,pcVar9,iVar3);
      TEasy_Panel::popupOKDialog((TEasy_Panel *)this,msg_fffffafc + 4,(char *)0x0,0x1c2,100);
      return 0;
    }
    iVar3 = RGE_Base_Game::scenarioGame(rge_base_game);
    if (((iVar3 != 0) && (this->settingsFixed != 0)) &&
       (iVar3 = this->scenarioPlayerCount, iVar5 != iVar3)) {
                    /* language.dll match for 0x25c5: "This scenario requires exactly %d players."
                        */
      pcVar9 = TPanel::get_string((TPanel *)this,0x25c5);
      sprintf(msg_fffffafc + 4,pcVar9,iVar3);
      TEasy_Panel::popupOKDialog((TEasy_Panel *)this,msg_fffffafc + 4,(char *)0x0,0x1c2,100);
      return 0;
    }
    iVar5 = 0;
    uVar12 = 0;
    iVar3 = RGE_Base_Game::numberPlayers(rge_base_game);
    if (0 < iVar3) {
      do {
        uVar12 = uVar12 + 1;
        iVar3 = TCommunications_Handler::GetPlayerHumanity(comm,uVar12);
        if (iVar3 == 2) {
          iVar5 = iVar5 + 1;
        }
        iVar3 = RGE_Base_Game::numberPlayers(rge_base_game);
      } while ((int)uVar12 < iVar3);
    }
    iVar3 = RGE_Base_Game::check_for_cd(rge_base_game,0);
    iVar10 = TCommunications_Handler::WhoAmI(comm);
    RGE_Base_Game::setPlayerHasCD(rge_base_game,iVar10 + -1,iVar3);
    iVar3 = RGE_Base_Game::check_for_cd(rge_base_game,iVar5);
    if (iVar3 == 0) {
                    /* language.dll match for 0x7d9: "One game CD is required for every three
                       players." */
      TEasy_Panel::popupOKDialog((TEasy_Panel *)this,0x7d9,(char *)0x0,0x1c2,100);
      return 0;
    }
  }
  iVar3 = RGE_Base_Game::scenarioGame(rge_base_game);
  if ((iVar3 != 0) &&
     (iVar3 = TRIBE_Game::randomizePositions((TRIBE_Game *)rge_base_game), iVar3 != 0)) {
    calcRandomPositions(this);
    iVar3 = RGE_Base_Game::multiplayerGame(rge_base_game);
    if (iVar3 != 0) {
      bVar1 = true;
    }
  }
  iVar3 = RGE_Base_Game::singlePlayerGame(rge_base_game);
  if ((iVar3 != 0) && (iVar3 = RGE_Base_Game::numberPlayers(rge_base_game), iVar3 < 8)) {
    uVar12 = iVar3 + 1;
    do {
      TCommunications_Handler::SetPlayerHumanity(comm,uVar12,ME_ABSENT);
      uVar12 = uVar12 + 1;
    } while ((int)uVar12 < 9);
  }
  iVar3 = RGE_Base_Game::multiplayerGame(rge_base_game);
  if (iVar3 != 0) {
    iVar5 = 0;
    iVar3 = RGE_Base_Game::numberPlayers(rge_base_game);
    if (0 < iVar3) {
      do {
        iVar3 = TRIBE_Game::civilization((TRIBE_Game *)rge_base_game,iVar5);
        if (0x31 < iVar3) {
          TDebuggingLog::Log(L,(char *)L,s_____HOST_RESET2_CIV_50);
          iVar3 = TRIBE_Game::civilization((TRIBE_Game *)rge_base_game,iVar5);
          TRIBE_Game::setCivilization((TRIBE_Game *)rge_base_game,iVar5,iVar3 + -0x32);
          bVar1 = true;
        }
        iVar3 = RGE_Base_Game::playerTeam(rge_base_game,iVar5);
        if (0x31 < iVar3) {
          TDebuggingLog::Log(this_00,(char *)L,s_____HOST_RESET2_TEAM_50);
          iVar3 = RGE_Base_Game::playerTeam(rge_base_game,iVar5);
          RGE_Base_Game::setPlayerTeam(rge_base_game,iVar5,iVar3 + -0x32);
          bVar1 = true;
        }
        iVar5 = iVar5 + 1;
        iVar3 = RGE_Base_Game::numberPlayers(rge_base_game);
      } while (iVar5 < iVar3);
    }
  }
  iVar3 = RGE_Base_Game::multiplayerGame(rge_base_game);
  if (iVar3 != 0) {
    piVar11 = temp_team;
    for (iVar3 = 8; piVar11 = piVar11 + 1, iVar3 != 0; iVar3 = iVar3 + -1) {
      *piVar11 = 1;
    }
    piVar11 = temp_civ;
    for (iVar3 = 8; piVar11 = piVar11 + 1, iVar5 = 0, iVar3 != 0; iVar3 = iVar3 + -1) {
      *piVar11 = 1;
    }
    do {
      iVar3 = iVar5 + 1;
      temp_color[iVar5 + 1] = iVar3;
      iVar5 = iVar3;
    } while (iVar3 < 8);
    iVar3 = 0;
    uVar12 = 1;
    piVar11 = temp_team + 1;
    do {
      iVar5 = TCommunications_Handler::GetPlayerHumanity(comm,uVar12);
      if ((iVar5 == 2) || (iVar5 == 4)) {
        iVar5 = uVar12 - 1;
        iVar10 = TRIBE_Game::playerColor((TRIBE_Game *)rge_base_game,iVar5);
        temp_color[iVar3 + 1] = iVar10;
        iVar10 = TRIBE_Game::civilization((TRIBE_Game *)rge_base_game,iVar5);
        temp_civ[iVar3 + 1] = iVar10;
        iVar5 = RGE_Base_Game::playerTeam(rge_base_game,iVar5);
        *piVar11 = iVar5;
        iVar3 = iVar3 + 1;
        piVar11 = piVar11 + 1;
      }
      uVar12 = uVar12 + 1;
    } while ((int)uVar12 < 9);
    if (0 < iVar3) {
      iVar3 = 0;
      piVar11 = temp_team;
      do {
        piVar11 = piVar11 + 1;
        TRIBE_Game::setPlayerColor((TRIBE_Game *)rge_base_game,iVar3,temp_color[iVar3 + 1]);
        TRIBE_Game::setCivilization((TRIBE_Game *)rge_base_game,iVar3,temp_civ[iVar3 + 1]);
        RGE_Base_Game::setPlayerTeam(rge_base_game,iVar3,*piVar11);
        iVar3 = iVar3 + 1;
      } while (iVar3 < 8);
      bVar1 = true;
    }
  }
  TPanelSystem::destroyPanel(&panel_system,s_Status_Screen);
  iVar3 = RGE_Base_Game::multiplayerGame(rge_base_game);
  if (iVar3 != 0) {
    if ((bVar1) || (*(int *)(temp_team[0] + 0x88c) != 0)) {
      (**(code **)(rge_base_game->_padding_ + 0x48))();
      *(undefined4 *)(temp_team[0] + 0x88c) = 0;
    }
    TCommunications_Handler::LaunchMultiplayerGame(comm);
    TChat::setWindowHandle(chat,AppWnd);
    TCommunications_Handler::SetWindowHandle(comm,AppWnd);
  }
  iVar3 = TRIBE_Game::start_game((TRIBE_Game *)rge_base_game,0);
  if (iVar3 == 0) {
                    /* language.dll match for 0x961: "An error occurred while trying to start the
                       game." */
    TEasy_Panel::popupOKDialog((TEasy_Panel *)temp_team[0],0x961,(char *)0x0,0x1c2,100);
    return 0;
  }
  return 1;
}

// --------------------------------------------------

// Function: calcRandomPositions
// Address: 004a27a0
// [HELPER] s_C__msdev_work_age1_x1_scr_mps_cp: "C:\msdev\work\age1_x1\scr_mps.cpp"
/* protected: void __thiscall TribeMPSetupScreen::calcRandomPositions(void) */

void __thiscall TribeMPSetupScreen::calcRandomPositions(TribeMPSetupScreen *this)
{
  uint uVar1;
  int iVar2;
  long lVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  int *piVar7;
  int pos;
  int local_28;
  int position_used [8];
  
  iVar4 = 0;
  uVar5 = 0;
  iVar2 = RGE_Base_Game::numberPlayers(rge_base_game);
  if (0 < iVar2) {
    do {
      uVar5 = uVar5 + 1;
      iVar2 = TCommunications_Handler::GetPlayerHumanity(comm,uVar5);
      if ((iVar2 == 2) || (iVar2 == 4)) {
        iVar4 = iVar4 + 1;
      }
      iVar2 = RGE_Base_Game::numberPlayers(rge_base_game);
    } while ((int)uVar5 < iVar2);
  }
  iVar2 = 0;
  iVar6 = 0;
  piVar7 = position_used;
  do {
    piVar7 = piVar7 + 1;
    lVar3 = TDropDownPanel::get_line(this->scenarioPlayerDrop[0],iVar6);
    if (lVar3 == -1) {
      *piVar7 = -2;
    }
    else {
      *piVar7 = -1;
      iVar2 = iVar2 + 1;
    }
    iVar6 = iVar6 + 1;
  } while (iVar6 < 8);
  if (iVar4 <= iVar2) {
    uVar5 = 0;
    iVar2 = RGE_Base_Game::numberPlayers(rge_base_game);
    if (0 < iVar2) {
      do {
        uVar1 = uVar5 + 1;
        position_used[0] = uVar1;
        iVar2 = TCommunications_Handler::GetPlayerHumanity(comm,uVar1);
        if ((iVar2 == 2) || (iVar2 == 4)) {
          iVar4 = 0;
          iVar2 = local_28;
          if (0 < this->scenarioPlayerCount) {
            piVar7 = position_used;
            do {
              piVar7 = piVar7 + 1;
              iVar2 = iVar4;
              if (*piVar7 == -1) break;
              iVar4 = iVar4 + 1;
              iVar2 = local_28;
            } while (iVar4 < this->scenarioPlayerCount);
          }
          local_28 = iVar2;
          iVar2 = 0;
          do {
            iVar6 = this->scenarioPlayerCount;
            iVar4 = debug_rand(s_C__msdev_work_age1_x1_scr_mps_cp,0x5e4);
            iVar4 = (iVar4 * iVar6) / 0x7fff;
            if (iVar4 < iVar6) {
              if (iVar4 < 0) {
                iVar4 = 0;
              }
            }
            else {
              iVar4 = iVar6 + -1;
            }
          } while ((position_used[iVar4 + 1] != -1) &&
                  (iVar2 = iVar2 + 1, iVar4 = local_28, iVar2 < 1000));
          local_28 = iVar4;
          TRIBE_Game::setScenarioPlayer((TRIBE_Game *)rge_base_game,uVar5,local_28);
          position_used[local_28 + 1] = uVar5;
          uVar1 = position_used[0];
        }
        uVar5 = uVar1;
        iVar2 = RGE_Base_Game::numberPlayers(rge_base_game);
      } while ((int)uVar5 < iVar2);
    }
  }
  return;
}

// --------------------------------------------------

// Function: showNetInfo
// Address: 004a2910
// [HELPER] s_OKDialog: "OKDialog"
// [HELPER] s__: "}"
// [HELPER] s___: "]\n"
/* WARNING: Variable defined which should be unmapped: num_addr */
/* protected: void __thiscall TribeMPSetupScreen::showNetInfo(void) */

void __thiscall TribeMPSetupScreen::showNetInfo(TribeMPSetupScreen *this)
{
  char cVar1;
  uint uVar2;
  RGE_Communications_Addresses *pRVar3;
  char *pcVar4;
  char *pcVar5;
  uint uVar6;
  int iVar7;
  uint uVar8;
  uint uVar9;
  char *pcVar10;
  undefined4 *unaff_FS_OFFSET;
  uint num_addr;
  char message [1024];
  char temp_str [256];
  undefined4 local_c;
  code *pcStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  pcStack_8 = FUN_0055f1fe;
  local_c = *unaff_FS_OFFSET;
  *unaff_FS_OFFSET = &local_c;
  message._0_4_ = this;
  pRVar3 = (RGE_Communications_Addresses *)operator_new(0x224);
  local_4 = 0;
  if (pRVar3 == (RGE_Communications_Addresses *)0x0) {
    pRVar3 = (RGE_Communications_Addresses *)0x0;
  }
  else {
    pRVar3 = (RGE_Communications_Addresses *)
             RGE_Communications_Addresses::RGE_Communications_Addresses(pRVar3,comm);
  }
  local_4 = 0xffffffff;
  if (pRVar3 != (RGE_Communications_Addresses *)0x0) {
    uVar2 = pRVar3->AddressesAvailable;
    message[4] = '\0';
    if (uVar2 == 0) {
                    /* language.dll match for 0x238d: "No IP addressing information is available."
                        */
      TEasy_Panel::popupOKDialog((TEasy_Panel *)this,0x238d,(char *)0x0,0x1c2,100);
    }
    else {
      uVar6 = 0xffffffff;
      pcVar4 = &s___;
      do {
        pcVar5 = pcVar4;
        if (uVar6 == 0) break;
        uVar6 = uVar6 - 1;
        pcVar5 = pcVar4 + 1;
        cVar1 = *pcVar4;
        pcVar4 = pcVar5;
      } while (cVar1 != '\0');
      uVar6 = ~uVar6;
      iVar7 = -1;
      pcVar4 = message + 4;
      do {
        pcVar10 = pcVar4;
        if (iVar7 == 0) break;
        iVar7 = iVar7 + -1;
        pcVar10 = pcVar4 + 1;
        cVar1 = *pcVar4;
        pcVar4 = pcVar10;
      } while (cVar1 != '\0');
      pcVar4 = pcVar5 + -uVar6;
      pcVar5 = pcVar10 + -1;
      for (uVar8 = uVar6 >> 2; uVar8 != 0; uVar8 = uVar8 - 1) {
        *(undefined4 *)pcVar5 = *(undefined4 *)pcVar4;
        pcVar4 = pcVar4 + 4;
        pcVar5 = pcVar5 + 4;
      }
      for (uVar6 = uVar6 & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
        *pcVar5 = *pcVar4;
        pcVar4 = pcVar4 + 1;
        pcVar5 = pcVar5 + 1;
      }
      pcVar4 = RGE_Communications_Addresses::GetHostName(pRVar3);
                    /* language.dll match for 0x238c: "Host name: %s" */
      pcVar5 = TPanel::get_string((TPanel *)this,0x238c);
      sprintf(temp_str + 4,pcVar5,pcVar4);
      uVar6 = 0xffffffff;
      pcVar4 = temp_str + 4;
      do {
        pcVar5 = pcVar4;
        if (uVar6 == 0) break;
        uVar6 = uVar6 - 1;
        pcVar5 = pcVar4 + 1;
        cVar1 = *pcVar4;
        pcVar4 = pcVar5;
      } while (cVar1 != '\0');
      uVar6 = ~uVar6;
      iVar7 = -1;
      pcVar4 = message + 4;
      do {
        pcVar10 = pcVar4;
        if (iVar7 == 0) break;
        iVar7 = iVar7 + -1;
        pcVar10 = pcVar4 + 1;
        cVar1 = *pcVar4;
        pcVar4 = pcVar10;
      } while (cVar1 != '\0');
      pcVar4 = pcVar5 + -uVar6;
      pcVar5 = pcVar10 + -1;
      for (uVar8 = uVar6 >> 2; uVar8 != 0; uVar8 = uVar8 - 1) {
        *(undefined4 *)pcVar5 = *(undefined4 *)pcVar4;
        pcVar4 = pcVar4 + 4;
        pcVar5 = pcVar5 + 4;
      }
      for (uVar6 = uVar6 & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
        *pcVar5 = *pcVar4;
        pcVar4 = pcVar4 + 1;
        pcVar5 = pcVar5 + 1;
      }
      uVar6 = 0xffffffff;
      pcVar4 = &s__;
      do {
        pcVar5 = pcVar4;
        if (uVar6 == 0) break;
        uVar6 = uVar6 - 1;
        pcVar5 = pcVar4 + 1;
        cVar1 = *pcVar4;
        pcVar4 = pcVar5;
      } while (cVar1 != '\0');
      uVar6 = ~uVar6;
      iVar7 = -1;
      pcVar4 = message + 4;
      do {
        pcVar10 = pcVar4;
        if (iVar7 == 0) break;
        iVar7 = iVar7 + -1;
        pcVar10 = pcVar4 + 1;
        cVar1 = *pcVar4;
        pcVar4 = pcVar10;
      } while (cVar1 != '\0');
      pcVar4 = pcVar5 + -uVar6;
      pcVar5 = pcVar10 + -1;
      for (uVar8 = uVar6 >> 2; uVar8 != 0; uVar8 = uVar8 - 1) {
        *(undefined4 *)pcVar5 = *(undefined4 *)pcVar4;
        pcVar4 = pcVar4 + 4;
        pcVar5 = pcVar5 + 4;
      }
      uVar8 = 0;
      for (uVar6 = uVar6 & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
        *pcVar5 = *pcVar4;
        pcVar4 = pcVar4 + 1;
        pcVar5 = pcVar5 + 1;
      }
      if (uVar2 != 0) {
        do {
          pcVar4 = RGE_Communications_Addresses::GetAddress(pRVar3,uVar8);
          if (pcVar4 != (char *)0x0) {
            pcVar4 = RGE_Communications_Addresses::GetAddress(pRVar3,uVar8);
            uVar6 = 0xffffffff;
            do {
              pcVar5 = pcVar4;
              if (uVar6 == 0) break;
              uVar6 = uVar6 - 1;
              pcVar5 = pcVar4 + 1;
              cVar1 = *pcVar4;
              pcVar4 = pcVar5;
            } while (cVar1 != '\0');
            uVar6 = ~uVar6;
            iVar7 = -1;
            pcVar4 = message + 4;
            do {
              pcVar10 = pcVar4;
              if (iVar7 == 0) break;
              iVar7 = iVar7 + -1;
              pcVar10 = pcVar4 + 1;
              cVar1 = *pcVar4;
              pcVar4 = pcVar10;
            } while (cVar1 != '\0');
            pcVar4 = pcVar5 + -uVar6;
            pcVar5 = pcVar10 + -1;
            for (uVar9 = uVar6 >> 2; uVar9 != 0; uVar9 = uVar9 - 1) {
              *(undefined4 *)pcVar5 = *(undefined4 *)pcVar4;
              pcVar4 = pcVar4 + 4;
              pcVar5 = pcVar5 + 4;
            }
            for (uVar6 = uVar6 & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
              *pcVar5 = *pcVar4;
              pcVar4 = pcVar4 + 1;
              pcVar5 = pcVar5 + 1;
            }
            uVar6 = 0xffffffff;
            pcVar4 = &s__;
            do {
              pcVar5 = pcVar4;
              if (uVar6 == 0) break;
              uVar6 = uVar6 - 1;
              pcVar5 = pcVar4 + 1;
              cVar1 = *pcVar4;
              pcVar4 = pcVar5;
            } while (cVar1 != '\0');
            uVar6 = ~uVar6;
            iVar7 = -1;
            pcVar4 = message + 4;
            do {
              pcVar10 = pcVar4;
              if (iVar7 == 0) break;
              iVar7 = iVar7 + -1;
              pcVar10 = pcVar4 + 1;
              cVar1 = *pcVar4;
              pcVar4 = pcVar10;
            } while (cVar1 != '\0');
            pcVar4 = pcVar5 + -uVar6;
            pcVar5 = pcVar10 + -1;
            for (uVar9 = uVar6 >> 2; uVar9 != 0; uVar9 = uVar9 - 1) {
              *(undefined4 *)pcVar5 = *(undefined4 *)pcVar4;
              pcVar4 = pcVar4 + 4;
              pcVar5 = pcVar5 + 4;
            }
            for (uVar6 = uVar6 & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
              *pcVar5 = *pcVar4;
              pcVar4 = pcVar4 + 1;
              pcVar5 = pcVar5 + 1;
            }
          }
          pcVar4 = RGE_Communications_Addresses::GetAlias(pRVar3,uVar8);
          if (pcVar4 != (char *)0x0) {
            pcVar4 = RGE_Communications_Addresses::GetAlias(pRVar3,uVar8);
            uVar6 = 0xffffffff;
            do {
              pcVar5 = pcVar4;
              if (uVar6 == 0) break;
              uVar6 = uVar6 - 1;
              pcVar5 = pcVar4 + 1;
              cVar1 = *pcVar4;
              pcVar4 = pcVar5;
            } while (cVar1 != '\0');
            uVar6 = ~uVar6;
            iVar7 = -1;
            pcVar4 = message + 4;
            do {
              pcVar10 = pcVar4;
              if (iVar7 == 0) break;
              iVar7 = iVar7 + -1;
              pcVar10 = pcVar4 + 1;
              cVar1 = *pcVar4;
              pcVar4 = pcVar10;
            } while (cVar1 != '\0');
            pcVar4 = pcVar5 + -uVar6;
            pcVar5 = pcVar10 + -1;
            for (uVar9 = uVar6 >> 2; uVar9 != 0; uVar9 = uVar9 - 1) {
              *(undefined4 *)pcVar5 = *(undefined4 *)pcVar4;
              pcVar4 = pcVar4 + 4;
              pcVar5 = pcVar5 + 4;
            }
            for (uVar6 = uVar6 & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
              *pcVar5 = *pcVar4;
              pcVar4 = pcVar4 + 1;
              pcVar5 = pcVar5 + 1;
            }
          }
          uVar6 = 0xffffffff;
          pcVar4 = &s__;
          do {
            pcVar5 = pcVar4;
            if (uVar6 == 0) break;
            uVar6 = uVar6 - 1;
            pcVar5 = pcVar4 + 1;
            cVar1 = *pcVar4;
            pcVar4 = pcVar5;
          } while (cVar1 != '\0');
          uVar6 = ~uVar6;
          iVar7 = -1;
          pcVar4 = message + 4;
          do {
            pcVar10 = pcVar4;
            if (iVar7 == 0) break;
            iVar7 = iVar7 + -1;
            pcVar10 = pcVar4 + 1;
            cVar1 = *pcVar4;
            pcVar4 = pcVar10;
          } while (cVar1 != '\0');
          pcVar4 = pcVar5 + -uVar6;
          pcVar5 = pcVar10 + -1;
          for (uVar9 = uVar6 >> 2; uVar9 != 0; uVar9 = uVar9 - 1) {
            *(undefined4 *)pcVar5 = *(undefined4 *)pcVar4;
            pcVar4 = pcVar4 + 4;
            pcVar5 = pcVar5 + 4;
          }
          uVar8 = uVar8 + 1;
          for (uVar6 = uVar6 & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
            *pcVar5 = *pcVar4;
            pcVar4 = pcVar4 + 1;
            pcVar5 = pcVar5 + 1;
          }
        } while (uVar8 < uVar2);
      }
      TEasy_Panel::popupOKDialog
                ((TEasy_Panel *)message._0_4_,message + 4,&s_OKDialog,0x1c2,uVar2 * 0x12 + 100);
    }
    RGE_Communications_Addresses::~RGE_Communications_Addresses(pRVar3);
    operator_delete(pRVar3);
  }
  *unaff_FS_OFFSET = local_c;
  return;
}

// --------------------------------------------------

// Function: cancelScreen
// Address: 004a2ba0
// [HELPER] s_Join_Screen: "Join Screen"
// [HELPER] s_MP_Setup_Screen: "MP Setup Screen"
// [HELPER] s_Main_Error_Screen: "Main Error Screen"
// [HELPER] s_Select_Scenario_Screen: "Select Scenario Screen"
// [HELPER] s_Single_Player_Menu: "Single Player Menu"
/* protected: void __thiscall TribeMPSetupScreen::cancelScreen(int) */

void __thiscall TribeMPSetupScreen::cancelScreen(TribeMPSetupScreen *this,int param_1)
{
  RGE_Base_Game *this_00;
  int iVar1;
  TribeSelectScenarioScreen *this_01;
  TribeSPMenuScreen *this_02;
  TRIBE_Screen_Main_Error *pTVar2;
  TribeJoinScreen *this_03;
  undefined4 *unaff_FS_OFFSET;
  char *pcVar3;
  undefined4 local_c;
  code *pcStack_8;
  undefined4 local_4;
  
  this_00 = rge_base_game;
  local_c = *unaff_FS_OFFSET;
  local_4 = 0xffffffff;
  pcStack_8 = FUN_0055f23c;
  *unaff_FS_OFFSET = &local_c;
  iVar1 = RGE_Base_Game::singlePlayerGame(this_00);
  if (iVar1 == 0) {
    iVar1 = TCommunications_Handler::IsLobbyLaunched(comm);
    if (iVar1 != 0) {
      if (param_1 != 0) {
        pTVar2 = (TRIBE_Screen_Main_Error *)operator_new(0x484);
        local_4 = 2;
        if (pTVar2 == (TRIBE_Screen_Main_Error *)0x0) {
          pTVar2 = (TRIBE_Screen_Main_Error *)0x0;
        }
        else {
          pTVar2 = (TRIBE_Screen_Main_Error *)
                   TRIBE_Screen_Main_Error::TRIBE_Screen_Main_Error(pTVar2);
        }
        local_4 = 0xffffffff;
        if ((pTVar2 != (TRIBE_Screen_Main_Error *)0x0) && (pTVar2->_padding_ == 0)) {
                    /* language.dll match for 0x96a: "Timed out while trying to connect to the
                       game." */
          TRIBE_Screen_Main_Error::set_text(pTVar2,0x96a);
          pcVar3 = s_Main_Error_Screen;
          goto LAB_004a2d23;
        }
      }
      RGE_Base_Game::close(rge_base_game);
      *unaff_FS_OFFSET = local_c;
      return;
    }
    RGE_Base_Game::disable_input(rge_base_game);
    TCommunications_Handler::UnlinkToLevel(comm,SERVICE_AVAILABLE);
                    /* language.dll match for 0x4b0: "Ready" */
    this_03 = (TribeJoinScreen *)operator_new(0x4b0);
    local_4 = 3;
    if (this_03 != (TribeJoinScreen *)0x0) {
      TribeJoinScreen::TribeJoinScreen(this_03);
    }
    local_4 = 0xffffffff;
    pcVar3 = s_Join_Screen;
  }
  else {
    RGE_Base_Game::disable_input(rge_base_game);
    iVar1 = RGE_Base_Game::scenarioGame(rge_base_game);
    if (iVar1 == 0) {
      this_02 = (TribeSPMenuScreen *)operator_new(0x49c);
      local_4 = 1;
      if (this_02 != (TribeSPMenuScreen *)0x0) {
        TribeSPMenuScreen::TribeSPMenuScreen(this_02);
      }
      local_4 = 0xffffffff;
      pcVar3 = s_Single_Player_Menu;
    }
    else {
      this_01 = (TribeSelectScenarioScreen *)operator_new(0x4d8);
      local_4 = 0;
      if (this_01 != (TribeSelectScenarioScreen *)0x0) {
        TribeSelectScenarioScreen::TribeSelectScenarioScreen(this_01);
      }
      local_4 = 0xffffffff;
      pcVar3 = s_Select_Scenario_Screen;
    }
  }
LAB_004a2d23:
  TPanelSystem::setCurrentPanel(&panel_system,pcVar3,0);
  TPanelSystem::destroyPanel(&panel_system,s_MP_Setup_Screen);
  *unaff_FS_OFFSET = local_c;
  return;
}

// --------------------------------------------------

// Function: handle_user_command
// Address: 004a2d50
// [HELPER] s_C__msdev_work_age1_x1_scr_mps_cp: "C:\msdev\work\age1_x1\scr_mps.cpp"
// [HELPER] s_____HOST_RESET_CIV_50: "$$$ HOST RESET CIV+50"
// [HELPER] s_____HOST_RESET_TEAM_50: "$$$ HOST RESET TEAM+50"
// [HELPER] s_____RESETTING_MYCIV2: "$$$ RESETTING MYCIV2"
// [HELPER] s_____RESETTING_MYTEAM2: "$$$ RESETTING MYTEAM2"
// [HELPER] s_____USER_COMMAND__CHAT_RECEIVED_: "$$$ USER_COMMAND: CHAT_RECEIVED (%d,%d)"
// [HELPER] s_____USER_COMMAND__COMM_BAD_VERSI: "$$$ USER_COMMAND: COMM_BAD_VERSION (%d,%d)"
// [HELPER] s_____USER_COMMAND__COMM_CANCEL_GA: "$$$ USER_COMMAND: COMM_CANCEL_GAME (%d,%d)"
// [HELPER] s_____USER_COMMAND__COMM_HOST_BUSY: "$$$ USER_COMMAND: COMM_HOST_BUSY (%d,%d)"
// [HELPER] s_____USER_COMMAND__COMM_HOST_EXIT: "$$$ USER_COMMAND: COMM_HOST_EXITED (%d,%d)"
// [HELPER] s_____USER_COMMAND__COMM_LAUNCH_GA: "$$$ USER_COMMAND: COMM_LAUNCH_GAME (%d,%d)"
// [HELPER] s_____USER_COMMAND__COMM_NO_LINK__: "$$$ USER_COMMAND: COMM_NO_LINK (%d,%d)"
// [HELPER] s_____USER_COMMAND__COMM_OTHER_PLA: "$$$ USER_COMMAND: COMM_OTHER_PLAYER_DROPPED (%d,%d)"
// [HELPER] s_____USER_COMMAND__COMM_PLAYER_DR: "$$$ USER_COMMAND: COMM_PLAYER_DROPPED (%d,%d)"
// [HELPER] s_____USER_COMMAND__COMM_PLAYER_KI: "$$$ USER_COMMAND: COMM_PLAYER_KICKED (%d,%d)"
// [HELPER] s_____USER_COMMAND__COMM_PLAYER_SE: "$$$ USER_COMMAND: COMM_PLAYER_SERVICE_ERROR (%d,%d)"
// [HELPER] s_____USER_COMMAND__COMM_SHARED_DA: "$$$ USER_COMMAND: COMM_SHARED_DATA_SENT (%d,%d)"
// [HELPER] s_____USER_COMMAND__COMM_UPDATE_PA: "$$$ USER_COMMAND: COMM_UPDATE_PARAMS (%d,%d)"
// [HELPER] s_____USER_COMMAND__COMM_UPDATE_PL: "$$$ USER_COMMAND: COMM_UPDATE_PLAYERS (%d,%d)"
// [HELPER] s_____USER_COMMAND__UNKNOWN___d___: "$$$ USER_COMMAND: UNKNOWN (%d, %d)"
/* public: virtual long __thiscall TribeMPSetupScreen::handle_user_command(unsigned int,long) */

long __thiscall
TribeMPSetupScreen::handle_user_command(TribeMPSetupScreen *this,uint param_1,long param_2)
{
  uint uVar1;
  TDebuggingLog *this_00;
  byte bVar2;
  uchar uVar3;
  int iVar4;
  uint uVar5;
  ulong uVar6;
  byte *pbVar7;
  uint uVar8;
  char *pcVar9;
  char *pcVar10;
  TDebuggingLog *this_01;
  TDebuggingLog *this_02;
  TDebuggingLog *this_03;
  uint uVar11;
  int iVar12;
  bool bVar13;
  ulong uVar14;
  ulong uVar15;
  ulong uVar16;
  long *local_128;
  ulong user5;
  ulong user4;
  ulong user1;
  ulong user3;
  ulong user7;
  ulong user2;
  ulong user6;
  int ready;
  char message [256];
  
  iVar4 = RGE_Base_Game::singlePlayerGame(rge_base_game);
  if (iVar4 != 0) {
    return 1;
  }
  this_00 = (TDebuggingLog *)(param_1 - 0x17a4);
  switch(param_1) {
  case 0x17a4:
    TDebuggingLog::Log(this_00,(char *)L,s_____USER_COMMAND__COMM_UPDATE_PL,param_1,param_2);
    bVar13 = false;
    iVar4 = TCommunications_Handler::IsHost(comm);
    if ((iVar4 != 0) && (this->sent_cd_status == 0)) {
      this->sent_cd_status = 1;
      iVar4 = RGE_Base_Game::check_for_cd(rge_base_game,0);
      if (iVar4 != 0) {
        iVar12 = 1;
        bVar13 = true;
        iVar4 = TCommunications_Handler::WhoAmI(comm);
        RGE_Base_Game::setPlayerHasCD(rge_base_game,iVar4 + -1,iVar12);
      }
    }
    iVar4 = TCommunications_Handler::IsHost(comm);
    if (iVar4 != 0) {
      local_128 = this->scenarioCheckSum;
      uVar8 = 0;
      do {
        uVar1 = uVar8 + 1;
        iVar4 = TCommunications_Handler::GetPlayerHumanity(comm,uVar1);
        uVar5 = TCommunications_Handler::WhoAmI(comm);
        if (uVar5 == uVar1) {
          if (iVar4 != 2) goto LAB_004a30af;
        }
        else if (iVar4 == 2) {
          TCommunications_Handler::GetClientReadiness
                    (comm,uVar1,(int *)message,&user3,&user6,&user7,&user1,&user4,(ulong *)&ready,
                     &user2);
          if ((user3 != 0) &&
             (uVar6 = TRIBE_Game::civilization((TRIBE_Game *)rge_base_game,uVar8), user3 != uVar6))
{
            TRIBE_Game::setCivilization((TRIBE_Game *)rge_base_game,uVar8,user3);
            bVar13 = true;
          }
          if (user6 != 0) {
            iVar4 = user6 - 1;
            iVar12 = TRIBE_Game::scenarioPlayer((TRIBE_Game *)rge_base_game,uVar8);
            if (iVar4 != iVar12) {
              TRIBE_Game::setScenarioPlayer((TRIBE_Game *)rge_base_game,uVar8,iVar4);
              bVar13 = true;
            }
          }
          if (user7 != 0) {
            if (user7 == 1) {
              iVar4 = RGE_Base_Game::playerHasCD(rge_base_game,uVar8);
              if (iVar4 == 1) {
                iVar4 = 0;
LAB_004a3014:
                RGE_Base_Game::setPlayerHasCD(rge_base_game,uVar8,iVar4);
                bVar13 = true;
              }
            }
            else if ((user7 == 2) &&
                    (iVar4 = RGE_Base_Game::playerHasCD(rge_base_game,uVar8), iVar4 == 0)) {
              iVar4 = 1;
              goto LAB_004a3014;
            }
          }
          if ((user1 != 0) &&
             (uVar6 = TRIBE_Game::playerColor((TRIBE_Game *)rge_base_game,uVar8), user1 != uVar6)) {
            TRIBE_Game::setPlayerColor((TRIBE_Game *)rge_base_game,uVar8,user1);
            bVar13 = true;
          }
          if ((user4 != 0) &&
             (uVar6 = RGE_Base_Game::playerTeam(rge_base_game,uVar8), user4 != uVar6)) {
            RGE_Base_Game::setPlayerTeam(rge_base_game,uVar8,user4);
            bVar13 = true;
          }
          if (ready != 0) {
            *local_128 = ready;
          }
          if (user2 != 0) {
            RGE_Base_Game::setPlayerVersion(rge_base_game,uVar8,(uchar)user2);
            bVar13 = true;
          }
        }
        else {
LAB_004a30af:
          if (iVar4 != 4) {
            uVar5 = debug_rand(s_C__msdev_work_age1_x1_scr_mps_cp,0x6d6);
            uVar11 = (int)uVar5 >> 0x1f;
            iVar12 = (((uVar5 ^ uVar11) - uVar11 & 0xf ^ uVar11) - uVar11) + 1;
            iVar4 = TRIBE_Game::civilization((TRIBE_Game *)rge_base_game,uVar8);
            if (iVar4 != iVar12) {
              TRIBE_Game::setCivilization((TRIBE_Game *)rge_base_game,uVar8,iVar12);
              bVar13 = true;
            }
            uVar5 = TRIBE_Game::scenarioPlayer((TRIBE_Game *)rge_base_game,uVar8);
            if (uVar5 != uVar8) {
              TRIBE_Game::setScenarioPlayer((TRIBE_Game *)rge_base_game,uVar8,uVar8);
              bVar13 = true;
            }
            iVar4 = RGE_Base_Game::playerHasCD(rge_base_game,uVar8);
            if (iVar4 != 0) {
              RGE_Base_Game::setPlayerHasCD(rge_base_game,uVar8,0);
              bVar13 = true;
            }
            bVar2 = this->defaultColor[uVar8];
            uVar5 = TRIBE_Game::playerColor((TRIBE_Game *)rge_base_game,uVar8);
            if (uVar5 != bVar2) {
              TRIBE_Game::setPlayerColor((TRIBE_Game *)rge_base_game,uVar8,(uint)bVar2);
              bVar13 = true;
            }
            iVar4 = RGE_Base_Game::playerTeam(rge_base_game,uVar8);
            if (iVar4 != 1) {
              RGE_Base_Game::setPlayerTeam(rge_base_game,uVar8,1);
              bVar13 = true;
            }
            uVar3 = RGE_Base_Game::playerVersion(rge_base_game,uVar8);
            if (uVar3 != '\0') {
              RGE_Base_Game::setPlayerVersion(rge_base_game,uVar8,'\0');
              bVar13 = true;
            }
            *local_128 = 0;
          }
        }
        local_128 = local_128 + 1;
        uVar8 = uVar1;
      } while ((int)uVar1 < 8);
      if (bVar13) {
        (**(code **)(rge_base_game->_padding_ + 0x48))();
        this->resend_game_options = 0;
      }
    }
    fillPlayers(this);
    (**(code **)(this->_padding_ + 0x20))(1);
    return 1;
  default:
    TDebuggingLog::Log((TDebuggingLog *)param_2,(char *)L,s_____USER_COMMAND__UNKNOWN___d___,param_1
                       ,param_2);
    return 1;
  case 0x17a6:
    TDebuggingLog::Log((TDebuggingLog *)param_2,(char *)L,s_____USER_COMMAND__COMM_UPDATE_PA,param_1
                       ,param_2);
    (**(code **)(rge_base_game->_padding_ + 0x4c))();
    iVar12 = 0;
    iVar4 = RGE_Base_Game::numberPlayers(rge_base_game);
    if (0 < iVar4) {
      do {
        iVar4 = TRIBE_Game::civilization((TRIBE_Game *)rge_base_game,iVar12);
        if (0x31 < iVar4) {
          TDebuggingLog::Log(L,(char *)L,s_____CIV2>50);
          iVar4 = TRIBE_Game::civilization((TRIBE_Game *)rge_base_game,iVar12);
          TRIBE_Game::setCivilization((TRIBE_Game *)rge_base_game,iVar12,iVar4 + -0x32);
          iVar4 = TCommunications_Handler::WhoAmI(comm);
          if (iVar12 + 1 == iVar4) {
            this->myCivilization = 0;
            TDebuggingLog::Log(this_02,(char *)L,s_____RESETTING_MYCIV2);
          }
        }
        iVar4 = RGE_Base_Game::playerTeam(rge_base_game,iVar12);
        if (0x31 < iVar4) {
          TDebuggingLog::Log(L,(char *)L,s_____TEAM2>50);
          iVar4 = RGE_Base_Game::playerTeam(rge_base_game,iVar12);
          RGE_Base_Game::setPlayerTeam(rge_base_game,iVar12,iVar4 + -0x32);
          iVar4 = TCommunications_Handler::WhoAmI(comm);
          if (iVar12 + 1 == iVar4) {
            this->myPlayerTeam = 0;
            TDebuggingLog::Log(this_03,(char *)L,s_____RESETTING_MYTEAM2);
          }
        }
        iVar12 = iVar12 + 1;
        iVar4 = RGE_Base_Game::numberPlayers(rge_base_game);
      } while (iVar12 < iVar4);
    }
    if (this->myScenarioPlayer != 0) {
      pbVar7 = (byte *)RGE_Base_Game::scenarioName(rge_base_game);
      pcVar9 = this->saveScenarioName;
      do {
        bVar2 = *pcVar9;
        bVar13 = bVar2 < *pbVar7;
        if (bVar2 != *pbVar7) {
LAB_004a33a9:
          iVar4 = (1 - (uint)bVar13) - (uint)(bVar13 != 0);
          goto LAB_004a33ae;
        }
        if (bVar2 == 0) break;
        bVar2 = pcVar9[1];
        bVar13 = bVar2 < pbVar7[1];
        if (bVar2 != pbVar7[1]) goto LAB_004a33a9;
        pcVar9 = pcVar9 + 2;
        pbVar7 = pbVar7 + 2;
      } while (bVar2 != 0);
      iVar4 = 0;
LAB_004a33ae:
      if (iVar4 != 0) {
        this->myScenarioPlayer = -1;
      }
    }
    updateSummary(this);
    iVar4 = TCommunications_Handler::IsHost(comm);
    if (iVar4 == 0) {
      if ((this->sent_cd_status != 0) && (this->myScenarioChecksum == this->saveScenarioChecksum)) {
        uVar8 = TCommunications_Handler::WhoAmI(comm);
        iVar4 = TCommunications_Handler::IsPlayerReady(comm,uVar8);
        if (iVar4 == this->i_am_ready) {
          return 1;
        }
      }
      uVar6 = this->myScenarioChecksum;
      uVar16 = 1;
      uVar15 = 0;
      this->sent_cd_status = 1;
      this->saveScenarioChecksum = uVar6;
      uVar14 = 0;
      iVar4 = RGE_Base_Game::check_for_cd(rge_base_game,0);
      TCommunications_Handler::SetMyReadiness
                (comm,this->i_am_ready,0,0,iVar4 + 1,uVar14,uVar15,uVar6,uVar16);
      return 1;
    }
    break;
  case 0x17a7:
    TDebuggingLog::Log(this_00,(char *)L,s_____USER_COMMAND__COMM_LAUNCH_GA,param_1,param_2);
    TChat::setWindowHandle(chat,AppWnd);
    TCommunications_Handler::SetWindowHandle(comm,AppWnd);
    TRIBE_Game::start_game((TRIBE_Game *)rge_base_game,0);
    return 1;
  case 0x17a8:
    pcVar9 = s_____USER_COMMAND__COMM_CANCEL_GA;
    goto LAB_004a34da;
  case 0x17a9:
    pcVar9 = s_____USER_COMMAND__COMM_HOST_EXIT;
LAB_004a34da:
    TDebuggingLog::Log((TDebuggingLog *)param_2,(char *)L,pcVar9,param_1,param_2);
    handleKickedPlayer(this,0);
    return 1;
  case 0x17aa:
    TDebuggingLog::Log((TDebuggingLog *)param_2,(char *)L,s_____USER_COMMAND__COMM_PLAYER_KI,param_1
                       ,param_2);
    handleKickedPlayer(this,1);
    return 1;
  case 0x17ae:
    TDebuggingLog::Log((TDebuggingLog *)param_2,(char *)L,s_____USER_COMMAND__COMM_NO_LINK__,param_1
                       ,param_2);
    cancelScreen(this,0);
    return 1;
  case 0x17b2:
    TDebuggingLog::Log((TDebuggingLog *)param_2,(char *)L,s_____USER_COMMAND__COMM_PLAYER_DR,param_1
                       ,param_2);
    handleKickedPlayer(this,1);
    return 1;
  case 0x17b3:
    TDebuggingLog::Log((TDebuggingLog *)param_2,(char *)L,s_____USER_COMMAND__COMM_OTHER_PLA,param_1
                       ,param_2);
    fillPlayers(this);
    return 1;
  case 0x17b6:
    TDebuggingLog::Log(this_00,(char *)L,s_____USER_COMMAND__COMM_BAD_VERSI,param_1,param_2);
    pcVar9 = TCommunications_Handler::GetPlayerName(comm,param_2);
                    /* language.dll match for 0x25dd: "%s is running the wrong version of the game."
                        */
    pcVar10 = TPanel::get_string((TPanel *)this,0x25dd);
    sprintf(message + 4,pcVar10,pcVar9);
    TEasy_Panel::popupOKDialog((TEasy_Panel *)this,message + 4,(char *)0x0,0x1c2,100);
    return 1;
  case 0x17b7:
    TDebuggingLog::Log(this_00,(char *)L,s_____USER_COMMAND__COMM_PLAYER_SE,param_1,param_2);
    pcVar9 = TCommunications_Handler::GetPlayerName(comm,param_2);
                    /* language.dll match for 0x25de: "%s is using the wrong connection type." */
    pcVar10 = TPanel::get_string((TPanel *)this,0x25de);
    sprintf(message + 4,pcVar10,pcVar9);
    TEasy_Panel::popupOKDialog((TEasy_Panel *)this,message + 4,(char *)0x0,0x1c2,100);
    return 1;
  case 0x17b9:
    TDebuggingLog::Log((TDebuggingLog *)param_2,(char *)L,s_____USER_COMMAND__COMM_HOST_BUSY,param_1
                       ,param_2);
    iVar4 = TCommunications_Handler::IsLobbyLaunched(comm);
    if (iVar4 != 0) {
      cancelScreen(this,1);
      return 1;
    }
    handleKickedPlayer(this,0);
    break;
  case 0x17bb:
    TDebuggingLog::Log((TDebuggingLog *)param_2,(char *)L,s_____USER_COMMAND__COMM_SHARED_DA,param_1
                       ,param_2);
    iVar4 = TCommunications_Handler::IsHost(comm);
    if (iVar4 != 0) {
      iVar12 = 0;
      iVar4 = RGE_Base_Game::numberPlayers(rge_base_game);
      if (0 < iVar4) {
        do {
          iVar4 = TRIBE_Game::civilization((TRIBE_Game *)rge_base_game,iVar12);
          if (0x31 < iVar4) {
            TDebuggingLog::Log(this_01,(char *)L,s_____HOST_RESET_CIV_50);
            iVar4 = TRIBE_Game::civilization((TRIBE_Game *)rge_base_game,iVar12);
            TRIBE_Game::setCivilization((TRIBE_Game *)rge_base_game,iVar12,iVar4 + -0x32);
            this->resend_game_options = 1;
          }
          iVar4 = RGE_Base_Game::playerTeam(rge_base_game,iVar12);
          if (0x31 < iVar4) {
            TDebuggingLog::Log(L,(char *)L,s_____HOST_RESET_TEAM_50);
            iVar4 = RGE_Base_Game::playerTeam(rge_base_game,iVar12);
            RGE_Base_Game::setPlayerTeam(rge_base_game,iVar12,iVar4 + -0x32);
            this->resend_game_options = 1;
          }
          iVar12 = iVar12 + 1;
          iVar4 = RGE_Base_Game::numberPlayers(rge_base_game);
        } while (iVar12 < iVar4);
        return 1;
      }
    }
    break;
  case 0x17d5:
    TDebuggingLog::Log(this_00,(char *)L,s_____USER_COMMAND__CHAT_RECEIVED_,param_1,param_2);
    fillChat(this,param_2);
    return 1;
  }
  return 1;
}

// --------------------------------------------------

// Function: handle_timer_command
// Address: 004a37c0
/* public: virtual long __thiscall TribeMPSetupScreen::handle_timer_command(unsigned int,long) */

long __thiscall
TribeMPSetupScreen::handle_timer_command(TribeMPSetupScreen *this,uint param_1,long param_2)
{
  return 1;
}

// --------------------------------------------------

// Function: fillPlayers
// Address: 004a37d0
// [HELPER] s_____SETTING_CIV_TEAM_50___d__d_: "$$$ SETTING CIV/TEAM+50 (%d,%d)"
/* WARNING: Variable defined which should be unmapped: humanity */
/* public: void __thiscall TribeMPSetupScreen::fillPlayers(void) */

void __thiscall TribeMPSetupScreen::fillPlayers(TribeMPSetupScreen *this)
{
  uint uVar1;
  uchar uVar2;
  int iVar3;
  int iVar4;
  char *pcVar5;
  char *pcVar6;
  long lVar7;
  char *pcVar8;
  TDropDownPanel *pTVar9;
  undefined2 extraout_var;
  undefined2 extraout_var_00;
  undefined2 extraout_var_01;
  undefined2 uVar10;
  long unaff_EBX;
  uint uVar11;
  ulong uVar12;
  TDropDownPanel **ppTVar13;
  uint uVar14;
  bool bVar15;
  undefined4 uVar16;
  long humanity;
  char *text1;
  ulong color2;
  ulong color1;
  char *text2;
  
  humanity = unaff_EBX;
  iVar3 = RGE_Base_Game::multiplayerGame(rge_base_game);
  if ((iVar3 != 0) && (iVar3 = TCommunications_Handler::IsHost(comm), iVar3 != 0)) {
    uVar11 = 0;
    color2 = 0;
    iVar3 = RGE_Base_Game::numberPlayers(rge_base_game);
    if (0 < iVar3) {
      text1 = (char *)this->playerNameText;
      do {
        uVar1 = uVar11 + 1;
        color1 = uVar1;
        iVar3 = TCommunications_Handler::IsPlayerReady(comm,uVar1);
        if ((iVar3 != 0) && (*(int *)(*(int *)text1 + 0x120) == 0xff)) {
          uVar14 = 0;
          iVar3 = RGE_Base_Game::numberPlayers(rge_base_game);
          if (0 < iVar3) {
            do {
              if ((uVar11 != uVar14) &&
                 (iVar3 = TCommunications_Handler::IsPlayerReady(comm,uVar14 + 1), iVar3 != 0)) {
                iVar3 = TRIBE_Game::playerColor((TRIBE_Game *)rge_base_game,uVar14);
                iVar4 = TRIBE_Game::playerColor((TRIBE_Game *)rge_base_game,uVar11);
                if (iVar3 == iVar4) {
                  TDebuggingLog::Log(L,(char *)L,s_____SETTING_CIV_TEAM_50___d__d_,uVar11);
                  iVar3 = TRIBE_Game::civilization((TRIBE_Game *)rge_base_game,uVar11);
                  TRIBE_Game::setCivilization((TRIBE_Game *)rge_base_game,uVar14,iVar3 + 0x32);
                  iVar3 = RGE_Base_Game::playerTeam(rge_base_game,uVar11);
                  RGE_Base_Game::setPlayerTeam(rge_base_game,uVar14,iVar3 + 0x32);
                  color2 = 1;
                }
              }
              uVar14 = uVar14 + 1;
              iVar3 = RGE_Base_Game::numberPlayers(rge_base_game);
              uVar1 = color1;
            } while ((int)uVar14 < iVar3);
          }
        }
        uVar11 = uVar1;
        text1 = text1 + 4;
        iVar3 = RGE_Base_Game::numberPlayers(rge_base_game);
      } while ((int)uVar11 < iVar3);
    }
    if (color2 != 0) {
      (**(code **)(rge_base_game->_padding_ + 0x48))();
    }
  }
  iVar4 = 0;
  iVar3 = RGE_Base_Game::numberPlayers(rge_base_game);
  if (0 < iVar3) {
    do {
      iVar3 = RGE_Base_Game::multiplayerGame(rge_base_game);
      if (iVar3 == 0) {
        if (iVar4 == 0) {
          text1 = (char *)0x2;
          bVar15 = true;
        }
        else {
          text1 = (char *)TDropDownPanel::get_id(this->playerNameDrop[iVar4]);
          bVar15 = false;
        }
      }
      else {
        text1 = (char *)TCommunications_Handler::GetPlayerHumanity(comm,iVar4 + 1U);
        uVar11 = TCommunications_Handler::WhoAmI(comm);
        bVar15 = uVar11 == iVar4 + 1U;
      }
      iVar3 = RGE_Base_Game::multiplayerGame(rge_base_game);
      if ((iVar3 == 0) || (text1 != (char *)0x2)) {
        pcVar5 = (char *)0x0;
        (**(code **)(this->playerCDText[iVar4]->_padding_ + 0x14))();
        uVar16 = 0;
        iVar3 = this->playerVersionText[iVar4]->_padding_;
LAB_004a3ae8:
        (**(code **)(iVar3 + 0x14))(uVar16);
      }
      else {
        iVar3 = this->playerCDText[iVar4]->_padding_;
        pcVar5 = (char *)RGE_Base_Game::playerHasCD(rge_base_game,iVar4);
        (**(code **)(iVar3 + 0x14))();
        iVar3 = TCommunications_Handler::IsHost(comm);
        if ((iVar3 != 0) || (uVar2 = RGE_Base_Game::playerVersion(rge_base_game,0), uVar2 != '\0'))
{
          iVar3 = this->playerVersionText[iVar4]->_padding_;
          pcVar6 = RGE_Base_Game::playerVersionString(rge_base_game,iVar4);
          (**(code **)(iVar3 + 0xe8))(pcVar6);
          uVar16 = 1;
          iVar3 = this->playerVersionText[iVar4]->_padding_;
          goto LAB_004a3ae8;
        }
        if (iVar4 == 0) {
          iVar3 = this->playerVersionText[0]->_padding_;
          pcVar6 = RGE_Base_Game::playerVersionString(rge_base_game,0);
          (**(code **)(iVar3 + 0xe8))(pcVar6);
          uVar16 = 1;
          iVar3 = this->playerVersionText[0]->_padding_;
          goto LAB_004a3ae8;
        }
        if (bVar15) {
          RGE_Base_Game::setPlayerVersion(rge_base_game,iVar4,'\x01');
          iVar3 = this->playerVersionText[iVar4]->_padding_;
          pcVar6 = RGE_Base_Game::playerVersionString(rge_base_game,iVar4);
          (**(code **)(iVar3 + 0xe8))(pcVar6);
          uVar16 = 1;
          iVar3 = this->playerVersionText[iVar4]->_padding_;
          goto LAB_004a3ae8;
        }
        (**(code **)(this->playerVersionText[iVar4]->_padding_ + 0x14))(0);
      }
      if ((!bVar15) || (iVar3 = this->myPlayerColor, iVar3 == 0)) {
        iVar3 = TRIBE_Game::playerColor((TRIBE_Game *)rge_base_game,iVar4);
      }
      TButtonPanel::set_state_by_id(this->playerColor[iVar4],iVar3);
      iVar3 = TButtonPanel::get_state(this->playerColor[iVar4]);
      TButtonPanel::get_text
                (this->playerColor[iVar4],(short)iVar3,(char **)&humanity,(char **)&color1);
      TButtonPanel::get_text_color(this->playerColor[iVar4],(short)iVar3,&color2,(ulong *)&text1);
      (**(code **)(this->playerColorText[iVar4]->_padding_ + 0xe8))(humanity);
      TTextPanel::set_text_color(this->playerColorText[iVar4],(ulong)text1,humanity);
      (**(code **)(this->playerColor[iVar4]->_padding_ + 0x14))(0);
      pcVar6 = (char *)0x0;
      (**(code **)(this->playerColorText[iVar4]->_padding_ + 0x14))();
      iVar3 = RGE_Base_Game::multiplayerGame(rge_base_game);
      if ((((iVar3 != 0) && (bVar15)) && (this->i_am_ready == 0)) ||
         (((iVar3 = RGE_Base_Game::singlePlayerGame(rge_base_game), iVar3 != 0 && (bVar15)) &&
          (1 < this->numberAnyPlayers)))) {
        (**(code **)(this->playerColor[iVar4]->_padding_ + 0x14))(1);
        TButtonPanel::set_disabled(this->playerColor[iVar4],0);
        uVar10 = extraout_var_00;
        pcVar8 = pcVar5;
      }
      else {
        uVar10 = extraout_var;
        pcVar8 = pcVar5;
        if (pcVar5 == (char *)0x2) {
          (**(code **)(this->playerColorText[iVar4]->_padding_ + 0x14))(1);
          uVar10 = extraout_var_01;
        }
      }
      if ((bVar15) && (this->myPlayerTeam != 0)) {
        (**(code **)(this->playerTeam[iVar4]->_padding_ + 0xe0))
                  (CONCAT22(uVar10,(short)this->myPlayerTeam + -1));
      }
      else {
        iVar3 = RGE_Base_Game::playerTeam(rge_base_game,iVar4);
        if (0x31 < iVar3) {
          iVar3 = iVar3 + -0x32;
        }
        (**(code **)(this->playerTeam[iVar4]->_padding_ + 0xe0))(iVar3 + -1);
      }
      iVar3 = TButtonPanel::get_state(this->playerTeam[iVar4]);
      TButtonPanel::get_text
                (this->playerTeam[iVar4],(short)iVar3,(char **)&stack0xffffffd8,
                 (char **)&stack0xffffffe4);
      (**(code **)(this->playerTeamText[iVar4]->_padding_ + 0xe8))(pcVar8);
      (**(code **)(this->playerTeam[iVar4]->_padding_ + 0x14))(0);
      (**(code **)(this->playerTeamText[iVar4]->_padding_ + 0x14))(0);
      iVar3 = RGE_Base_Game::multiplayerGame(rge_base_game);
      if (((iVar3 != 0) &&
          (((bVar15 && (this->i_am_ready == 0)) ||
           ((iVar3 = TCommunications_Handler::IsHost(comm), iVar3 != 0 &&
            ((pcVar5 == (char *)0x4 && (this->i_am_ready == 0)))))))) ||
         ((iVar3 = RGE_Base_Game::singlePlayerGame(rge_base_game), iVar3 != 0 &&
          ((bVar15 || (pcVar5 == (char *)0x4)))))) {
        (**(code **)(this->playerTeam[iVar4]->_padding_ + 0x14))(1);
        TButtonPanel::set_disabled(this->playerTeam[iVar4],0);
      }
      else if ((pcVar5 == (char *)0x2) || (pcVar5 == (char *)0x4)) {
        (**(code **)(this->playerTeamText[iVar4]->_padding_ + 0x14))(1);
      }
      iVar3 = RGE_Base_Game::multiplayerGame(rge_base_game);
      if (iVar3 != 0) {
        if (pcVar5 == (char *)0x2) {
          iVar3 = TCommunications_Handler::IsPlayerReady(comm,iVar4 + 1);
          uVar12 = 0xff;
          pcVar5 = pcVar6;
          if (iVar3 != 0) goto LAB_004a3d5e;
        }
        else {
LAB_004a3d5e:
          uVar12 = 0xff00;
          pcVar5 = pcVar6;
        }
        TDropDownPanel::set_val_text_color(this->playerNameDrop[iVar4],uVar12,0);
        TTextPanel::set_text_color(this->playerNameText[iVar4],uVar12,0);
      }
      iVar3 = RGE_Base_Game::multiplayerGame(rge_base_game);
      if (iVar3 == 0) {
        if (!bVar15) {
          iVar3 = this->playerNameText[iVar4]->_padding_;
          goto LAB_004a3e1b;
        }
                    /* language.dll match for 0x25b3: "You" */
        (**(code **)(this->playerNameText[iVar4]->_padding_ + 0xe4))(0x25b3);
      }
      else {
        lVar7 = TDropDownPanel::get_id(this->playerNameDrop[iVar4],0);
        if (lVar7 == 2) {
          TDropDownPanel::delete_line(this->playerNameDrop[iVar4],0);
        }
        if (pcVar5 == (char *)0x2) {
          pcVar6 = pcVar5;
          pcVar8 = TCommunications_Handler::GetPlayerName(comm,iVar4 + 1);
          TDropDownPanel::insert_line(this->playerNameDrop[iVar4],0,pcVar8,(long)pcVar6);
        }
        lVar7 = TDropDownPanel::get_line(this->playerNameDrop[iVar4],(long)pcVar5);
        TDropDownPanel::set_line(this->playerNameDrop[iVar4],lVar7);
        iVar3 = this->playerNameText[iVar4]->_padding_;
LAB_004a3e1b:
        pcVar5 = TDropDownPanel::get_text(this->playerNameDrop[iVar4]);
        (**(code **)(iVar3 + 0xe8))(pcVar5);
      }
      pTVar9 = this->playerCivDrop[iVar4];
      if (pTVar9->mode != ModeList) {
        if ((!bVar15) || (iVar3 = this->myCivilization, iVar3 == 0)) {
          iVar3 = TRIBE_Game::civilization((TRIBE_Game *)rge_base_game,iVar4);
          if (0x31 < iVar3) {
            iVar3 = iVar3 + -0x32;
          }
          pTVar9 = this->playerCivDrop[iVar4];
        }
        lVar7 = TDropDownPanel::get_line(pTVar9,iVar3);
        TDropDownPanel::set_line(this->playerCivDrop[iVar4],lVar7);
      }
      iVar3 = this->playerCivText[iVar4]->_padding_;
      pcVar5 = TDropDownPanel::get_text(this->playerCivDrop[iVar4]);
      (**(code **)(iVar3 + 0xe8))(pcVar5);
      pTVar9 = this->scenarioPlayerDrop[iVar4];
      if (pTVar9->mode != ModeList) {
        if ((!bVar15) || (iVar3 = this->myScenarioPlayer, iVar3 == -1)) {
          iVar3 = TRIBE_Game::scenarioPlayer((TRIBE_Game *)rge_base_game,iVar4);
          pTVar9 = this->scenarioPlayerDrop[iVar4];
        }
        lVar7 = TDropDownPanel::get_line(pTVar9,iVar3);
        TDropDownPanel::set_line(this->scenarioPlayerDrop[iVar4],lVar7);
      }
      iVar3 = this->scenarioPlayerText[iVar4]->_padding_;
      pcVar5 = TDropDownPanel::get_text(this->scenarioPlayerDrop[iVar4]);
      (**(code **)(iVar3 + 0xe8))();
      iVar3 = RGE_Base_Game::multiplayerGame(rge_base_game);
      if (((iVar3 == 0) || (iVar3 = TCommunications_Handler::IsHost(comm), iVar3 == 0)) || (bVar15))
{
        (**(code **)(this->playerNameDrop[iVar4]->_padding_ + 0x14))(0);
        uVar16 = 1;
        iVar3 = this->playerNameText[iVar4]->_padding_;
      }
      else {
        (**(code **)(this->playerNameDrop[iVar4]->_padding_ + 0x14))(1);
        iVar3 = this->playerNameText[iVar4]->_padding_;
        uVar16 = 0;
      }
      (**(code **)(iVar3 + 0x14))(uVar16);
      (**(code **)(this->playerCivDrop[iVar4]->_padding_ + 0x14))(0);
      (**(code **)(this->playerCivText[iVar4]->_padding_ + 0x14))(0);
      iVar3 = RGE_Base_Game::multiplayerGame(rge_base_game);
      if (((iVar3 != 0) &&
          (((bVar15 && (this->i_am_ready == 0)) ||
           ((iVar3 = TCommunications_Handler::IsHost(comm), iVar3 != 0 &&
            ((pcVar5 == (char *)0x4 && (this->i_am_ready == 0)))))))) ||
         ((iVar3 = RGE_Base_Game::singlePlayerGame(rge_base_game), iVar3 != 0 &&
          ((bVar15 || (pcVar5 == (char *)0x4)))))) {
        (**(code **)(this->playerCivDrop[iVar4]->_padding_ + 0x14))(1);
      }
      else if ((pcVar5 == (char *)0x2) || (pcVar5 == (char *)0x4)) {
        (**(code **)(this->playerCivText[iVar4]->_padding_ + 0x14))(1);
      }
      (**(code **)(this->scenarioPlayerDrop[iVar4]->_padding_ + 0x14))(0);
      (**(code **)(this->scenarioPlayerText[iVar4]->_padding_ + 0x14))(0);
      iVar4 = iVar4 + 1;
      iVar3 = RGE_Base_Game::numberPlayers(rge_base_game);
    } while (iVar4 < iVar3);
  }
  if (iVar4 < 8) {
    ppTVar13 = this->playerCivDrop + iVar4;
    iVar4 = 8 - iVar4;
    do {
      (**(code **)(ppTVar13[-8]->_padding_ + 0x14))();
      (**(code **)((*ppTVar13)->_padding_ + 0x14))(0);
      (**(code **)(ppTVar13[8]->_padding_ + 0x14))(0);
      (**(code **)(((TButtonPanel *)ppTVar13[-0x18])->_padding_ + 0x14))(0);
      (**(code **)(((TTextPanel *)ppTVar13[-0x28])->_padding_ + 0x14))(0);
      (**(code **)(((TButtonPanel *)ppTVar13[-0x10])->_padding_ + 0x14))(0);
      (**(code **)(((TTextPanel *)ppTVar13[-0x20])->_padding_ + 0x14))(0);
      (**(code **)(((TTextPanel *)ppTVar13[-0x50])->_padding_ + 0x14))(0);
      (**(code **)(((TTextPanel *)ppTVar13[-0x48])->_padding_ + 0x14))(0);
      (**(code **)(((TTextPanel *)ppTVar13[-0x40])->_padding_ + 0x14))(0);
      (**(code **)(((TTextPanel *)ppTVar13[-0x38])->_padding_ + 0x14))(0);
      (**(code **)(((TTextPanel *)ppTVar13[-0x30])->_padding_ + 0x14))(0);
      ppTVar13 = ppTVar13 + 1;
      iVar4 = iVar4 + -1;
    } while (iVar4 != 0);
  }
  fillPlayerColors(this);
  return;
}

// --------------------------------------------------

// Function: fillChat
// Address: 004a4100
/* protected: void __thiscall TribeMPSetupScreen::fillChat(int) */

void __thiscall TribeMPSetupScreen::fillChat(TribeMPSetupScreen *this,int param_1)
{
  bool bVar1;
  int iVar2;
  char *pcVar3;
  
  iVar2 = RGE_Base_Game::singlePlayerGame(rge_base_game);
  if (iVar2 == 0) {
    iVar2 = TTextPanel::numberLines(this->chatBox);
    if ((iVar2 < 1) || ((int)this->chatBox->bot_line != iVar2 + -1)) {
      bVar1 = false;
    }
    else {
      bVar1 = true;
    }
    if (99 < iVar2) {
      TTextPanel::delete_line(this->chatBox,0);
    }
    pcVar3 = TChat::GetChatMsg(chat,param_1);
    TTextPanel::word_wrap_append(this->chatBox,pcVar3);
    if (bVar1) {
      TTextPanel::scroll(this->chatBox,'\a',0,1);
    }
  }
  return;
}

// --------------------------------------------------

// Function: updateSummary
// Address: 004a4190
/* public: void __thiscall TribeMPSetupScreen::updateSummary(void) */

void __thiscall TribeMPSetupScreen::updateSummary(TribeMPSetupScreen *this)
{
  char cVar1;
  bool bVar2;
  uchar uVar3;
  byte bVar4;
  int iVar5;
  byte *pbVar6;
  int iVar7;
  T_Scenario *pTVar8;
  long lVar9;
  MapSize MVar10;
  MapType MVar11;
  VictoryType VVar12;
  Age AVar13;
  ResourceLevel RVar14;
  uint uVar15;
  uint uVar16;
  char *pcVar17;
  TDropDownPanel **ppTVar18;
  TTextPanel **ppTVar19;
  long *plVar20;
  char *pcVar21;
  bool bVar22;
  undefined4 uVar23;
  undefined1 *puVar24;
  int iVar25;
  char str1 [256];
  char str2 [256];
  char file_name [260];
  char str3 [256];
  _finddata_t file_info_fffffee4;
  
  bVar2 = false;
  iVar5 = RGE_Base_Game::scenarioGame(rge_base_game);
  iVar7 = this->saveRandomGame;
  if (iVar5 == 0) {
joined_r0x004a41fd:
    if (iVar7 == 0) goto LAB_004a41ff;
  }
  else {
    if (iVar7 == 0) {
      pcVar17 = this->saveScenarioName;
      pbVar6 = (byte *)RGE_Base_Game::scenarioName(rge_base_game);
      do {
        bVar4 = *pbVar6;
        bVar22 = bVar4 < (byte)*pcVar17;
        if (bVar4 != *pcVar17) {
LAB_004a41f0:
          iVar7 = (1 - (uint)bVar22) - (uint)(bVar22 != 0);
          goto joined_r0x004a41fd;
        }
        if (bVar4 == 0) break;
        bVar4 = pbVar6[1];
        bVar22 = bVar4 < (byte)pcVar17[1];
        if (bVar4 != pcVar17[1]) goto LAB_004a41f0;
        pbVar6 = pbVar6 + 2;
        pcVar17 = pcVar17 + 2;
      } while (bVar4 != 0);
      iVar7 = 0;
      goto joined_r0x004a41fd;
    }
LAB_004a41ff:
    bVar2 = true;
  }
  if (bVar2) {
    iVar7 = RGE_Base_Game::scenarioGame(rge_base_game);
    if (iVar7 != 0) {
      iVar7 = 0;
      if (this->scenarioInfo != (T_Scenario *)0x0) {
        (**(code **)(this->scenarioInfo->_padding_ + 4))();
        this->scenarioInfo = (T_Scenario *)0x0;
      }
      RGE_Base_Game::scenarioName(rge_base_game);
      sprintf();
      iVar5 = __findfirst();
      if (iVar5 == -1) {
        RGE_Base_Game::scenarioName(rge_base_game);
      }
      else {
        RGE_Base_Game::scenarioName(rge_base_game);
      }
      sprintf();
      if (str1[4] != '.') {
        pTVar8 = (T_Scenario *)RGE_Base_Game::get_scenario_info(rge_base_game,str1 + 4,0);
        this->scenarioInfo = pTVar8;
      }
      if (this->scenarioInfo == (T_Scenario *)0x0) {
        RGE_Base_Game::setScenarioGame(rge_base_game,0);
      }
      else {
        ppTVar18 = this->scenarioPlayerDrop;
        iVar5 = 8;
        do {
          TDropDownPanel::empty_list(*ppTVar18);
          ppTVar18 = ppTVar18 + 1;
          iVar5 = iVar5 + -1;
        } while (iVar5 != 0);
        iVar5 = T_Scenario::any_sp_victory(this->scenarioInfo);
        this->settingsFixed = iVar5;
        this->numberAnyPlayers = 0;
        this->scenarioPlayerCount = 0;
        do {
          iVar5 = RGE_Scenario::Get_player_Active((RGE_Scenario *)this->scenarioInfo,iVar7);
          if (iVar5 != 0) {
            this->scenarioPlayerCount = this->scenarioPlayerCount + 1;
            sprintf();
            iVar5 = RGE_Base_Game::multiplayerGame(rge_base_game);
            if ((iVar5 != 0) ||
               ((iVar5 = RGE_Base_Game::singlePlayerGame(rge_base_game), iVar5 != 0 &&
                (iVar5 = RGE_Scenario::Get_player_Type((RGE_Scenario *)this->scenarioInfo,iVar7),
                iVar5 == 1)))) {
              ppTVar18 = this->scenarioPlayerDrop;
              iVar5 = 8;
              this->numberAnyPlayers = this->numberAnyPlayers + 1;
              do {
                TDropDownPanel::append_line(*ppTVar18,str2 + 4,iVar7);
                ppTVar18 = ppTVar18 + 1;
                iVar5 = iVar5 + -1;
              } while (iVar5 != 0);
            }
          }
          iVar7 = iVar7 + 1;
        } while (iVar7 < 9);
        iVar7 = -1;
        iVar5 = 0;
        do {
          do {
            iVar7 = iVar7 + 1;
            if (iVar7 == 9) {
              iVar7 = 0;
            }
            iVar25 = RGE_Scenario::Get_player_Active((RGE_Scenario *)this->scenarioInfo,iVar7);
          } while (iVar25 == 0);
          this->defaultColor[iVar5] = (char)iVar7 + '\x01';
          TRIBE_Game::setScenarioPlayer((TRIBE_Game *)rge_base_game,iVar5,iVar7);
          TRIBE_Game::setPlayerColor
                    ((TRIBE_Game *)rge_base_game,iVar5,(uint)this->defaultColor[iVar5]);
          RGE_Base_Game::setPlayerTeam(rge_base_game,iVar5,1);
          iVar5 = iVar5 + 1;
        } while (iVar5 < 8);
      }
    }
    iVar7 = RGE_Base_Game::randomGame(rge_base_game);
    if (iVar7 != 0) {
      ppTVar18 = this->scenarioPlayerDrop;
      iVar7 = 8;
      do {
        TDropDownPanel::empty_list(*ppTVar18);
        ppTVar18 = ppTVar18 + 1;
        iVar7 = iVar7 + -1;
      } while (iVar7 != 0);
      this->scenarioPlayerCount = 8;
      this->numberAnyPlayers = 8;
      iVar7 = 0;
      str1._0_4_ = 1 - (int)this->defaultColor;
      this->settingsFixed = 0;
      do {
        this->defaultColor[iVar7] = (char)iVar7 + 1;
        TRIBE_Game::setScenarioPlayer((TRIBE_Game *)rge_base_game,iVar7,iVar7);
        TRIBE_Game::setPlayerColor
                  ((TRIBE_Game *)rge_base_game,iVar7,(uint)this->defaultColor[iVar7]);
        RGE_Base_Game::setPlayerTeam(rge_base_game,iVar7,1);
        sprintf();
        ppTVar18 = this->scenarioPlayerDrop;
        iVar5 = 8;
        do {
          TDropDownPanel::append_line(*ppTVar18,str2 + 4,iVar7);
          ppTVar18 = ppTVar18 + 1;
          iVar5 = iVar5 + -1;
        } while (iVar5 != 0);
        iVar7 = iVar7 + 1;
      } while (iVar7 < 8);
    }
    iVar7 = RGE_Base_Game::singlePlayerGame(rge_base_game);
    if (iVar7 != 0) {
      setupSinglePlayerPlayers(this);
    }
    iVar7 = RGE_Base_Game::randomGame(rge_base_game);
    this->saveRandomGame = iVar7;
    if (iVar7 == 0) {
      pcVar17 = RGE_Base_Game::scenarioName(rge_base_game);
      uVar15 = 0xffffffff;
      do {
        pcVar21 = pcVar17;
        if (uVar15 == 0) break;
        uVar15 = uVar15 - 1;
        pcVar21 = pcVar17 + 1;
        cVar1 = *pcVar17;
        pcVar17 = pcVar21;
      } while (cVar1 != '\0');
      uVar15 = ~uVar15;
      pcVar17 = pcVar21 + -uVar15;
      pcVar21 = this->saveScenarioName;
      for (uVar16 = uVar15 >> 2; uVar16 != 0; uVar16 = uVar16 - 1) {
        *(undefined4 *)pcVar21 = *(undefined4 *)pcVar17;
        pcVar17 = pcVar17 + 4;
        pcVar21 = pcVar21 + 4;
      }
      for (uVar15 = uVar15 & 3; uVar15 != 0; uVar15 = uVar15 - 1) {
        *pcVar21 = *pcVar17;
        pcVar17 = pcVar17 + 1;
        pcVar21 = pcVar21 + 1;
      }
    }
    else {
      this->saveScenarioName[0] = '\0';
    }
    plVar20 = this->scenarioCheckSum;
    for (iVar7 = 8; iVar7 != 0; iVar7 = iVar7 + -1) {
      *plVar20 = 0;
      plVar20 = plVar20 + 1;
    }
    iVar7 = RGE_Base_Game::scenarioGame(rge_base_game);
    if (iVar7 == 0) {
      this->myScenarioChecksum = 0;
    }
    else {
      RGE_Base_Game::scenarioName(rge_base_game);
      sprintf();
      iVar7 = __findfirst();
      if (iVar7 == -1) {
        RGE_Base_Game::scenarioName(rge_base_game);
      }
      else {
        RGE_Base_Game::scenarioName(rge_base_game);
      }
      sprintf();
      lVar9 = RGE_Base_Game::get_scenario_checksum(rge_base_game,file_name + 4);
      this->myScenarioChecksum = lVar9;
    }
  }
  ppTVar19 = this->settingText;
  iVar7 = 0x14;
  do {
    (**(code **)((*ppTVar19)->_padding_ + 0x14))();
    ppTVar19 = ppTVar19 + 1;
    iVar7 = iVar7 + -1;
  } while (iVar7 != 0);
  iVar7 = RGE_Base_Game::scenarioGame(rge_base_game);
  if (iVar7 == 0) {
    uVar3 = TRIBE_Game::deathMatch((TRIBE_Game *)rge_base_game);
    if (uVar3 == '\0') {
                    /* language.dll match for 0x25b5: "Random Map" */
      iVar7 = 0x25b5;
    }
    else {
      iVar7 = 0x2617;
    }
    TPanel::get_string((TPanel *)this,iVar7,str1 + 4,0x100);
                    /* language.dll match for 0x25ed: "Scenario: %s" */
    TPanel::get_string((TPanel *)this,0x25ed);
    sprintf();
    (**(code **)(this->scenarioName->_padding_ + 0xe8))();
    iVar7 = 1;
  }
  else {
    RGE_Base_Game::scenarioName(rge_base_game);
                    /* language.dll match for 0x25ed: "Scenario: %s" */
    TPanel::get_string((TPanel *)this,0x25ed);
    sprintf();
    (**(code **)(this->scenarioName->_padding_ + 0xe8))();
    iVar7 = 3;
  }
  iVar5 = RGE_Base_Game::randomGame(rge_base_game);
  if (iVar5 != 0) {
    MVar10 = TRIBE_Game::mapSize((TRIBE_Game *)rge_base_game);
    switch(MVar10) {
    case Tiny:
      iVar5 = 0x2973;
      break;
    case Small:
      iVar5 = 0x2974;
      break;
    case Medium:
      iVar5 = 0x2975;
      break;
    case Large:
      iVar5 = 0x2976;
      break;
    case Huge:
                    /* language.dll match for 0x2977: "Huge" */
      iVar5 = 0x2977;
      break;
    case Humongous:
                    /* language.dll match for 0x2978: "Gigantic" */
      iVar5 = 0x2978;
      break;
    default:
      goto switchD_004a470b_default;
    }
    pcVar17 = TPanel::get_string((TPanel *)this,iVar5);
    uVar15 = 0xffffffff;
    do {
      pcVar21 = pcVar17;
      if (uVar15 == 0) break;
      uVar15 = uVar15 - 1;
      pcVar21 = pcVar17 + 1;
      cVar1 = *pcVar17;
      pcVar17 = pcVar21;
    } while (cVar1 != '\0');
    uVar15 = ~uVar15;
    pcVar17 = pcVar21 + -uVar15;
    pcVar21 = str1;
    for (uVar16 = uVar15 >> 2; uVar16 != 0; uVar16 = uVar16 - 1) {
      *(undefined4 *)pcVar21 = *(undefined4 *)pcVar17;
      pcVar17 = pcVar17 + 4;
      pcVar21 = pcVar21 + 4;
    }
    for (uVar15 = uVar15 & 3; uVar15 != 0; uVar15 = uVar15 - 1) {
      *pcVar21 = *pcVar17;
      pcVar17 = pcVar17 + 1;
      pcVar21 = pcVar21 + 1;
    }
switchD_004a470b_default:
                    /* language.dll match for 0x25da: "Map Size: %s" */
    TPanel::get_string((TPanel *)this,0x25da);
    sprintf();
    (**(code **)(this->settingText[iVar7]->_padding_ + 0xe8))();
    (**(code **)(this->settingText[iVar7]->_padding_ + 0x14))();
    MVar11 = TRIBE_Game::mapType((TRIBE_Game *)rge_base_game);
    switch(MVar11) {
    case AllWater:
      iVar5 = 0x296a;
      break;
    case MostlyWater:
      iVar5 = 0x296b;
      break;
    case WaterAndLand:
      iVar5 = 0x296c;
      break;
    case MostlyLand:
      iVar5 = 0x296d;
      break;
    case AllLand:
      iVar5 = 0x296e;
      break;
    case Continental:
      iVar5 = 0x296f;
      break;
    case Lake:
      iVar5 = 0x2970;
      break;
    case Hilly:
      iVar5 = 0x2971;
      break;
    case Isthmas:
                    /* language.dll match for 0x2972: "Narrows"
                       language.dll match for 0x2972: "******* SIZE *******" */
      iVar5 = 0x2972;
      break;
    default:
      goto switchD_004a47bc_default;
    }
    pcVar17 = TPanel::get_string((TPanel *)this,iVar5);
    uVar15 = 0xffffffff;
    do {
      pcVar21 = pcVar17;
      if (uVar15 == 0) break;
      uVar15 = uVar15 - 1;
      pcVar21 = pcVar17 + 1;
      cVar1 = *pcVar17;
      pcVar17 = pcVar21;
    } while (cVar1 != '\0');
    uVar15 = ~uVar15;
    pcVar17 = pcVar21 + -uVar15;
    pcVar21 = &stack0xfffffac4;
    for (uVar16 = uVar15 >> 2; uVar16 != 0; uVar16 = uVar16 - 1) {
      *(undefined4 *)pcVar21 = *(undefined4 *)pcVar17;
      pcVar17 = pcVar17 + 4;
      pcVar21 = pcVar21 + 4;
    }
    for (uVar15 = uVar15 & 3; uVar15 != 0; uVar15 = uVar15 - 1) {
      *pcVar21 = *pcVar17;
      pcVar17 = pcVar17 + 1;
      pcVar21 = pcVar21 + 1;
    }
switchD_004a47bc_default:
                    /* language.dll match for 0x25b6: "Map Type: %s" */
    TPanel::get_string((TPanel *)this,0x25b6);
    sprintf();
    (**(code **)(this->settingText[iVar7 + 1]->_padding_ + 0xe8))();
    (**(code **)(this->settingText[iVar7 + 1]->_padding_ + 0x14))();
    iVar7 = iVar7 + 2;
  }
  iVar5 = RGE_Base_Game::scenarioGame(rge_base_game);
  if (iVar5 == 0) {
                    /* language.dll match for 0x25b7: "Players:" */
    TPanel::get_string((TPanel *)this,0x25b7);
    sprintf();
  }
  else if ((this->settingsFixed == 0) && (this->scenarioPlayerCount != 2)) {
                    /* language.dll match for 0x25b7: "Players:" */
    TPanel::get_string((TPanel *)this,0x25b7);
    sprintf();
  }
  else {
                    /* language.dll match for 0x25b7: "Players:" */
    TPanel::get_string((TPanel *)this,0x25b7);
    sprintf();
  }
  (**(code **)(this->settingText[iVar7]->_padding_ + 0xe8))();
  (**(code **)(this->settingText[iVar7]->_padding_ + 0x14))();
  VVar12 = TRIBE_Game::victoryType((TRIBE_Game *)rge_base_game);
  switch(VVar12) {
  case VictoryConquest:
    iVar5 = 0x10e1;
    break;
  default:
    iVar5 = RGE_Base_Game::randomGame(rge_base_game);
    if (iVar5 != 0) goto switchD_004a4941_caseD_9;
                    /* language.dll match for 0x10e7: "Default" */
    iVar5 = 0x10e7;
    break;
  case VictoryTime:
    iVar5 = 0x10e9;
    goto LAB_004a495e;
  case VictoryScore:
                    /* language.dll match for 0x10ea: "Score" */
    iVar5 = 0x10ea;
LAB_004a495e:
    pcVar17 = TPanel::get_string((TPanel *)this,iVar5);
    uVar15 = 0xffffffff;
    do {
      pcVar21 = pcVar17;
      if (uVar15 == 0) break;
      uVar15 = uVar15 - 1;
      pcVar21 = pcVar17 + 1;
      cVar1 = *pcVar17;
      pcVar17 = pcVar21;
    } while (cVar1 != '\0');
    uVar15 = ~uVar15;
    pcVar17 = pcVar21 + -uVar15;
    pcVar21 = &stack0xfffffac4;
    for (uVar16 = uVar15 >> 2; uVar16 != 0; uVar16 = uVar16 - 1) {
      *(undefined4 *)pcVar21 = *(undefined4 *)pcVar17;
      pcVar17 = pcVar17 + 4;
      pcVar21 = pcVar21 + 4;
    }
    for (uVar15 = uVar15 & 3; uVar15 != 0; uVar15 = uVar15 - 1) {
      *pcVar21 = *pcVar17;
      pcVar17 = pcVar17 + 1;
      pcVar21 = pcVar21 + 1;
    }
    TRIBE_Game::victoryAmount((TRIBE_Game *)rge_base_game);
                    /* language.dll match for 0x25be: "Victory: %s (%d)" */
    TPanel::get_string((TPanel *)this,0x25be);
    sprintf();
    goto LAB_004a4a1f;
  case VictoryStandard:
switchD_004a4941_caseD_9:
    iVar5 = 0x10ec;
  }
  pcVar17 = TPanel::get_string((TPanel *)this,iVar5);
  uVar15 = 0xffffffff;
  do {
    pcVar21 = pcVar17;
    if (uVar15 == 0) break;
    uVar15 = uVar15 - 1;
    pcVar21 = pcVar17 + 1;
    cVar1 = *pcVar17;
    pcVar17 = pcVar21;
  } while (cVar1 != '\0');
  uVar15 = ~uVar15;
  pcVar17 = pcVar21 + -uVar15;
  pcVar21 = &stack0xfffffac4;
  for (uVar16 = uVar15 >> 2; uVar16 != 0; uVar16 = uVar16 - 1) {
    *(undefined4 *)pcVar21 = *(undefined4 *)pcVar17;
    pcVar17 = pcVar17 + 4;
    pcVar21 = pcVar21 + 4;
  }
  for (uVar15 = uVar15 & 3; uVar15 != 0; uVar15 = uVar15 - 1) {
    *pcVar21 = *pcVar17;
    pcVar17 = pcVar17 + 1;
    pcVar21 = pcVar21 + 1;
  }
                    /* language.dll match for 0x25bc: "Victory: %s" */
  TPanel::get_string((TPanel *)this,0x25bc);
  sprintf();
LAB_004a4a1f:
  (**(code **)(this->settingText[iVar7 + 1]->_padding_ + 0xe8))();
  (**(code **)(this->settingText[iVar7 + 1]->_padding_ + 0x14))();
  AVar13 = TRIBE_Game::startingAge((TRIBE_Game *)rge_base_game);
  if (AVar13 == DefaultAge) {
    iVar5 = 0x10e7;
  }
  else if (AVar13 == NomadAge) {
                    /* language.dll match for 0x106e: "Nomad" */
    iVar5 = 0x106e;
  }
  else {
    iVar5 = AVar13 + 0x1067;
  }
  TPanel::get_string((TPanel *)this,iVar5,&stack0xfffffabc,0x100);
                    /* language.dll match for 0x25e4: "Age: %s" */
  TPanel::get_string((TPanel *)this,0x25e4);
  sprintf();
  (**(code **)(this->settingText[iVar7 + 2]->_padding_ + 0xe8))();
  (**(code **)(this->settingText[iVar7 + 2]->_padding_ + 0x14))();
  RVar14 = TRIBE_Game::resourceLevel((TRIBE_Game *)rge_base_game);
  if (RVar14 == DefaultResources) {
                    /* language.dll match for 0x10e7: "Default" */
    iVar5 = 0x10e7;
  }
  else {
    iVar5 = RVar14 + 0x25e5;
  }
  TPanel::get_string((TPanel *)this,iVar5,&stack0xfffffab4,0x100);
                    /* language.dll match for 0x25e5: "Resources: %s" */
  TPanel::get_string((TPanel *)this,0x25e5);
  sprintf();
  (**(code **)(this->settingText[iVar7 + 3]->_padding_ + 0xe8))();
  (**(code **)(this->settingText[iVar7 + 3]->_padding_ + 0x14))();
  RGE_Base_Game::difficulty(rge_base_game);
  pcVar17 = &stack0xfffffaac;
  iVar25 = 0x100;
  iVar5 = RGE_Base_Game::difficulty(rge_base_game);
  TPanel::get_string((TPanel *)this,iVar5 + 0x2bd0,pcVar17,iVar25);
                    /* language.dll match for 0x25e0: "Difficulty Level: %s" */
  TPanel::get_string((TPanel *)this,0x25e0,str1 + 0xe0,0x100);
  sprintf();
  (**(code **)(this->settingText[iVar7 + 4]->_padding_ + 0xe8))();
  (**(code **)(this->settingText[iVar7 + 4]->_padding_ + 0x14))();
  iVar5 = TRIBE_Game::randomizePositions((TRIBE_Game *)rge_base_game);
  if (iVar5 == 0) {
                    /* language.dll match for 0xfa3: "Yes" */
    iVar5 = 0xfa3;
  }
  else {
    iVar5 = 0xfa4;
  }
  TPanel::get_string((TPanel *)this,iVar5,&stack0xfffffaa4,0x100);
                    /* language.dll match for 0x25e9: "Fixed Positions: %s" */
  pcVar17 = TPanel::get_string((TPanel *)this,0x25e9);
  sprintf(str1 + 0xd8,pcVar17);
  (**(code **)(this->settingText[iVar7 + 5]->_padding_ + 0xe8))();
  (**(code **)(this->settingText[iVar7 + 5]->_padding_ + 0x14))(1);
  iVar5 = RGE_Base_Game::fullVisibility(rge_base_game);
  if (iVar5 == 0) {
                    /* language.dll match for 0xfa4: "No" */
    iVar5 = 0xfa4;
  }
  else {
    iVar5 = 0xfa3;
  }
  pcVar17 = TPanel::get_string((TPanel *)this,iVar5);
  uVar15 = 0xffffffff;
  do {
    pcVar21 = pcVar17;
    if (uVar15 == 0) break;
    uVar15 = uVar15 - 1;
    pcVar21 = pcVar17 + 1;
    cVar1 = *pcVar17;
    pcVar17 = pcVar21;
  } while (cVar1 != '\0');
  uVar15 = ~uVar15;
  pcVar17 = pcVar21 + -uVar15;
  pcVar21 = &stack0xfffffa9c;
  for (uVar16 = uVar15 >> 2; uVar16 != 0; uVar16 = uVar16 - 1) {
    *(undefined4 *)pcVar21 = *(undefined4 *)pcVar17;
    pcVar17 = pcVar17 + 4;
    pcVar21 = pcVar21 + 4;
  }
  for (uVar15 = uVar15 & 3; uVar15 != 0; uVar15 = uVar15 - 1) {
    *pcVar21 = *pcVar17;
    pcVar17 = pcVar17 + 1;
    pcVar21 = pcVar21 + 1;
  }
  puVar24 = &stack0xfffffa9c;
                    /* language.dll match for 0x25b8: "Reveal Map: %s" */
  pcVar17 = TPanel::get_string((TPanel *)this,0x25b8);
  sprintf(str1 + 0xd0,pcVar17,puVar24);
  (**(code **)(this->settingText[iVar7 + 6]->_padding_ + 0xe8))(str1 + 0xd0);
  (**(code **)(this->settingText[iVar7 + 6]->_padding_ + 0x14))(1);
  iVar5 = TRIBE_Game::fullTechTree((TRIBE_Game *)rge_base_game);
  if (iVar5 == 0) {
                    /* language.dll match for 0xfa4: "No" */
    iVar5 = 0xfa4;
  }
  else {
    iVar5 = 0xfa3;
  }
  TPanel::get_string((TPanel *)this,iVar5,&stack0xfffffa94,0x100);
  puVar24 = &stack0xfffffa94;
                    /* language.dll match for 0x25ec: "Full Tech Tree: %s" */
  pcVar17 = TPanel::get_string((TPanel *)this,0x25ec);
  sprintf(str1 + 200,pcVar17,puVar24);
  (**(code **)(this->settingText[iVar7 + 7]->_padding_ + 0xe8))(str1 + 200);
  (**(code **)(this->settingText[iVar7 + 7]->_padding_ + 0x14))(1);
  iVar25 = iVar7 + 8;
  iVar5 = RGE_Base_Game::multiplayerGame(rge_base_game);
  if (iVar5 != 0) {
    iVar5 = RGE_Base_Game::allowCheatCodes(rge_base_game);
    if (iVar5 == 0) {
                    /* language.dll match for 0xfa4: "No" */
      iVar5 = 0xfa4;
    }
    else {
      iVar5 = 0xfa3;
    }
    pcVar17 = TPanel::get_string((TPanel *)this,iVar5);
    uVar15 = 0xffffffff;
    do {
      pcVar21 = pcVar17;
      if (uVar15 == 0) break;
      uVar15 = uVar15 - 1;
      pcVar21 = pcVar17 + 1;
      cVar1 = *pcVar17;
      pcVar17 = pcVar21;
    } while (cVar1 != '\0');
    uVar15 = ~uVar15;
    pcVar17 = pcVar21 + -uVar15;
    pcVar21 = &stack0xfffffa8c;
    for (uVar16 = uVar15 >> 2; uVar16 != 0; uVar16 = uVar16 - 1) {
      *(undefined4 *)pcVar21 = *(undefined4 *)pcVar17;
      pcVar17 = pcVar17 + 4;
      pcVar21 = pcVar21 + 4;
    }
    for (uVar15 = uVar15 & 3; uVar15 != 0; uVar15 = uVar15 - 1) {
      *pcVar21 = *pcVar17;
      pcVar17 = pcVar17 + 1;
      pcVar21 = pcVar21 + 1;
    }
    puVar24 = &stack0xfffffa8c;
                    /* language.dll match for 0x25bb: "Enable Cheating: %s" */
    pcVar17 = TPanel::get_string((TPanel *)this,0x25bb);
    sprintf(str1 + 0xc0,pcVar17,puVar24);
    (**(code **)(this->settingText[iVar7 + 8]->_padding_ + 0xe8))(str1 + 0xc0);
    (**(code **)(this->settingText[iVar7 + 8]->_padding_ + 0x14))(1);
    iVar25 = iVar7 + 9;
  }
  iVar7 = RGE_Base_Game::multiplayerGame(rge_base_game);
  iVar5 = 0x100;
  if (iVar7 == 0) {
    pcVar17 = &stack0xfffffa8c;
    bVar4 = RGE_Base_Game::pathFinding(rge_base_game);
  }
  else {
    pcVar17 = &stack0xfffffa8c;
    bVar4 = RGE_Base_Game::mpPathFinding(rge_base_game);
  }
  TPanel::get_string((TPanel *)this,bVar4 + 0x260e,pcVar17,iVar5);
  puVar24 = &stack0xfffffa8c;
                    /* language.dll match for 0x25f1: "Path Finding: %s" */
  pcVar17 = TPanel::get_string((TPanel *)this,0x25f1);
  sprintf(str1 + 0xc0,pcVar17,puVar24);
  (**(code **)(this->settingText[iVar25]->_padding_ + 0xe8))(str1 + 0xc0);
  (**(code **)(this->settingText[iVar25]->_padding_ + 0x14))(1);
  bVar4 = TRIBE_Game::popLimit((TRIBE_Game *)rge_base_game);
  uVar15 = (uint)bVar4;
                    /* language.dll match for 0x25f0: "Population Limit: %d" */
  pcVar17 = TPanel::get_string((TPanel *)this,0x25f0);
  sprintf(str1 + 0xb8,pcVar17,uVar15);
  (**(code **)(this->settingText[iVar25 + 1]->_padding_ + 0xe8))(str1 + 0xb8);
  (**(code **)(this->settingText[iVar25 + 1]->_padding_ + 0x14))(1);
  iVar7 = RGE_Base_Game::singlePlayerGame(rge_base_game);
  if (iVar7 != 0) {
    iVar7 = RGE_Base_Game::scenarioGame(rge_base_game);
    if ((iVar7 == 0) || ((this->settingsFixed == 0 && (2 < this->scenarioPlayerCount)))) {
      (**(code **)(this->numberPlayersTitle->_padding_ + 0x14))(1);
      uVar23 = 1;
      iVar7 = this->numberPlayersDrop->_padding_;
    }
    else {
      (**(code **)(this->numberPlayersTitle->_padding_ + 0x14))(0);
      uVar23 = 0;
      iVar7 = this->numberPlayersDrop->_padding_;
    }
    (**(code **)(iVar7 + 0x14))(uVar23);
  }
  fillPlayers(this);
  return;
}

// --------------------------------------------------

// Function: kickPlayer
// Address: 004a4fc0
// [HELPER] s_Kick_Dialog: "Kick Dialog"
/* WARNING: Variable defined which should be unmapped: text */
/* protected: void __thiscall TribeMPSetupScreen::kickPlayer(int) */

void __thiscall TribeMPSetupScreen::kickPlayer(TribeMPSetupScreen *this,int param_1)
{
  char *pcVar1;
  char *pcVar2;
  char text [256];
  
  this->playerToKick = param_1;
  pcVar1 = TCommunications_Handler::GetPlayerName(comm,param_1);
                    /* language.dll match for 0x25c8: "Do you want to eject %s?" */
  pcVar2 = TPanel::get_string((TPanel *)this,0x25c8);
  sprintf(text + 4,pcVar2,pcVar1);
  TEasy_Panel::popupYesNoDialog((TEasy_Panel *)this,text + 4,&s_Kick_Dialog,0x1c2,100);
  return;
}

// --------------------------------------------------

// Function: handleKickedPlayer
// Address: 004a5020
/* protected: void __thiscall TribeMPSetupScreen::handleKickedPlayer(int) */

void __thiscall TribeMPSetupScreen::handleKickedPlayer(TribeMPSetupScreen *this,int param_1)
{
  TEasy_Panel *this_00;
  
  cancelScreen(this,0);
  this_00 = (TEasy_Panel *)TPanelSystem::currentPanel(&panel_system);
  if (this_00 != (TEasy_Panel *)0x0) {
    TEasy_Panel::popupOKDialog(this_00,0x25ca - (uint)(param_1 != 0),(char *)0x0,0x1c2,100);
  }
  return;
}

// --------------------------------------------------

// Function: activateVictoryPanels
// Address: 004a5060
/* protected: void __thiscall TribeMPSetupScreen::activateVictoryPanels(void) */

void __thiscall TribeMPSetupScreen::activateVictoryPanels(TribeMPSetupScreen *this)
{
  long lVar1;
  
  lVar1 = TDropDownPanel::get_id(this->victoryTypeDrop);
  if ((lVar1 == 1) || (lVar1 = TDropDownPanel::get_id(this->victoryTypeDrop), lVar1 == 0)) {
    (**(code **)(this->victoryAmountLabel->_padding_ + 0x14))(0);
    (**(code **)(this->victoryAmountInput->_padding_ + 0x14))(0);
  }
  else {
    (**(code **)(this->victoryAmountLabel->_padding_ + 0x14))(1);
    (**(code **)(this->victoryAmountInput->_padding_ + 0x14))(1);
    lVar1 = TDropDownPanel::get_id(this->victoryTypeDrop);
    switch(lVar1) {
    case 2:
                    /* language.dll match for 0x25cb: "Percent" */
      (**(code **)(this->victoryAmountLabel->_padding_ + 0xe4))(0x25cb);
      return;
    case 3:
    case 4:
    case 5:
                    /* language.dll match for 0x25cc: "Count" */
      (**(code **)(this->victoryAmountLabel->_padding_ + 0xe4))(0x25cc);
      return;
    case 6:
                    /* language.dll match for 0x25cd: "Quantity" */
      (**(code **)(this->victoryAmountLabel->_padding_ + 0xe4))(0x25cd);
      return;
    }
  }
  return;
}

// --------------------------------------------------

// Function: setupTabOrder
// Address: 004a5130
/* WARNING: Variable defined which should be unmapped: tabList */
/* protected: void __thiscall TribeMPSetupScreen::setupTabOrder(void) */

void __thiscall TribeMPSetupScreen::setupTabOrder(TribeMPSetupScreen *this)
{
  int iVar1;
  TPanel *tabList [4];
  
  iVar1 = RGE_Base_Game::singlePlayerGame(rge_base_game);
  if (iVar1 != 0) {
    tabList[2] = (TPanel *)this->cancelButton;
    tabList[1] = (TPanel *)this->startButton;
    tabList[3] = (TPanel *)this->gameSettingsButton;
    (**(code **)(this->_padding_ + 200))(tabList + 1,3);
    TPanel::set_curr_child((TPanel *)this,(TPanel *)this->startButton);
    return;
  }
  tabList[1] = (TPanel *)this->chatInput;
  if (this->gameSettingsButton != (TButtonPanel *)0x0) {
    tabList[2] = (TPanel *)this->startButton;
    tabList[3] = (TPanel *)this->cancelButton;
    (**(code **)(this->_padding_ + 200))(tabList + 1,4);
    TPanel::set_curr_child((TPanel *)this,(TPanel *)this->chatInput);
    return;
  }
  tabList[2] = (TPanel *)this->ready_button;
  tabList[3] = (TPanel *)this->cancelButton;
  (**(code **)(this->_padding_ + 200))(tabList + 1,3);
  TPanel::set_curr_child((TPanel *)this,(TPanel *)this->chatInput);
  return;
}

// --------------------------------------------------

// Function: setupSinglePlayerPlayers
// Address: 004a5210
// [HELPER] s_C__msdev_work_age1_x1_scr_mps_cp: "C:\msdev\work\age1_x1\scr_mps.cpp"
/* WARNING: Variable defined which should be unmapped: first_any_player */
/* protected: void __thiscall TribeMPSetupScreen::setupSinglePlayerPlayers(void) */

void __thiscall TribeMPSetupScreen::setupSinglePlayerPlayers(TribeMPSetupScreen *this)
{
  int iVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  int first_any_player;
  int first_any_civ;
  int first_any_color;
  int local_4;
  
  iVar1 = RGE_Base_Game::scenarioGame(rge_base_game);
  if (iVar1 == 0) {
    iVar1 = 0;
    do {
      uVar6 = debug_rand(s_C__msdev_work_age1_x1_scr_mps_cp,0xb31);
      uVar3 = (int)uVar6 >> 0x1f;
      TRIBE_Game::setCivilization
                ((TRIBE_Game *)rge_base_game,iVar1,
                 (((uVar6 ^ uVar3) - uVar3 & 0xf ^ uVar3) - uVar3) + 1);
      iVar4 = iVar1 + 1;
      TRIBE_Game::setPlayerColor((TRIBE_Game *)rge_base_game,iVar1,iVar4);
      iVar1 = iVar4;
    } while (iVar4 < 8);
  }
  else {
    iVar1 = -1;
    first_any_civ = -1;
    first_any_color = -1;
    local_4 = -1;
    if (this->scenarioInfo != (T_Scenario *)0x0) {
      iVar4 = 0;
      iVar5 = 0;
      do {
        iVar2 = RGE_Scenario::Get_player_Active((RGE_Scenario *)this->scenarioInfo,iVar5);
        if (iVar2 != 0) {
          TRIBE_Game::setScenarioPlayer((TRIBE_Game *)rge_base_game,iVar4,iVar5);
          iVar1 = RGE_Scenario::Get_player_Civ((RGE_Scenario *)this->scenarioInfo,iVar5);
          TRIBE_Game::setCivilization((TRIBE_Game *)rge_base_game,iVar4,iVar1);
          TRIBE_Game::setPlayerColor((TRIBE_Game *)rge_base_game,iVar4,iVar5 + 1);
          iVar1 = RGE_Scenario::Get_player_Type((RGE_Scenario *)this->scenarioInfo,iVar5);
          if ((iVar1 == 1) && (first_any_civ == -1)) {
            first_any_color = RGE_Scenario::Get_player_Civ((RGE_Scenario *)this->scenarioInfo,iVar5)
            ;
            first_any_civ = iVar5;
            local_4 = iVar5 + 1;
          }
          iVar4 = iVar4 + 1;
          iVar1 = first_any_civ;
        }
        iVar5 = iVar5 + 1;
      } while (iVar5 < 9);
    }
    RGE_Base_Game::setNumberPlayers(rge_base_game,this->scenarioPlayerCount);
    if (iVar1 != -1) {
      iVar4 = 1;
      if (1 < this->scenarioPlayerCount) {
        do {
          iVar5 = TRIBE_Game::scenarioPlayer((TRIBE_Game *)rge_base_game,iVar4);
          if (iVar5 == iVar1) {
            iVar5 = TRIBE_Game::scenarioPlayer((TRIBE_Game *)rge_base_game,0);
            TRIBE_Game::setScenarioPlayer((TRIBE_Game *)rge_base_game,iVar4,iVar5);
            iVar5 = TRIBE_Game::civilization((TRIBE_Game *)rge_base_game,0);
            TRIBE_Game::setCivilization((TRIBE_Game *)rge_base_game,iVar4,iVar5);
            iVar5 = TRIBE_Game::playerColor((TRIBE_Game *)rge_base_game,0);
            TRIBE_Game::setPlayerColor((TRIBE_Game *)rge_base_game,iVar4,iVar5);
            break;
          }
          iVar4 = iVar4 + 1;
        } while (iVar4 < this->scenarioPlayerCount);
      }
      TRIBE_Game::setScenarioPlayer((TRIBE_Game *)rge_base_game,0,iVar1);
      TRIBE_Game::setCivilization((TRIBE_Game *)rge_base_game,0,first_any_color);
      TRIBE_Game::setPlayerColor((TRIBE_Game *)rge_base_game,0,local_4);
    }
  }
  iVar1 = 0;
  do {
    RGE_Base_Game::setPlayerTeam(rge_base_game,iVar1,1);
    iVar1 = iVar1 + 1;
  } while (iVar1 < 8);
  TCommunications_Handler::SetPlayerHumanity(comm,1,ME_HUMAN);
  uVar6 = 2;
  do {
    TCommunications_Handler::SetPlayerHumanity(comm,uVar6,ME_COMPUTER);
    uVar6 = uVar6 + 1;
  } while ((int)uVar6 < 9);
  TCommunications_Handler::SetPlayerHumanity(comm,9,ME_ABSENT);
  fillNumberPlayers(this);
  return;
}

// --------------------------------------------------

// Function: fillNumberPlayers
// Address: 004a5440
// [HELPER] s__d: "%d"
/* WARNING: Variable defined which should be unmapped: str */
/* protected: void __thiscall TribeMPSetupScreen::fillNumberPlayers(void) */

void __thiscall TribeMPSetupScreen::fillNumberPlayers(TribeMPSetupScreen *this)
{
  long lVar1;
  int iVar2;
  char str [16];
  
  TDropDownPanel::empty_list(this->numberPlayersDrop);
  iVar2 = 2;
  if (1 < this->scenarioPlayerCount) {
    do {
      sprintf(str + 4,&s__d,iVar2);
      TDropDownPanel::append_line(this->numberPlayersDrop,str + 4,iVar2);
      iVar2 = iVar2 + 1;
    } while (iVar2 <= this->scenarioPlayerCount);
  }
  iVar2 = RGE_Base_Game::numberPlayers(rge_base_game);
  lVar1 = TDropDownPanel::get_line(this->numberPlayersDrop,iVar2);
  TDropDownPanel::set_line(this->numberPlayersDrop,lVar1);
  return;
}

// --------------------------------------------------

// Function: fillPlayerColors
// Address: 004a54c0
// [HELPER] s__d: "%d"
/* protected: void __thiscall TribeMPSetupScreen::fillPlayerColors(void) */

void __thiscall TribeMPSetupScreen::fillPlayerColors(TribeMPSetupScreen *this)
{
  int iVar1;
  int iVar2;
  int iVar3;
  TButtonPanel **ppTVar4;
  ulong uVar5;
  int local_18;
  char str [16];
  
  ppTVar4 = this->playerColor;
  local_18 = 8;
  str._0_4_ = this;
  do {
    iVar2 = 0;
    iVar3 = 0;
    do {
      iVar1 = RGE_Base_Game::scenarioGame(rge_base_game);
      if (((iVar1 == 0) || (this->scenarioInfo == (T_Scenario *)0x0)) ||
         ((iVar1 = RGE_Scenario::Get_player_Active((RGE_Scenario *)this->scenarioInfo,iVar2),
          iVar1 != 0 &&
          ((iVar1 = RGE_Base_Game::singlePlayerGame(rge_base_game), iVar1 == 0 ||
           (iVar1 = RGE_Scenario::Get_player_Type((RGE_Scenario *)this->scenarioInfo,iVar2),
           iVar1 == 1)))))) {
        sprintf(str + 4,&s__d,iVar2 + 1);
        TButtonPanel::set_text(*ppTVar4,(short)iVar3,str + 4);
        TButtonPanel::set_id(*ppTVar4,(short)iVar3,iVar2 + 1,0);
        switch(iVar2) {
        case 0:
          uVar5 = 0xff0000;
          break;
        case 1:
          uVar5 = 0xff;
          break;
        case 2:
          uVar5 = 0xffff;
          break;
        case 3:
          uVar5 = 0x284673;
          break;
        case 4:
          uVar5 = 0x764f0;
          break;
        case 5:
          uVar5 = 0xff00;
          break;
        case 6:
          uVar5 = 0xb4b4b4;
          break;
        case 7:
          uVar5 = 0x93bf2b;
          break;
        default:
          goto switchD_004a555d_default;
        }
        TButtonPanel::set_text_color(*ppTVar4,iVar3,uVar5,0);
switchD_004a555d_default:
        iVar3 = iVar3 + 1;
        this = (TribeMPSetupScreen *)str._0_4_;
      }
      iVar2 = iVar2 + 1;
    } while (iVar2 < 8);
    TButtonPanel::set_state_info(*ppTVar4,(short)iVar3);
    ppTVar4 = ppTVar4 + 1;
    local_18 = local_18 + -1;
    if (local_18 == 0) {
      return;
    }
  } while( true );
}

// --------------------------------------------------

